## **ğŸ“— ëª©ì°¨**


ğŸ† [í”„ë¡œì íŠ¸ ì†Œê°œ](#-í”„ë¡œì íŠ¸-ì†Œê°œ)

ğŸ‘¨ğŸ»â€ğŸ’» [íŒ€ì› ì†Œê°œ](#-íŒ€ì›-ì†Œê°œ)

ğŸ›  [ê°œë°œ ë„êµ¬](#-ê°œë°œ-ë„êµ¬)

â° [í”„ë¡œì íŠ¸ ì¼ì •](#-í”„ë¡œì íŠ¸-ì¼ì •)

ğŸ”— [APIëª…ì„¸ì„œì™€ ERDì„¤ê³„ë„](#-APIëª…ì„¸ì„œì™€-ERDì„¤ê³„ë„)
  
ğŸ“ [ë©”ë‰´êµ¬ì¡°ë„](#-ë©”ë‰´êµ¬ì¡°ë„)
  
âœ¨ [í™”ë©´ êµ¬í˜„ ë° ì½”ë“œ ë¦¬ë·°](#-í™”ë©´-êµ¬í˜„-ë°-ì½”ë“œ-ë¦¬ë·°)
  - [íšŒì›ê°€ì… í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°](#íšŒì›ê°€ì…-í™”ë©´-êµ¬í˜„-ì˜ìƒ-ë°-ì½”ë“œ-ë¦¬ë·°)
  - [ë¡œê·¸ì¸ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°](#ë¡œê·¸ì¸-í™”ë©´-êµ¬í˜„-ì˜ìƒ-ë°-ì½”ë“œ-ë¦¬ë·°)
  - [í€ë”© ë©”ì¸ í˜ì´ì§€ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°](#í€ë”©-ë©”ì¸-í˜ì´ì§€-í™”ë©´-êµ¬í˜„-ì˜ìƒ-ë°-ì½”ë“œ-ë¦¬ë·°)
  - [í€ë”© ìƒì„¸ í˜ì´ì§€ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°](#í€ë”©-ìƒì„¸-í˜ì´ì§€-í™”ë©´-êµ¬í˜„-ì˜ìƒ-ë°-ì½”ë“œ-ë¦¬ë·°)
  - [ê´€ë¦¬ì í€ë”© ë° ê¸°ë¶€ ë“±ë¡ í˜ì´ì§€ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°](#ê´€ë¦¬ì-í€ë”©-ë°-ê¸°ë¶€-ë“±ë¡-í˜ì´ì§€-í™”ë©´-êµ¬í˜„-ì˜ìƒ-ë°-ì½”ë“œ-ë¦¬ë·°)
  - [ê´€ë¦¬ì í€ë”© ë° ê¸°ë¶€ ìˆ˜ì • í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°](#ê´€ë¦¬ì-í€ë”©-ë°-ê¸°ë¶€-ìˆ˜ì •-í™”ë©´-êµ¬í˜„-ì˜ìƒ-ë°-ì½”ë“œ-ë¦¬ë·°)
  - [ê´€ë¦¬ì í€ë”© ë° ê¸°ë¶€ ì‚­ì œ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°](#ê´€ë¦¬ì-í€ë”©-ë°-ê¸°ë¶€-ì‚­ì œ-í™”ë©´-êµ¬í˜„-ì˜ìƒ-ë°-ì½”ë“œ-ë¦¬ë·°)
  - [OAuth2 íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°](#OAuth2-íšŒì›ê°€ì…-ë°-ë¡œê·¸ì¸-í™”ë©´-êµ¬í˜„-ì˜ìƒ-ë°-ì½”ë“œ-ë¦¬ë·°)
  - [OAuth2 Google, Kakao ê³„ì • í†µí•© í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°](#OAuth2-Google-Kakao-ê³„ì •-í†µí•©-í™”ë©´-êµ¬í˜„-ì˜ìƒ-ë°-ì½”ë“œ-ë¦¬ë·°)
  
ğŸ‘¨ğŸ»â€ğŸ’» [ëŠë‚€ì ](#-ëŠë‚€ì )

<br/>

## **ğŸ† í”„ë¡œì íŠ¸ ì†Œê°œ**

- í”„ë¡œì íŠ¸ ì œëª© - í€ë”© ë° ê¸°ë¶€ ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸

- í”„ë¡œì íŠ¸ ëª©ì  - ë°°ìš´ ê²ƒë“¤ì„ ë³µìŠµ ë° í™œìš©, í˜‘ì—…ì— ëŒ€í•œ ì´í•´

- ë¶„ë¥˜ - íŒ€í”„ë¡œì íŠ¸

- ì œì‘ ê¸°ê°„ - 2023.05.03 ~ 2023.06.07

<br/>

## **ğŸ‘¨ğŸ»â€ğŸ’» íŒ€ì› ì†Œê°œ**

<br/>

> **íŒ€ì¥: ì •ì˜í˜„** 
- ì‚¬ìš©í•œ í†µê³„ì— í”„ë¡œì íŠ¸ ì„¤ê³„
- í€ë”©í˜ì´ì§€ CRUD ê¸°ëŠ¥ êµ¬í˜„ ë° CSS
- ë¡œê·¸ì¸ ë° íšŒì›ê°€ì… ê¸°ëŠ¥ êµ¬í˜„
- security jwt ë° accessToken ë””í…Œì¼ ì‘ì—…
- íŒŒì¼ ì…ì¶œë ¥
- API ëª…ì„¸ì„œ
- ê´€ë¦¬ì CRUD ê¸°ëŠ¥ êµ¬í˜„
- OAuth2 ë¡œê·¸ì¸, íšŒì›ê°€ì… ê¸°ëŠ¥ êµ¬í˜„
- ê²°ì œ ê¸°ëŠ¥ êµ¬í˜„

<br/>

> **íŒ€ì›: ê¹€ìˆ˜í˜„** 
- ë©”ì¸ í˜ì´ì§€ ê¸°ëŠ¥ êµ¬í˜„ ë° CSS
- header ì‘ì—…
- ppt ì‘ì—…

<br/>

> **íŒ€ì›: ê¹€ìƒí˜„** 
- ê¸°ë¶€í˜ì´ì§€ CRUD ê¸°ëŠ¥êµ¬í˜„ ë° CSS
- ë¡œê·¸ì¸ íšŒì›ê°€ì… í˜ì´ì§€ CSS
- ERD ëª…ì„¸ì„œ
- security jwt ë° accessToken í‹€ ì‘ì—…

<br/>

> **íŒ€ì›: ì´í•´ê°•** 
- ë°ì´í„° í¬ë¡¤ë§
- ê²€ìƒ‰ ê¸°ëŠ¥

<br/>

## **ğŸ›  ê°œë°œ ë„êµ¬**

<br/>

### FrontEnd

<img src="https://img.shields.io/badge/Visual Studio Code-007ACC?style=for-the-badge&logo=Visual Studio Code&logoColor=white"/> <img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white"> 
<img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white"> 
<img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black"> 
<img src="https://img.shields.io/badge/react-61DAFB?style=for-the-badge&logo=react&logoColor=black"> 

### BackEnd

<img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white"> <img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white"> 

### í˜•ìƒ ê´€ë¦¬
<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white"> <img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">

<br/>

***ORM: Mybatis***

<br/>

## **â° í”„ë¡œì íŠ¸ ì¼ì •**


![ìŠ¤í¬ë¦°ìƒ·(1)](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/4f7ea0ba-3d55-4106-9672-da1fde38a496)

<br/><br/>

**ì°¸ê³  ì›¹ì‚¬ì´íŠ¸:** https://happybean.naver.com/

<br/>

## **ğŸ”— APIëª…ì„¸ì„œì™€ ERDì„¤ê³„ë„**

### API ëª…ì„¸ì„œ

https://third-tempo-8c0.notion.site/4b573b520b424c3590c6ce244e1df794?v=f2f7a9bebd714ea3be176765f004f3d2

<br/>

### ERD ì„¤ê³„ë„


<div align="center">
 
 ### í€ë”© ERD
 
</div>

![KakaoTalk_20230605_153904436](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/c6a471b0-85f3-4d27-a258-0ac460f730d4)

<br/><br/>

<div align="center">
 
 ### ê¸°ë¶€ ERD

![KakaoTalk_20230605_154821409](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/86dc51b4-dca5-4fa9-bfb5-7398474b865f)


 
</div>

<br/><br/>

## **ğŸ“ ë©”ë‰´êµ¬ì¡°ë„**

![ìŠ¤í¬ë¦°ìƒ·(2)](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/263c80b5-0421-4bb8-b7ac-96c53100b837)

<br/>

## **âœ¨ í™”ë©´ êµ¬í˜„ ë° ì½”ë“œ ë¦¬ë·°**

<br/>

### **íšŒì›ê°€ì… í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°**

<details>
<summary>ì´ë©”ì¼ ìœ íš¨ì„± ê²€ì‚¬ ì˜ìƒê³¼ ì½”ë“œ ë¦¬ë·°</summary>
<div markdown="1">

</br>

**ì˜ìƒ**

</br>

![ì´ë©”ì¼ ìœ íš¨ì„± ê²€ì‚¬](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/0bf30e4f-bf10-4864-a202-cba2c63a045d)

</br></br>

## FrontEnd

<br/>

**ì›¹ì—ì„œ ì´ë©”ì¼ ì…ë ¥ ë°›ê¸°**

```html

<div css={signupInputContainerWrap}>
    <FormControl variant="standard">
            <Input id="input-with-icon-adornment"
                css={placeholderFontSize}
                label="email" 
                variant="outlined" 
                placeholder="ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥" 
                name="email" 
                type="text" 
                onChange={onChangeHandler} 
                startAdornment={
                    <InputAdornment position="start">
                    <Mail />
                    </InputAdornment>
                } />
                {emailSubmitDisabled ? (
                successMessage.email && <Alert css={errorCss} severity="success">{successMessage.email}</Alert>
            ) : (
                <>
                    {emailErrorMessage.email && <Alert css={errorCss} severity="error">{emailErrorMessage.email}</Alert>}
                    {errorMessage.email && <Alert css={errorCss} severity="error">{errorMessage.email}</Alert>}
                </>
            )}
        </FormControl>
        <Button variant="contained" css={checkedEmail} onClick={checkedEmailSubmit}>ì¤‘ë³µí™•ì¸</Button>
    </div>

```

</br>

- input ì°½ì— ì´ë©”ì¼ ì…ë ¥ì„ ë°›ê³ , ì¤‘ë³µí™•ì¸ ë²„íŠ¼ë„ ë„£ì–´ì¤€ë‹¤.
- input ì°½ì—ëŠ” onChange, buttonì—ëŠ” onClickì„ ë„£ì–´ì¤Œìœ¼ë¡œì¨ ë‚´ê°€ ì·¨í•œ í–‰ë™ì— ëŒ€í•œ ê°’ì„ í•¨ìˆ˜ë¡œ ë„˜ê²¨ì¤€ë‹¤.

---

</br></br>

**ì…ë ¥ ë°›ì€ ê°’ ì²˜ë¦¬**

```javascript

const onChangeHandler = (e) => {
    const { name, value } = e.target;
    setSignUp({...signUp, [name]: value});
}

```

</br>

- nameì—ëŠ” email, valueì—ëŠ” emailì´ë¼ëŠ” ì´ë¦„ì„ ê°€ì§„ inputì°½ì— ê°’ì´ ë“¤ì–´ê°€ìˆë‹¤.
- ì…ë ¥ ë°›ì€ ê°’ì„ setSignUp(useStateë¡œ ë Œë”ë§ì´ ë  ë•Œ ë§ˆë‹¤ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ê°€ ëœë‹¤)ì— ë°ì´í„°ë¥¼ ë„£ì–´ì¤€ë‹¤.

---

</br></br>

**ìš”ì²­**

```javascript

    const checkedEmailSubmit = () => {
        checkDuplicateEmail.mutate();
    }

```

</br>

```javascript

const checkDuplicateEmail = useMutation(async () => {
    setErrorMessages({email: ""})

    const data = {
        email: signUp.email
    }
    const option = {
        headers: {
            "Content-Type": "application/json"
        }
    }

    try {
        await axios.post("http://localhost:8080/auth/checkemail", JSON.stringify(data), option)
        setSuccessMessage({email: <div css={availableEmail}>ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ì…ë‹ˆë‹¤.</div>})
        setEmailSubmitDisabled(true);
    }catch(error) {
        setEmailErrorMessage({email: error.response.data.errorData.email})
        setEmailSubmitDisabled(false);
    }
})

```

</br>

- useMutationì„ ì‚¬ìš©í•´ ìš”ì²­ì„ ë³´ë‚´ë©´ ìƒíƒœ ê´€ë¦¬ë‚˜ ì—ëŸ¬ ì²˜ë¦¬ ë¶€ë¶„ì— ìˆì–´ì„œ ìš©ì´í•˜ë‹¤. ê·¸ë˜ì„œ get ìš”ì²­ì„ ì œì™¸í•˜ê³ ëŠ” useMutationì„ ì‚¬ìš©í•˜ì—¬ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²ƒì´ ì¢‹ë‹¤.
  get ìš”ì²­ì— ê´€í•œ ê²ƒì€ ì•„ë˜ì—ì„œ ë‹¤ë£° ê²ƒì´ë‹¤. 

- JavascriptëŠ” ì‹±ê¸€ ì“°ë ˆë“œì´ê¸° ë•Œë¬¸ì— ëª¨ë“  ì½”ë“œê°€ ë¹„ë™ê¸° ì²˜ë¦¬ë¡œ ë¼ì„œ ìš”ì²­ì—ì„œ ì˜¤ë¥˜ê°€ ê½¤ ìƒê¸¸ ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìš”ì²­ì— ëŒ€í•œ ì½”ë“œ ë°”ë¡œ ë‹¤ìŒì— ì‘ë‹µìœ¼ë¡œ ë°›ì€ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ì²˜ë¦¬í•˜ëŠ” ì½”ë“œê°€ ìˆë‹¤ ì¹˜ì. ì„œë²„ì— ë°ì´í„° ìš”ì²­ì„ ë³´ë‚´ê³  ë‚˜ì„œ ì‘ë‹µì´ ì˜¤ì§€ë„ ì•ŠìŒê³¼ ë™ì‹œì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ë°›ì§€ë„ ëª»í–ˆëŠ”ë° ë‹¤ìŒ ì½”ë“œê°€ ì‹¤í–‰ì´ ë˜ëŠ” ìƒí™©ì´ ìƒê²¨ë²„ë¦°ë‹¤. ê·¸ë˜ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ ê³¼ì •ì„ ë™ê¸°ì ì¸ ê²ƒì²˜ëŸ¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ async í•¨ìˆ˜ì™€ í•¨ê»˜ await í‚¤ì›Œë“œë¥¼ ì“´ë‹¤. (ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì‹¤ì œ ë™ê¸° ì²˜ë¦¬ê°€ ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆê³ , ë™ê¸°ì™€ ìœ ì‚¬í•˜ê²Œ ë³´ì´ëŠ” ê²ƒì„)

- ì„œë²„ë¡œ ë³´ë‚¸ ìš”ì²­ ë°ì´í„°ë¥¼ ë™ê¸°ì ì¸ ê²ƒì²˜ëŸ¼ ì‹¤í–‰ì„ í•˜ê³  ì‹¶ê¸° ë•Œë¬¸ì— await ë’¤ì— ìš”ì²­ urlì„ ë„£ì–´ì¤€ë‹¤.

- input ì°½ì—ì„œ ì…ë ¥ ë°›ì€ ê°’ì„ ìš”ì²­ ë°ì´í„°ë¡œ ë³´ë‚¸ë‹¤.

- ë§Œì•½ ìœ íš¨ì„± ê²€ì‚¬ì—ì„œ ì—ëŸ¬ ì—†ì´ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ê°€ ëë‹¤ë©´ "ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ì…ë‹ˆë‹¤."ë¥¼ ë„ì›Œì¤€ë‹¤.

- ì—ëŸ¬ê°€ ìˆë‹¤ë©´ ê²€ì‚¬í•´ì„œ ë–´ë˜ ì—ëŸ¬ ë‚´ìš©ì„ setEmailErrorMessageì— ë‹´ëŠ”ë‹¤.

- setEmailSubmitDisabledì— ë„£ì–´ì¤€ ìƒíƒœ ê°’ì€ ì•„ë˜ íšŒì›ê°€ì… ì„±ê³µì— ì„¤ëª…ì´ ìˆë‹¤.
  
---

</br></br>

## BackEnd

<br/>

**Controller**

```java

@RestController
@RequiredArgsConstructor
@RequestMapping("/auth")
public class SignUpController {
	
	private final SignUpService signUpService;
	
	@ValidAspect
	@PostMapping("/checkemail")
	public ResponseEntity<?> duplicatedEmail(@Valid @RequestBody DuplicatedEmailReqDto email, BindingResult bindingResult) {
		signUpService.duplicatedEmail(email.getEmail());
		return ResponseEntity.ok().body(true);
	}
	
}

```

</br>

- í”„ë¡ íŠ¸ì—ì„œ ë³´ë‚¸ emailì„ ë°›ì•„ì¤€ë‹¤.
- Postìš”ì²­(CRUD ì¤‘ Create)ì— ëŒ€í•œ ë°ì´í„° ì²˜ë¦¬.
- @Validë¥¼ ë‹¬ì•„ì£¼ë©´ dto ì•ˆì— ìˆëŠ” email(), Pattern() ë“±ì„ ê²€ì‚¬í•´ì¤€ë‹¤.
- @Validì™€ BindingResultëŠ” ì„¸íŠ¸ì„. signUpReqDtoì˜ ì˜¤ë¥˜ë¥¼ BindingResultì—ê²Œ ëª¨ë‘ ë„˜ê²¨ì¤€ë‹¤.

---

</br></br>

**Dto**

```java

@Data
public class DuplicatedEmailReqDto {
	@Email
	@NotBlank(message="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”")
	private String email;
}

```

</br>

- @Emailê³¼ @NotBlank ë“± validationê³¼ ê´€ë ¨ëœ ì–´ë…¸í…Œì´ì…˜ì„ ì¨ì£¼ë©´ ê±°ê¸°ì— í•´ë‹¹ë˜ëŠ” ë©”ì„¸ì§€ë¥¼ ì—ëŸ¬ ë©”ì„¸ì§€ë¡œ ë°˜í™˜í•´ì¤€ë‹¤. 

---

</br></br>

**Service**

```java

public void duplicatedEmail(String email) {
  if(signUpRepository.findUserByEmail(email) != null) {
    throw new CustomException("Duplicated Email", 
        ErrorMap.builder()
        .put("email", "ì‚¬ìš© ì¤‘ì¸ emailì…ë‹ˆë‹¤.")
        .build());
  }
}

```

</br>

- Controllerì—ì„œ ë³´ë‚¸ emailì„ ë°›ì•„ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ìˆëŠ” ì´ë©”ì¼ê³¼ ë¹„êµë¥¼ í•œë‹¤.
- ì´ë©”ì¼ì´ ì¡´ì¬í•œë‹¤ë©´ ë”°ë¡œ ë§Œë“¤ì–´ì¤€ CustomExceptionì´ë¼ëŠ” ê°ì²´ì™€ ErrorMapì´ë¼ëŠ” ê°ì²´ì— "email"ì´ë¼ëŠ” í‚¤ì™€ "ì‚¬ìš© ì¤‘ì¸ emailì…ë‹ˆë‹¤."ë¼ëŠ” valueë¥¼ ë„£ì–´ì¤€ë‹¤.
- ì´ ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ ë§Œë“¤ì–´ì¤Œìœ¼ë¡œì¨ í”„ë¡ íŠ¸ì—ì„œ ì´ ë©”ì„¸ì§€ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ëœë‹¤.

---

</br></br>

**Repository**

```java

@Mapper
public interface UserRepository {
	public User findUserByEmail(String email);
}

```

</br>

- xml fileë¡œ ëŒ€ì²´
- interfaceë¥¼ ì¨ì•¼ Mapperë¥¼ ì“¸ ìˆ˜ ìˆê³ , mybatisì—ì„œ ë°›ì„ ìˆ˜ ìˆë‹¤.
- Serviceì—ì„œ ë³´ë‚¸ emailì„ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë“¤ê³ ê°€ì„œ í™•ì¸ì„ í•œë‹¤.

---

</br></br>

**Sql**

```sql

<select id="findUserByEmail" resultMap="userMap">
  select
    ut.user_id,
    ut.email,
    ut.password,
    ut.name,
    ut.birth_day,
    ut.gender,
    ut.provider,
    ut.phone_number,
    
    at.authority_id,
    at.user_id,
    at.role_id,
    
    rt.role_id,
    rt.role_name
  from
    user_tb ut
    left outer join authority_tb at on(at.user_id = ut.user_id)
    left outer join role_tb rt on(rt.role_id = at.role_id)
  where
    ut.email = #{email}
</select>

```

</br>

- idëŠ” Repositoryì— ìˆëŠ” findUserByEmailì´ê³ , ê·¸ ë°˜í™˜ ê°’ì€ User ê°ì²´ë‹¤.
- whereë¬¸ì—ëŠ” user í…Œì´ë¸”ì— ìˆëŠ” emailê³¼ findUserByEmailì— ë§¤ê°œë³€ìˆ˜ emailì„ ë°›ì•„ì„œ ë¹„êµí•´ì¤€ë‹¤.
- ì´ whereë¬¸ì—ì„œ ì´ë©”ì¼ ë¹„êµë¥¼ í–ˆì„ ë•Œ, emailì´ ì¡´ì¬í•˜ë‹¤ë©´ ìœ„ Serviceì—ì„œ ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ ë„ìš°ê²Œ ë˜ëŠ” ê²ƒ.

---

</br></br>

**Database**

![ì´ë©”ì¼ í™•ì¸ ë°ì´í„°](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/a2e41380-3059-4807-a2b4-3c60148afe85)

</br>

- ì˜ìƒì—ì„œ ë³´ì—¬ì¡Œë˜ dmlgus3585@gmail.comì´ë¼ëŠ” ì´ë©”ì¼ì´ ì´ë¯¸ ì¡´ì¬í•˜ë‹¤ëŠ” ê²ƒì„ ì‚¬ì§„ì„ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

---
  
</div>
</details>

<details>
<summary>ê·¸ ì™¸ ìœ íš¨ì„± ê²€ì‚¬ ë° íšŒì›ê°€ì… ì„±ê³µ ì˜ìƒê³¼ ì½”ë“œ ë¦¬ë·°</summary>
<div markdown="1">

</br>

**ì˜ìƒ**

</br>

![ê·¸ ì™¸ ìœ íš¨ì„± ê²€ì‚¬ ë° íšŒì›ê°€ì… ì„±ê³µ](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/2dac8417-6567-427f-855a-fe6c728a2fd1)

</br></br>

## FrontEnd

**íšŒì›ê°€ì… ì •ë³´ ì…ë ¥**

```html

<div css={signupInputContainerWrap}>
    <FormControl variant="standard">
	    <Input id="input-with-icon-adornment"
		css={inputMargin}
		label="password"
		variant="outlined"
		placeholder="8-16ìì˜ ì˜ë¬¸ ë° ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ ëª¨ë‘ í¬í•¨"
		name="password"
		type="password"
		onChange={onChangeHandler} 
		startAdornment={
		    <InputAdornment position="start">
		    <Lock />
		    </InputAdornment>
		} />
	    {errorMessage.password && <Alert css={errorCss} severity="error">{errorMessage.password}</Alert>}
    </FormControl>
</div>

<div css={signupInputContainerWrap}>
    <FormControl variant="standard">
	    <Input id="input-with-icon-adornment" 
		label="password" 
		variant="outlined" 
		placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥" 
		name="confirmPassword" 
		type="password" 
		onChange={onChangeHandler} 
		startAdornment={
		    <InputAdornment position="start">
		    <Lock />
		    </InputAdornment>
		} />
	     {errorMessage.confirmPassword && <Alert css={errorCss} severity="error">{errorMessage.confirmPassword}</Alert>}
    </FormControl>
</div>

```

</br>

- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥í•˜ëŠ” ë¶€ë¶„ë§Œ ì˜ˆì‹œë¡œ ë„£ì—ˆë‹¤. ë‚˜ë¨¸ì§€ëŠ” í˜•ì‹ì´ ë˜‘ê°™ìŒ.

---

</br></br>

**ì…ë ¥ ë°›ì€ ê°’ ì²˜ë¦¬**

```javascript

const onChangeHandler = (e) => {
    const { name, value } = e.target;
    setSignUp({...signUp, [name]: value});
}

```

</br>

- ìœ„ ë‚´ìš©ì—ì„œ name, valueì—ëŠ” ì´ë©”ì¼ë§Œ ë“¤ì–´ê°„ ëª¨ìŠµì„ ë³´ì—¬ì£¼ì—ˆì§€ë§Œ ì—¬ê¸°ì„œëŠ” ì´ë©”ì¼ í¬í•¨ ëª¨ë“  ì…ë ¥ ê°’ë“¤ì´ ë“¤ì–´ê°€ìˆë‹¤
- ì…ë ¥ ë°›ì€ ê°’ì„ setSignUpì— ë°ì´í„°ë¥¼ ë„£ì–´ì¤€ë‹¤.

---

</br></br>

**ìš”ì²­**

```html

<div css={signUpBtnContainer}>
    <Button variant="contained" css={signupBtn} onClick={signUpSubmit}>ê°€ì…í•˜ê¸°</Button>
</div>

```

</br>

```javascript

    const signUpSubmit = () => {
        register.mutate();
    }

```

</br>

```javascript

    const register = useMutation(async () => {
        
        if (!emailSubmitDisabled) {
            setEmailErrorMessage({email: ""})
            setErrorMessages({ email: "ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ì„ í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤." });
            return;
        }

        if (signUp.password !== signUp.confirmPassword) {
            setErrorMessages({confirmPassword: "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."});
            return;
        }
        const data = {
            ...signUp, ...address
        }

        const option = {
            headers: {
                "Content-Type": "application/json"
            }
        }
        try {
            await axios.post("http://localhost:8080/auth/signup", JSON.stringify(data), option)
            setErrorMessages({email: "", password: "", confirmPassword: "", name: "", gender: "", birthday: "", phoneNumber: "", zonecode: "", address: "", detailAddress: ""})
            alert("íšŒì›ê°€ì… ì™„ë£Œ")
            window.location.replace("/login")
        }catch(error) {
            setErrorMessages({email: "", password: "", confirmPassword: "", name: "", gender: "", birthday: "", phoneNumber: "",zonecode: "", address: "", detailAddress: "", ...error.response.data.errorData})
        }
    });

```

</br>

- ì´ë©”ì¼ ì¤‘ë³µí™•ì¸ ë¶€ë¶„ì—ì„œ setEmailSubmitDisabledì— trueë‚˜ falseë¥¼ ì¤¬ë‹¤. ë§Œì•½ falseì¸ ê²½ìš° ì´ë©”ì¼ ì¤‘ë³µí™•ì¸ì„ í•˜ì§€ ì•Šê³  ê°€ì…í•˜ê¸°ë¥¼ ëˆŒë €ì„ ë•Œ ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê¸° ì–´ë ¤ì›Œ ì´ë ‡ê²Œ ì²˜ë¦¬ë¥¼ í•´ì¤¬ë‹¤. ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥ ë¶€ë¶„ë„ ë§ˆì°¬ê°€ì§€.

- ì—¬ê¸°ì„œ ì£¼ì†Œ ê²€ìƒ‰ì„ í•´ì„œ ì£¼ì†Œê°€ ë“¤ì–´ê°ˆ ê²½ìš°, ì´ì „ì— ë“¤ì–´ê°”ë˜ ìœ ì € ì •ë³´ë“¤ ìƒíƒœê°€ ì´ˆê¸°í™”ë˜ëŠ” ë¬¸ì œê°€ ìƒê²¼ì—ˆë‹¤.(ì´ ë•Œê¹Œì§„ signUp ìƒíƒœì— ì£¼ì†Œ ì •ë³´ê¹Œì§€ ë‹¤ ë„£ì—ˆì—ˆìŒ)
ì–´ë–»ê²Œ í•´ë„ ì•ˆ ë˜ê¸¸ë˜ ê²°êµ­ ìƒíƒœë¥¼ ë‘˜ë¡œ ë‚˜ëˆ ì„œ ìš”ì²­ì„ ë³´ë‚¸ ê²ƒ.

- ì—ëŸ¬ê°€ ìˆì„ ê²½ìš° errorMeesagesì— ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•˜ë©´ì„œ ì¤¬ë˜ ë©”ì„¸ì§€ê°€ ì…ë ¥ì´ ë˜ê³  ì €ì¥ì´ ëœë‹¤. ê·¸ë¦¬ê³  ì—ëŸ¬ ì—†ì´ ìš”ì²­ì´ ê°„ ë¶€ë¶„ì—ëŠ” ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ ê³µë°±ìœ¼ë¡œ ë¹„ì›Œì¤€ë‹¤.

---

</br></br>

## BackEnd

**Controller**

```java

@RestController
@RequiredArgsConstructor
@RequestMapping("/auth")
public class SignUpController {
	
	private final SignUpService signUpService;

	@ValidAspect
	@PostMapping("/signup")
	public ResponseEntity<?> signup(@Valid @RequestBody SignUpReqDto signUpReqDto, BindingResult bindingResult) {
		signUpService.signUp(signUpReqDto);
		return ResponseEntity.ok().body(true);
	}
	
}

```

</br>

- ìš”ì²­ì—ì„œ ë°›ì€ ë°ì´í„°ë¡œ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤ì‹œ í›„ ì„±ê³µí•˜ë©´ signUpServiceì— signUpì— ë„˜ê¸´ë‹¤.

---

</br></br>

**Dto**

```java

@Data
public class SignUpReqDto {
	@Email
	@NotBlank(message="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”")
	private String email;
	
	@Pattern(regexp = "^(?=.*[A-Za-z])(?=.*\\d)(?=.*[@$!%*#?&])[A-Za-z\\d@$!%*#?&]{8,16}$",
		message = "ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•˜ì—¬ 8 ~ 16ìë¡œ ì‘ì„±")
	private String password;
	
	@Pattern(regexp = "^[ê°€-í£]{2,7}$",
		message = "ì´ë¦„ì€ í•œê¸€ ì´ë¦„ë§Œ ì‘ì„± 	ê°€ëŠ¥í•©ë‹ˆë‹¤.")
	private String name;
	
    	@Pattern(regexp = "^\\d{4}-\\d{2}-\\d{2}$",
            	message = "ìƒë…„ì›”ì¼ì„ í˜•ì‹ì— ë§ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.")
	private String birthday;
    
	@Pattern(regexp = "^(male|female)$",
            	message = "ì„±ë³„ì„ ì²´í¬í•´ì£¼ì„¸ìš”.")
	private String gender;
    
    	@Pattern(regexp = "^[0-9]{2,3}-[0-9]{3,4}-[0-9]{4}$",
    		message = "íœ´ëŒ€ì „í™”ë²ˆí˜¸ í˜•ì‹ì— ë§ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.")
    	private String phoneNumber;
    
	@NotBlank(message = "ìš°í¸ë²ˆí˜¸ëŠ” í•„ìˆ˜ ì…ë ¥ ê°’ì…ë‹ˆë‹¤.")
	private String zonecode;
	
	@NotBlank(message = "ì£¼ì†ŒëŠ” í•„ìˆ˜ ì…ë ¥ ê°’ì…ë‹ˆë‹¤.")
	private String address;
	
	private String buildingName;
	private String bname;
	
	@NotBlank(message = "ìƒì„¸ ì£¼ì†ŒëŠ” í•„ìˆ˜ ì…ë ¥ ê°’ì…ë‹ˆë‹¤.")
	private String detailAddress;
	
	private String addressType;
	
	public User toUserEntity() {
		return User.builder()
				.email(email)
				.password(new BCryptPasswordEncoder().encode(password))
				.name(name)
				.birthday(birthday)
				.gender(gender)
				.phoneNumber(phoneNumber)
				.build();
	}
	
	public Address toAddressEntity() {
		return Address.builder()
				.zonecode(zonecode)
				.address(address)
				.buildingName(buildingName)
				.bname(bname)
				.detailAddress(detailAddress)
				.addressType(addressType)
				.build();
	}
}

```

</br>

- ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œì— ë„ì›Œì§€ëŠ” ë©”ì„¸ì§€ë“¤ì´ë‹¤.
- ë°ì´í„°ê°€ ì˜ ë“¤ì–´ì™”ë‹¤ë©´ toUserEntityì™€ toAddressEntityì— ìœ ì € ì •ë³´ë“¤ì´ ë“¤ì–´ê°„ë‹¤.
- ë¹„ë°€ë²ˆí˜¸ëŠ” ë³´ì•ˆì„±ì„ ìœ„í•´ BCryptë¡œ ë°”ê¿”ì¤¬ëŠ”ë°, ì´ BCryptëŠ” Spring Securityì—ì„œ ì œê³µí•˜ëŠ” ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”ê¸°ì´ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” Beanì— ë“±ë¡ì´ ë˜ì–´ì•¼ í•œë‹¤.

```java

@Bean
public BCryptPasswordEncoder passwordEncoder() {
	return new BCryptPasswordEncoder();
}

```

- ì´ ì½”ë“œëŠ” ì›¹ ê´€ë ¨í•´ ë³´ì•ˆì„ ë‹¤ë£¨ëŠ” ê°ì²´ë¥¼ ë”°ë¡œ ë§Œë“¤ì—ˆëŠ”ë° ê·¸ê±´ ì•„ë˜ jwtì™€ oauth2, ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ê°™ì´ ë‹¤ë£° ê²ƒì´ë‹¤.

---

</br></br>

**Service**

```java

@Service
@RequiredArgsConstructor
public class SignUpService {
	
	private final UserRepository signUpRepository;
	private User userEntity;

	public int signUp(SignUpReqDto signUpReqDto) {
		userEntity = signUpReqDto.toUserEntity();
		signUpRepository.signUpUser(userEntity);

		signUpRepository.saveAuthority(
				Authority.builder()
				.userId(userEntity.getUserId())
				.roleId(1)
				.build());
		
		Address addressEntity = signUpReqDto.toAddressEntity();
		addressEntity.setUserId(userEntity.getUserId());
		
		
		return signUpRepository.saveAddress(addressEntity);
	}
}

```

</br>

- ë°ì´í„°ë² ì´ìŠ¤ì— ì£¼ì†Œ í…Œì´ë¸”ì—ëŠ” userIdê°€ ìˆëŠ”ë° íšŒì›ê°€ì…ì„ í•˜ê³ , ë°ì´í„°ë¥¼ í™•ì¸í•´ë³´ë‹ˆ ì£¼ì†Œ í…Œì´ë¸”ì— userIdê°€ ê³„ì† 0ì´ì—ˆë‹¤. ê·¸ë˜ì„œ ì¶œë ¥ìœ¼ë¡œ í•˜ë‚˜ì”© ì¶”ì í•´ì„œ ì°¾ì•„ë´¤ë”ë‹ˆ ë¨¸ë¦¿ì†ìœ¼ë¡œëŠ” ì´í•´ê°€ ë˜ì§ˆ ì•Šì•„ ì´ ë°©ë²• ì € ë°©ë²• ì¨ë³´ë‹¤ê°€ User ê°ì²´ë¥¼ ì „ì—­ ë³€ìˆ˜ë¡œ ë¹¼ë‹ˆê¹Œ ëë‹¤!

- AuthorityëŠ” ìœ ì €ì˜ ê¶Œí•œì„ ì˜ë¯¸í•˜ëŠ” ê°ì²´ì´ê³ , roleIdëŠ” 1ë²ˆì´ ROLE_USER, 2ë²ˆì´ ROLE_ADMINì´ë‹¤. ê·¸ë˜ì„œ ì´ê±´ ì¼ë°˜ íšŒì›ê°€ì…ì´ê¸° ë•Œë¬¸ì— ROLE_USERë¥¼ ë¶€ì—¬í•´ì¤€ ê²ƒ.

- ë°˜í™˜ ìë£Œí˜•ì€ ì„±ê³µ ê±´ìˆ˜ë¡œ ì‹¤íŒ¨ ì‹œ 0, ì„±ê³µ ì‹œ 1ì´ê¸° ë•Œë¬¸ì— intë¡œ ì¡ì•„ì¤Œ.

---

</br></br>

**Repository**

```java
@Mapper
public interface UserRepository {
	public int saveAddress(Address address);
	public int signUpUser(User user);
	public int saveAuthority(Authority authority);
}

```

- Serviceì—ì„œ ì£¼ì†Œ ì •ë³´, ìœ ì € ì •ë³´, ê¶Œí•œ ì •ë³´ ë°›ìŒ.

---

**Sql**

- ì£¼ì†Œ ì •ë³´ ë„£ê¸°

```sql

<insert id="saveAddress" 
	parameterType="com.webproject.crowdfunding.entity.Address"
	useGeneratedKeys="true"
	keyProperty="addressId">

	insert into address_tb
	values
	(0, #{userId}, #{zonecode}, #{address}, #{buildingName}, #{bname}, #{detailAddress}, #{addressType})
</insert>

```

</br>

- ìœ ì € ì •ë³´ ë„£ê¸°

```sql

<insert id="signUpUser"
	parameterType="com.webproject.crowdfunding.entity.User"
	useGeneratedKeys="true"
	keyProperty="userId">

	insert into user_tb
	values
	(0, #{email}, #{password}, #{name}, #{birthday}, #{gender}, #{provider}, #{phoneNumber})
</insert>

```

</br>
  
- ê¶Œí•œ ì •ë³´ ë„£ê¸°

```sql

<insert id="saveAuthority" parameterType="com.webproject.crowdfunding.entity.Authority">
	insert into authority_tb
	values
	(0, #{userId}, #{roleId})
</insert>

```

</br>

- ë°˜í™˜ ìë£Œí˜•ì„ ë„£ì–´ì£¼ê³ , insertê°€ ëœ í›„ì— ìë™ìƒì„±ëœ í‚¤ê°’ì„ í•´ë‹¹ idì— ë§ê²Œ ë„£ì–´ì£¼ê³  ìˆë‹¤.

---

</br></br>

**Database**

- ìœ ì € ì •ë³´ ë°ì´í„°

![íšŒì›ê°€ì… ì„±ê³µ ë°ì´í„°](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/351f5483-cfac-4fcd-aa3e-7d9884bce0a1)

</br>

- ì£¼ì†Œ ì •ë³´ ë°ì´í„°

![ì£¼ì†Œ ì •ë³´ ë°ì´í„°](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/28027045-fda0-4313-932d-96bbbd5a33b8)

</br>

- ê¶Œí•œ ì •ë³´ ë°ì´í„°

![ê¶Œí•œ ì •ë³´ ë°ì´í„°](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/0ced2a4d-b50b-4dd8-93fe-8439e8a89c1d)

</br>

- ì´ë ‡ê²Œ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

---
  
</div>
</details>

<br/>

### **ë¡œê·¸ì¸ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°**

<details>
<summary>ë¡œê·¸ì¸ ìœ íš¨ì„± ê²€ì‚¬ ë° ì˜ˆì™¸ ì²˜ë¦¬ ì˜ìƒ ê·¸ ì™¸ í† í° ë¶€ì—¬ ë° ê¶Œí•œ ì½”ë“œ ë¦¬ë·°</summary>
<div markdown="1">

</br>

**ì˜ìƒ**

</br>

![ë¡œê·¸ì¸ ìœ íš¨ì„± ê²€ì‚¬ ë° ì˜ˆì™¸ì²˜ë¦¬](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/f095cb2f-d0a7-4127-9279-44e37efbe79a)

</br></br>

## FrontEnd

**ì›¹ì—ì„œ ë¡œê·¸ì¸ ì •ë³´ ì…ë ¥**

```html

    <div css={loginRightSide}>
	<div css={loginInputContainer}>
	    <div css={loginInputContainerWrapId}>
		<i css={inputI}></i>
		<FormControl variant="standard">
		    <Input id="input-with-icon-adornment" 
			label="email" 
			variant="outlined" 
			placeholder="email" 
			name="email" 
			type="text" 
			onChange={informationHandle} 
			startAdornment={
			    <InputAdornment position="start">
			    <Mail />
			    </InputAdornment>
			} />
		    {errorMessages.email && <Alert css={errorCss} severity="error">{errorMessages.email}</Alert>}
		</FormControl>
	    </div>
	    <div css={loginInputContainerWrapPw}>
		<i css={inputI}></i>
		<FormControl variant="standard">
		    <Input id="input-with-icon-adornment" 
			label="password" 
			variant="outlined" 
			placeholder="password" 
			name="password" 
			type="Password" 
			onChange={informationHandle}
			onKeyPress={handleOnKeyPress}
			startAdornment={
			    <InputAdornment position="start">
			    <Lock />
			    </InputAdornment>
			} />
		    {errorMessages.password && <Alert css={errorCss} severity="error">{errorMessages.password}</Alert>}
		</FormControl>
	    </div>
	</div>
	<div>
	    <button css={loginBtn} onClick={loginHandleSubmit}>ë¡œê·¸ì¸</button>
	</div>

```

</br>

- ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•œ í›„ ë¡œê·¸ì¸ ë²„íŠ¼ì„ í´ë¦­í•˜ê³ , ì˜¤ë¥˜ê°€ ìˆì„ ì‹œì— ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ ë„ìš°ê²Œ ì„¤ê³„

---

</br></br>

**ì…ë ¥ ë°›ì€ ê°’ ì²˜ë¦¬**

```javascript

    const informationHandle = (e) => {
        const { name, value } = e.target;
        setLoginUser({...loginUser, [name]: value})
    }

```

</br>

- ìœ„ì—ì„œ ë‹¤ë¤˜ë˜ ë‚´ìš©ê³¼ ë™ì¼

---

</br></br>

**ìš”ì²­**

```javascript

    const login = useMutation(async() => {
        const option = {
            headers: {
                "Content-Type": "application/json"
            }   
        }
        try{
            const response = await axios.post("http://localhost:8080/auth/login", JSON.stringify(loginUser), option);
            setErrorMessages({email: "", password: ""});
            const accessToken = response.data.accessToken;
            localStorage.setItem("accessToken", accessToken); 
            setAuthenticated(true);
            window.location.replace("/");
        } catch(error) {
            setErrorMessages({email: "", password: "", ...error.response.data.errorData});
            if(error.response.data.message === "ë¡œê·¸ì¸ ì‹¤íŒ¨") {
                alert("ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")
            }
        }
    })

    const loginHandleSubmit = () => {
        login.mutate();
    }

```

</br>

- ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë“¤ì–´ê°”ìœ¼ë©´ ì›¹í˜ì´ì§€ë¥¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” í† í°ì„ ë¶€ì—¬í•œë‹¤.

- useRecoilStateëŠ” ìƒíƒœë¥¼ ì „ì—­ìœ¼ë¡œ ê´€ë¦¬ë¥¼ í•˜ëŠ” ê²ƒ.

</br>

```javascript

const [ authenticated, setAuthenticated ] = useRecoilState(authenticatedState);

```

</br>

```javascript


export const authenticatedState = atom({
    key: "authenticatedState",
    default: false
});

```

</br>

- ê¸°ë³¸ ê°’ì€ falseì´ê³ , ìƒíƒœ í•˜ë‚˜í•˜ë‚˜ë¥¼ atomìœ¼ë¡œ ë³´ëŠ” ê²ƒì¸ë° ì—¬ê¸°ì„œ atomì´ë€ í•˜ë‚˜ì˜ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°ì²´ë¡œ ìƒê°í•˜ë©´ ëœë‹¤.

- ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë“¤ì–´ê°”ìœ¼ë©´ ê¸°ë³¸ ê°’ì´ falseì˜€ë˜ ê²ƒì„ ë¡œê·¸ì¸ ì½”ë“œì—ì„œ trueë¡œ ë°”ê¿”ì£¼ëŠ” ê²ƒì´ë‹¤.

- ì´ ì½”ë“œë¥¼ ë§Œë“  ì´ìœ ëŠ” ë¡œê·¸ì¸ì„ í•œ ì‚¬ëŒê³¼ í•˜ì§€ ì•Šì€ ì‚¬ëŒì—ê²Œ ë‹¤ë¥¸ ì´ìš©ì„ í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•´ ë§Œë“¤ì—ˆë‹¤.

---

</br></br>

**ê¶Œí•œì´ í•„ìš”í•œ ì›¹í˜ì´ì§€ì— ê¶Œí•œ ë¶€ì—¬**

```javascript

export const refreshState = atom({
    key: "refreshState",
    default: true
});

```

</br>

```javascript

const AuthRoute = ({ path, element }) => {
    const [ refresh, setRefresh ] = useRecoilState(refreshState);
    const accessToken = localStorage.getItem("accessToken");
    const navigate = useNavigate();

    const authenticated = useQuery(["authenticated"], async () => {
     const option = {
        headers: {
            Authorization: `Bearer ${accessToken}`
        }
     }
        try {
            const response = await axios.get("http://localhost:8080/auth/authenticated", option);
            return response;
        } catch(error) {
            localStorage.removeItem("accessToken");
            navigate("/login");
        }
    }, {
        refetchInterval: 1000 * 60
    });

    const principal = useQuery(["principal"], async () => {
        const option = {
            headers: {
                Authorization : `Bearer ${accessToken}`
            }
         }

        const response = await axios.get("http://localhost:8080/principal", option)
        return response;
        },{
            onSuccess: (response) => {
                const roles = response.data.authorities.split(",");
                if (path !== "/" && path.startsWith("/admin") && !roles.includes("ROLE_ADMIN")) {
                    alert("ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
                    navigate("/");
                }
            },
            enabled: !!accessToken && !!authenticated.data
    });

    useEffect(() => {
        if(!refresh) {
            setRefresh(true);
        }
    }, [refresh]);
    
    

    if(authenticated.isLoading) {
        return <div>ë¡œë”©ì¤‘...</div>;
    }

    const permitAll = ["/login", "/signup", "/auth/oauth2/login", "/auth/oauth2/signup", "/auth/oauth2/merge"];

    if(!authenticated.data.data) {
        if(permitAll.includes(path)){
            return element;
        }
    }

    if(permitAll.includes(path)){
        navigate("/");
    }

    return element;
};

```

</br>

- useEffectë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë Œë”ë§ì´ ë  ë•Œ refreshê°€ falseì´ë©´ trueë¡œ ì£¼ë©´ì„œ, ê°•ì œë¡œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ë§Œë“¤ì—ˆë‹¤.

- ë Œë”ë§ì´ ë  ë•Œ ë§ˆë‹¤ ë¡œê·¸ì¸ì„ í•˜ë©´ì„œ ë°œê¸‰ ë°›ì€ í† í°ë¥¼ 1ë¶„(refetchInterval: 1000 * 60ì—ì„œ 1000ì€ 1ì´ˆë¥¼ ì˜ë¯¸í•œë‹¤) ë§ˆë‹¤ ì¸ì¦ì„ í•˜ëŠ”ë°, í† í°ì´ ë§Œë£Œê°€ ë˜ê±°ë‚˜ ì˜ëª»ëœ í˜•ì‹ ë“± ì˜ˆì™¸ê°€ í„°ì§€ë©´ í† í°ì„ ì œê±°í•˜ê³  ë¡œê·¸ì•„ì›ƒì„ ì‹œí‚¨ë‹¤.

- ë Œë”ë§ì´ ë  ë•Œ ë§ˆë‹¤ ì¸ì¦ì´ ëœ í† í°ì„ ë³´ë‚´ëŠ”ë°, ì´ í† í°ì—ëŠ” ìœ ì €ì˜ ì •ë³´ë“¤ì´ ë‹´ê²¨ ìˆë‹¤. ì´ ì •ë³´ ì†ì„ ì—´ì–´ë³´ë©´ ë¶€ì—¬í•´ì¤€ ê¶Œí•œì´ ROLE_ADMINì´ ì•„ë‹Œë° ì›¹ ì£¼ì†Œì°½ì— /adminì´ë¼ëŠ” í˜ì´ì§€ë¥¼ ê°•ì œë¡œ ì—´ì–´ì„œ ì ‘ê·¼ì„ í–ˆì„ ë•Œ ê¶Œí•œì´ ì—†ë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì¤€ë‹¤.

- authenticatedì—ì„œ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì— ëŒ€í•´ permitAllì— ìˆëŠ” ê²½ë¡œë¥¼ ì´ìš©í•  ìˆ˜ ìˆê²Œ í•˜ê³ , ì¸ì¦ëœ ì‚¬ìš©ìë“¤ì€ ì € ê²½ë¡œë¥¼ ì´ìš©í•  ìˆ˜ ì—†ë„ë¡ ë©”ì¸ í™”ë©´ìœ¼ë¡œ ë³´ë‚¸ë‹¤.
ì´ë ‡ê²Œ ë§Œë“¤ì–´ì¤€ ì´ìœ ëŠ” ì¸ì¦ì´ ëë‹¤ëŠ” ê²ƒì€ ë¡œê·¸ì¸ì´ ëœ ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ë°, ë¡œê·¸ì¸ì´ ëœ ì‚¬ëŒì´ ë‹¤ì‹œ ë¡œê·¸ì¸ ì°½ì„ ë“¤ì–´ê°€ëŠ” ìƒí™©ì´ë‚˜ íšŒì›ê°€ì…ì„ í•˜ëŠ” ìƒí™© ë“± ì˜³ì§€ ì•Šì€ ìƒí™©ë“¤ì„ ìƒê°í•˜ì—¬ ë„£ì–´ì¤¬ë‹¤.

</br>

```javascript

function App() {
  return (
    <>
      <Global styles={Reset}></Global>
      <HeaderMain />
      <Routes>
        <Route path="/" element={<Main />} />
        <Route path="/login" element={<AuthRoute path="/login" element={<Login />} />} />
        <Route path="/signup" element={<AuthRoute path="/signup" element={<SignUp />}/>} />
        <Route path="/search" element={<Search />} />
        <Route path="/giving" element={<Giving />} />
        <Route path="/giving/:pageId" element={<GivingDetail />} />
        <Route path="/funding" element={<Funding />} />
        <Route path="/funding/:pageId" element={<FundingDetail />} />
        <Route path="/admin/register/page" element={<AuthRoute path="/admin/register/page" element={<RegisterPage />}/>} />
        <Route path='/auth/oauth2/login' element={<AuthRoute path={"/auth/oauth2/login"} element={<OAuth2Login />}/>} />
        <Route path='/auth/oauth2/signup' element={<AuthRoute path={"/auth/oauth2/signup"} element={<OAuth2SignUp />}/>} />
        <Route path='/auth/oauth2/merge' element={<AuthRoute path={"/auth/oauth2/merge"} element={<OAuth2Merge />}/>} />
      </Routes>
    </>
  );
}

```

</br>

- ê²½ë¡œ ê´€ë ¨ app.js ì½”ë“œë‹¤.

---

</br></br>

## BackEnd

**Controller**

```java

@RestController
@RequiredArgsConstructor
@RequestMapping("/auth")
public class LoginController {
	
	private final LoginService loginService;
	
	@ValidAspect
	@PostMapping("/login")
	public ResponseEntity<?> login(@Valid @RequestBody LoginReqDto loginReqDto, BindingResult bindingResult) {
		return ResponseEntity.ok(loginService.login(loginReqDto));
	}
	 
	@GetMapping("/authenticated")
	public ResponseEntity<?> authenticated(@RequestHeader(value = "Authorization") String accessToken) {
		return ResponseEntity.ok().body(loginService.authenticated(accessToken));
	}
}

```

- ê°’ì„ ok ì•ˆì— ë„£ê±°ë‚˜, body ì•ˆì— ë„£ê±°ë‚˜ ë˜‘ê°™ë‹¤. í•˜ì§€ë§Œ badRequestëŠ” ì•ˆ ë¨. okë§Œ ê°€ëŠ¥

---

</br></br>

**Dto**

```java

@Data
public class LoginReqDto {
	@Email(message = "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤.")
	@NotBlank(message="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”")
	private String email;
	
	@Pattern(regexp = "^(?=.*[A-Za-z])(?=.*\\d)(?=.*[@$!%*#?&])[A-Za-z\\d@$!%*#?&]{8,16}$",
			message = "ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•˜ì—¬ 8 ~ 16ìë¡œ ì‘ì„±")
	private String password;
}

```

</br>

- ë¡œê·¸ì¸ ìœ íš¨ì„± ê²€ì‚¬

---

**Service**

```java

@Service
@RequiredArgsConstructor
public class LoginService {

	private final AuthenticationManagerBuilder authenticationManagerBuilder;
	private final JwtTokenProvider jwtTokenProvider;
	private final PasswordEncoder passwordEncoder;
	private final UserRepository userRepository;
	
	public JwtRespDto login(LoginReqDto loginReqDto) {
		
		User userEntity = userRepository.findUserByEmail(loginReqDto.getEmail());
		
		if(userEntity == null || !passwordEncoder.matches(loginReqDto.getPassword(), userEntity.getPassword())) {
			throw new CustomException("ë¡œê·¸ì¸ ì‹¤íŒ¨", ErrorMap.builder().put("login", "ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”").build());
		}
		
		UsernamePasswordAuthenticationToken authenticationToken = 
				new UsernamePasswordAuthenticationToken(loginReqDto.getEmail(), loginReqDto.getPassword());
		Authentication authentication = authenticationManagerBuilder.getObject().authenticate(authenticationToken);
		return jwtTokenProvider.generateToken(authentication);
	}
	
	public boolean authenticated(String accessToken) {
		return jwtTokenProvider.validateToken(jwtTokenProvider.getToken(accessToken));
	}
}

```

- ë¨¼ì €, ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì €ì¥ë˜ì–´ìˆëŠ” ì´ë©”ì¼ì„ ë“¤ê³ ì™€ì„œ í˜„ì¬ ë¡œê·¸ì¸ í•˜ë ¤ëŠ” ì´ë©”ì¼ê³¼ ë¹„êµë¥¼ í–ˆì„ ë•Œ ì¼ì¹˜í•˜ì§€ ì•Šê±°ë‚˜, ì •ë³´ê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ë©”ì„¸ì§€ë¥¼ ë„ìš°ê²Œ í–ˆë‹¤. 

- ê·¸ ë‹¤ìŒ UsernamePasswordAuthenticationTokenì„ ì„ ì–¸í•´ì£¼ë©´ì„œ ë¡œê·¸ì¸í•œ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê°€ì§€ê³  ì¸ì¦ í† í°ì„ í•˜ë‚˜ ë§Œë“ ë‹¤.

- ê·¸ í† í°ì„ ê°€ì§€ê³  authenticationManagerBuilder.getObject().authenticate(authenticationToken)ì—ë‹¤ ë„£ì–´ì£¼ëŠ”ë° ì—¬ê¸°ì„œë¶€í„° ìŠ¤í”„ë§ë¶€íŠ¸ ë‚´ì—ì„œ authenticationManagerBuilderê°€ ì´ í† í° ì •ë³´ë¥¼ ê°€ì§€ê³  loadByUsernameë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.

```java

@Service
@RequiredArgsConstructor
public class PrincipalDetailsService implements UserDetailsService {

	private final UserRepository signUpRepository;

	@Override
	public UserDetails loadUserByUsername(String email) throws UsernameNotFoundException {
		User userEntity = signUpRepository.findUserByEmail(email);
		return userEntity.toPrincipal();
	}

}

```

</br>

- ìœ„ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤ëŠ” ì˜ë¯¸ì¸ë°, ì—¬ê¸°ëŠ” ë¡œê·¸ì¸ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ë¶€ë¶„ì´ë‹¤.

- ë°˜í™˜í•˜ê³  ìˆëŠ” toPrincipalì„ ë³´ìë©´ ì•„ë˜ì™€ ê°™ì´ ë˜ì–´ìˆë‹¤.

```java

@Builder
@Data
@AllArgsConstructor
@NoArgsConstructor
public class User {
	private int userId;
	private String email;
	private String password;
	private String name;
	private String birthday;
	private String gender;
	private String provider;
	private int addressId;
	private String phoneNumber;
	private List<Authority> authorities;
	
	public PrincipalUserDetails toPrincipal() {
		return PrincipalUserDetails.builder()
				.userId(userId)
				.email(email)
				.password(password)
				.roles(authorities)
				.build();
	}
}

```

</br>

```java

@Getter
@Builder
public class PrincipalUserDetails implements UserDetails{

	private static final long serialVersionUID = -8654755481982862798L;
	
	private int userId;
	private String email;
	private String password;
	private List<Authority> roles;
	
	@Override
	public Collection<? extends GrantedAuthority> getAuthorities() {
		List<SimpleGrantedAuthority> authorities = new ArrayList<>();
		roles.forEach(role -> {
			authorities.add(new SimpleGrantedAuthority(role.getRole().getRoleName()));
		});
		return authorities;
	}

	@Override
	public String getPassword() {
		return password;
	}

	@Override
	public String getUsername() {
		return email;
	}

	// ì‚¬ìš©ê¸°ê°„ ë§Œë£Œ = false
	@Override
	public boolean isAccountNonExpired() {
		return true;
	}

	// ê³„ì •ì„ ì ê¶ˆë²„ë¦¼ = false
	@Override
	public boolean isAccountNonLocked() {
		return true;
	}

	// ë¹„ë°€ë²ˆí˜¸ 5íšŒ í‹€ë ¸ì„ ë•Œ ì ê¶ˆë²„ë¦¼ = false
	@Override
	public boolean isCredentialsNonExpired() {
		return true;
	}

	// ê³„ì • ë¹„í™œì„± ìƒíƒœ(ì´ë©”ì¼ ì¸ì¦ì„ ì™„ë£Œí•´ì•¼ í•˜ê±°ë‚˜ ë˜ëŠ” ì „í™”ë²ˆí˜¸ ì¸ì¦ì„ í•˜ì§€ ì•Šì•˜ì„ ë•Œ) = false
	@Override
	public boolean isEnabled() {
		return true;
	}

}

```

</br>

- ê¶Œí•œ ê°ì²´ë¥¼ ìƒì„±í•´ì¤€ë‹¤.

- ê¶Œí•œ ëª©ë¡ì„ ë°˜í™˜, Listê°€ Collectionìœ¼ë¡œ ì—…ìºìŠ¤íŒ…ë¨

- User ê°ì²´ì—ì„œ Builderë¥¼ ì´ìš©í•´ ê°’ë“¤ì„ ë„£ì–´ì¤€ ë‹¤ìŒ, ê¶Œí•œ ê°ì²´ê¹Œì§€ ë§Œë“¤ì–´ì£¼ë©´ ì´ì œ Serviceì—ì„œ Authenticationì´ë¼ëŠ” ê°ì²´ê°€ ìƒì„±ì´ ëœë‹¤.

</br>

ìœ„ ì½”ë“œë¥¼ ë³´ë©´ ìƒì„±ëœ Authentication ê°ì²´ë¥¼ jwtTokenProvider.generateTokenì— ë„£ì–´ì£¼ëŠ”ë°, ì´ì œ jwtTokenProviderë¡œ ê°€ë³´ì.

```java

@Component
public class JwtTokenProvider {
	@Autowired
	private UserRepository userRepository;
	private final Key key;

	public JwtTokenProvider(@Value("${jwt.secret}") String secretKey) {	// @Componentì¼ ë•Œ ì‚¬ìš© ê°€ëŠ¥. ymlì˜ keyê°’ì´ ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ê°„ë‹¤
		key = Keys.hmacShaKeyFor(Decoders.BASE64.decode(secretKey));
	}

	public JwtRespDto generateToken(Authentication authentication) {
		StringBuilder builder = new StringBuilder();
		authentication.getAuthorities().forEach(authority -> {
			builder.append(authority.getAuthority() + ",");		// ë¬¸ìì—´ ì‚¬ìš©ê°€ëŠ¥, roleì´ í•˜ë‚˜ì”© ë‚˜ì˜¨ë‹¤.

		});

		builder.delete(builder.length() - 1, builder.length());		// ~ë¶€í„° ~ê¹Œì§€ ì§€ì›Œë¼. ì‰¼í‘œë¥¼ ì§€ìš°ê¸° ìœ„í•´ ì”€

		String authorities = builder.toString();	// role ê¶Œí•œë“¤ì„ ë¬¸ìì—´ë¡œ ë°”ê¾¸ê¸° ìœ„í•´ì„œ

		Date tokenExpiresDate = new Date(new Date().getTime() + (1000 * 60 * 60));	// 1000 * 60ì„ í•˜ë©´ 1ë¶„ì´ë‹¤. ê·¸ë˜ì„œ 1ì‹œê°„ì„ ë§Œë£Œ ì‹œê°„ìœ¼ë¡œ ì„¤ì •

		String accessToken = Jwts.builder()
				.setSubject(authentication.getName())	// í† í°ì˜ ì œëª©(í°ì´ë¦„), getName() = email
				.claim("auth", authorities)	// í† í° ì •ë³´ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•´ ì´ë¯¸ ì •í•´ì§„ ì¢…ë¥˜ì˜ ë°ì´í„°ë“¤ë¡œ ëª¨ë‘ ì„ íƒì ìœ¼ë¡œ ì‘ì„±ì´ ê°€ëŠ¥í•¨
				.setExpiration(tokenExpiresDate)	// í† í°ì˜ ë§Œë£Œê¸°ê°„
				.signWith(key, SignatureAlgorithm.HS256)	// í† í° ì•”í˜¸í™”
				.compact();

		return JwtRespDto.builder().grantType("Bearer").accessToken(accessToken).build();	// ì´í›„ controllerê°€ ë°›ëŠ”ë‹¤.

	}

	// Bearerë¥¼ ë—€ í† í° ê°’ì„ í’€ì–´ì„œ ê²€ì‚¬í•¨.
	public boolean validateToken(String token) {
		try {
			Jwts.parserBuilder()	// Jwt í˜•íƒœë¥¼ Jsonì´ ì•„ë‹Œ java í˜•íƒœë¡œ ì“°ê² ë‹¤
			.setSigningKey(key)		// tokenì´ ë§Œë“¤ì–´ì§„ keyë¡œ ë˜ì–´ìˆëŠ”ì§€ í™•ì¸
			.build()
			.parseClaimsJws(token);		// ìœ íš¨ì„± ê²€ì‚¬

			return true;

		// Security ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì˜¤ë¥˜ê°€ ìˆê±°ë‚˜, JSONì˜ formatì´ ì˜ëª»ëœ í˜•ì‹ì˜ JWTê°€ ë“¤ì–´ì™”ì„ ë•Œ ì˜ˆì™¸
		}catch (SecurityException | MalformedJwtException e) {
		}catch (ExpiredJwtException e) {
		}catch(UnsupportedJwtException e) {
		}catch(IllegalArgumentException e) {
		}catch(Exception e) {

		}

		// ì˜ˆì™¸ê°€ ì¼ì–´ë‚˜ë©´ ì¸ì¦ë˜ì§€ ì•Šì•˜ë‹¤, ì“¸ ìˆ˜ ì—†ëŠ” í† í°ì´ë‹¤
		return false;
	}
	// ìš”ì²­í•  ë•Œ í† í°ì„ Bearer ~~~~~~~~~~ë¼ëŠ” ê°’ìœ¼ë¡œ ë³´ë‚´ëŠ”ë°, í† í°ê°’ë§Œ ë„˜ê²¨ì£¼ê¸° ìœ„í•´ ì•ì— Bearerë¥¼ ì˜ë¼ì£¼ëŠ” ê³¼ì •.
	// í† í° ì•ì— Bearerë¥¼ ë¶™ì¸ ì´ìœ ëŠ” ê°œë°œìë¼ë¦¬ì˜ ì•½ì†ì´ë¼ê³  í•œë‹¤.
	public String getToken(String token) {
		String type = "Bearer ";
		if(StringUtils.hasText(token) && token.startsWith(type)) {
			return token.substring(type.length());
			
		}
		return null;
		
	}
	public Claims getClaims(String token) {
		return Jwts.parserBuilder()
				.setSigningKey(key)
				.build()
				.parseClaimsJws(token)
				.getBody();
	}
	
	public Authentication getAuthentication(String accessToken) {
		Authentication authentication = null;
		
		Claims claims = getClaims(accessToken);		// Claims í†µì§¸ë¡œ ë“¤ê³ ì˜¤ê¸°

		// Springì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì§€ì›í•´ì£¼ëŠ” UserDedatilsì„
		// new User(username, password, ê¶Œí•œ) == PrincipalDetails
		// passwordëŠ” ê³µê°œë˜ë©´ ì•ˆ ë˜ê¸° ë•Œë¬¸ì— ê³µë°±ì´ë‹¤
		User user = userRepository.findUserByEmail(claims.getSubject());
		PrincipalUserDetails principalUserDetails = user.toPrincipal();
		
		// new UsernamePasswordAuthenticationToken(Userê°ì²´, ìê²© ì¦ëª… ê°ì²´(SSL ë“± íšŒì‚¬ë“  ê³µê³µì—ì„œë“  ì¸ì¦ì„œê°€ í•„ìš”í•  ë•Œ. httpsì—ì„œ ì¦ëª…í•  ë•Œ ì“°ì„), ê¶Œí•œ)
		// returní•˜ë©´ ì—…ìºìŠ¤íŒ…ì´ ë¼ì„œ Authentication ê°ì²´ê°€ ëœë‹¤. UsernamePasswordAuthenticationTokenë¥¼ íƒ€ê³  ë“¤ì–´ê°€ë©´ Authenticationì„ implement í•˜ê³  ìˆë‹¤.
		// ì„ì‹œì˜ Authentication ê°ì²´ê°€ ìƒì„±
		authentication = new UsernamePasswordAuthenticationToken(principalUserDetails, null, principalUserDetails.getAuthorities());
		return authentication;
	}
}

```

</br>

- ì—¬ê¸°ì—ë‹¤ê°€ ì •ë¦¬í•˜ë ¤ë‹ˆ ë³µì¡í•´ì„œ í•œ ì¤„ ì£¼ì„ìœ¼ë¡œ ì •ë¦¬ë¥¼ í–ˆë‹¤. ì´ì œ í† í°ì´ ì˜ ê°€ê³µì´ ë˜ë©´ JwtRespDtoë¼ëŠ” ê°ì²´ê°€ ë°˜í™˜ì´ ë˜ëŠ”ë° ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```java

@Builder
@Data
public class JwtRespDto {
	private String grantType;
	private String accessToken;

}

```

</br>

- ì´ì œ ë¡œê·¸ì¸í•  ë•Œ í•„ìš”í•œ ì¸ì¦ì„ ê±°ì¹˜ê³ , ì¸ì¦ì˜ í‘œì‹œì¸ í† í°ê¹Œì§€ ë°œê¸‰ì„ ë°›ê²Œ ë˜ë©´ ì›¹í˜ì´ì§€ì—ì„œ ê¶Œí•œì´ ë“¤ì–´ê°„ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.

ì´ì œ ì¢…í•©ì ìœ¼ë¡œ ë³´ë©´

1. Serviceì—ì„œ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê°€ì§€ê³  ì¸ì¦ì— í•„ìš”í•œ í† í°ì„ í•˜ë‚˜ ë§Œë“ ë‹¤.
2. ê·¸ í† í°ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ìˆëŠ” ìœ ì €ê°€ ë§ëŠ”ì§€ ì´ë©”ì¼ë¡œ í™•ì¸ì„ í•œë‹¤.
3. ì´ë©”ì¼ í™•ì¸ì´ ë˜ë©´ userId, ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸, ê¶Œí•œ ë‚´ìš©ê¹Œì§€ ë°˜í™˜ì„ í•œë‹¤.
4. Authenticationì´ë¼ëŠ” ê°ì²´ê°€ ìƒì„±ì´ ë˜ë©´ì„œ ìœ ì €ê°€ ì¸ì¦ì´ ëœ ê²ƒì´ë‹¤.
5. ìƒì„±ëœ Authentication ê°ì²´ì˜ ì •ë³´ë¥¼ jwtTokenProvider.generateTokenì— ë„˜ê¸°ëŠ”ë° ì—¬ê¸°ì„œ í† í°ì„ ê°€ê³µì„ í•´ì¤€ë‹¤.
6. ì´ìƒì—†ì´ ê°€ê³µì´ ëë‚˜ë©´ ê°€ê³µëœ í† í°ì„ Controllerë¡œ ë°˜í™˜ì„ í•´ì£¼ê³  ì›¹ì—ì„œ ë°›ëŠ”ë‹¤.

---
  
</div>
</details>

<br />

### **í€ë”© ë©”ì¸ í˜ì´ì§€ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°**

<details>
<summary>1. ì¹´í…Œê³ ë¦¬ ì ìš© ì˜ìƒ</summary>
<div markdown="1">
  
![ì¹´í…Œê³ ë¦¬ - Clipchampë¡œ ì œì‘ (1)](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/402755b6-cfc9-4570-8a93-0c4274a2d2e8)

  
</div>
</details>

<details>
<summary>2. ì •ë ¬(ì „ì²´, ì§„í–‰ì¤‘, ì¢…ë£Œ) ì˜ìƒ</summary>
<div markdown="1">

![ì •ë ¬(ì „ì²´, ì§„í–‰ì¤‘, ì¢…ë£Œ)](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/8b3de60f-18f2-4500-bc2b-12b6f255214b)
  
</div>
</details>

<details>
<summary>3. ì •ë ¬(ìµœì‹  ìˆœ, ì°¸ì—¬ ê¸ˆì•¡ ìˆœ, ì°¸ì—¬ìœ¨ ìˆœ, ì¢…ë£Œ ì„ë°• ìˆœ) ì˜ìƒ</summary>
<div markdown="1">
<br/>

- ìµœì‹  ìˆœ
  
![ìµœì‹  ìˆœ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/6ee7a5ac-fa0e-491a-ab49-4d046c3c7a93)

<br/><br/>

- ì°¸ì—¬ê¸ˆì•¡ ìˆœ
  
![ì°¸ì—¬ ê¸ˆì•¡ ìˆœ - Clipchampë¡œ ì œì‘ (1)](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/2c598491-a31d-4f0b-887e-b296e686cd10)

<br/><br/>

- ì°¸ì—¬ìœ¨ ìˆœ

![ì°¸ì—¬ìœ¨ ìˆœ - Clipchampë¡œ ì œì‘ (1)](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/8034d691-c756-449c-b0fe-bd40a648a002)

<br/><br/>

- ì¢…ë£Œ ì„ë°• ìˆœ

![ì¢…ë£Œ ì„ë°• ìˆœ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/edbb6514-334a-4ae8-a8a5-dff336992268)
  
</div>
</details>

<details>
<summary>ì¹´í…Œê³ ë¦¬ ê´€ë ¨ ì½”ë“œ ë¦¬ë·°</summary>
<div markdown="1">

## FrontEnd

**ìš”ì²­**

- ë©”ì¸ í˜ì´ì§€ì— ì“¸ ê²ƒ

```javascript
    const [ searchParam, setSearchParam ] = useState({page: 1, fundingSortingReward: "ìµœì‹  ìˆœ", fundingSortingStatus: "ì „ì²´"});
    const [ refresh, setRefresh ] = useState(true);

    const fundingData = useQuery(["fundingData"], async () => {
        const option = {
            params : {
                ...searchParam
            }
        }
        const response = await axios.get("http://localhost:8080/funding/main", option);
        return response;
    }, {
        enabled: refresh,
        onSuccess: () => {
            setRefresh(false);
        }
    });

```

</br>

- ì¹´í…Œê³ ë¦¬ì— ì“¸ ê²ƒ

```javascript

    const fundingCategorys = useQuery(["fundingCategory"], async () => { 
        return await axios.get("http://localhost:8080/funding/category");
    });

```

</br>

- postìš”ì²­ì„ ë³´ë‚¼ ë• useMutationì„ ì¼ëŠ”ë° ì—¬ê¸°ì„œëŠ” useQueryë¥¼ ì“°ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤. ë¨¼ì €, useMutationì€ post, put, deleteì™€ ê°™ì€ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë°ì— ìˆì–´ì„œ ì“¸ ìˆ˜ ìˆê³ , useQueryëŠ” ë°ì´í„°ë¥¼ ì¡°íšŒí•  ë•Œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— get ìš”ì²­ì— ì“°ì¸ë‹¤. useQueryë„ ë§ˆì°¬ê°€ì§€ë¡œ ìƒíƒœê´€ë¦¬ë‚˜ ì—ëŸ¬ ì²˜ë¦¬ì— ìˆì–´ì„œ ìš©ì´í•˜ê¸°ì— ì‚¬ìš©ì„ í•œë‹¤.

- searchParamì€ í˜ì´ì§€ë„¤ì´ì…˜ê³¼ ì •ë ¬ì„ ê°€ê³µí•˜ê¸° ìœ„í•´ ìš”ì²­ ë°ì´í„°ë¡œ ë³´ëƒˆë‹¤.

- enabledëŠ” ìš”ì²­ì„ í™œì„±í™”í•  ê²ƒì¸ì§€ ë¹„í™œì„±í™”ë¥¼ í•  ê²ƒì¸ì§€ ê²°ì •ì„ í•œë‹¤. ì´ˆê¸°ê°’ì— trueë¥¼ ë„£ì–´ì¤Œìœ¼ë¡œì¨ ì²˜ìŒ ìš”ì²­ì„ ë³´ë‚´ëŠ”ë° í™œì„±í™”ë¥¼ ì‹œí‚¤ê³ , ìš”ì²­ì´ ì˜¤ê³ ë‚˜ë©´ onSuccessê°€ ì‘ë™ì„ í•´ ë‹¤ì‹œ refreshë¥¼ falseë¡œ ì£¼ë©´ì„œ enabledë¥¼ ë¹„í™œì„±í™” ì‹œí‚¤ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ëŠ” ë°ì´í„°ë¥¼ ì²˜ìŒ í•œ ë²ˆë§Œ ê°€ì ¸ì˜¤ë©´ì„œ ì—ëŸ¬ë¥¼ ìµœì†Œí™”ë¥¼ ì‹œí‚¬ ìˆ˜ ìˆê³ , ë¡œë”© ì‹œê°„ë„ ì§§ê²Œ í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì‚¬ìš©ì„ í–ˆë‹¤.

---

</br></br>

**í€ë”© ë©”ì¸ í˜ì´ì§€ html ì½”ë“œ**

```html

<div>
    <div css={welcomeFunding}><FundingSlide /></div>
    <div css={fundingMain}>
	<div css={fundingHeader}>
	    <button css={fundingCategoryMainButton} onClick={() => handleCategoryClick(null)}>ì „ì²´</button>
	    {fundingCategorys.isLoading ? <div>...ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘</div> : fundingCategorys.data.data.map(fundingCategory => (
		<div css={fundingCategoryContainer}>
		    <button css={fundingCategoryButton}
			    onClick={() =>handleCategoryClick(fundingCategory.fundingCategoryId)}
			    key={fundingCategory.fundingCategoryId}>
			{fundingCategory.categoryName}
		    </button>
		</div>
	    ))}
	</div>
	    <div css={sortingFundingStatusContainer}>
		<div css={fundingStatusDetail} onClick={statussortingHidden}>
		    <button css={fundingStatus}>{sortingStatus}</button>
		    <div>{statusHiddenFlag ? "â–³" : "â–½"}</div>
		    {statusHiddenFlag ? (<ul css={sortingFundingStatusList}>
			<li css={sortingFundingStatus} onClick={sortingStatusHandle}>ì „ì²´</li>
			<li css={sortingFundingStatus} onClick={sortingStatusHandle}>ì§„í–‰ì¤‘</li>
			<li css={sortingFundingStatus} onClick={sortingStatusHandle}>ì¢…ë£Œ</li>
		    </ul>) : ""}
		</div>
		<div css={fundingStatusDetail} onClick={rewardsortingHidden}>
		    <button css={fundingStatus}>{sortingReward}</button>
		    <div>{rewardHiddenFlag ? "â–³" : "â–½"}</div>
		{rewardHiddenFlag ? (<ul css={sortingFundingRewardStatusList}>
		    <li css={sortingFundingReward} onClick={sortingRewardHandle}>ìµœì‹  ìˆœ</li>
		    <li css={sortingFundingReward} onClick={sortingRewardHandle}>ì°¸ì—¬ ê¸ˆì•¡ ìˆœ</li>
		    <li css={sortingFundingReward} onClick={sortingRewardHandle}>ì°¸ì—¬ìœ¨ ìˆœ</li>
		    <li css={sortingFundingReward} onClick={sortingRewardHandle}>ì¢…ë£Œ ì„ë°• ìˆœ</li>
		</ul>) : ""}
		</div>
	    </div>
	<div css={fundingMainConatiner}>
	    {fundingData.data.data.fundingList.filter(
	    funding => selectedCategoryId === null ||
	    funding.fundingCategoryId === selectedCategoryId).map(funding => (
		<div css={fundingContainer} onClick={() => {fundingDetailHandle(funding.pageId)}}>
		    <div>
			<div css={imgBox}>
			    <img css={img} src={`http://localhost:8080/image/main/${funding.mainImgUrl}`} />
				<div css={checkFunding({funding})}>
				    <div css={fundingTxt}>í€ë”©</div>
				    <div>{funding.joinPercent >= 100 ? "ì„±ê³µ" : "ì¢…ë£Œ"}</div>
				</div>
			</div>
		    </div>
			<div key={funding.pageId}>
			    <div css={fundingContainerMainTitlePrice}>
				<div css={fundingContainerMainTitlePageTitle}>{funding.pageTitle}</div>
				<div css={fundingContainerMainPricePadding}>
				    <div css={fundingContainerMainPrice}>{funding.joinPercent}%</div>
				</div>
			    </div>
			    <div css={fundingContainerMainUsername}>{funding.fundingSummaryName}</div>
			</div>
		    <div css={fundingContainerFooter}>
			    <div css={fundingContainerFooterEventStatus}>{funding.eventStatus}</div>
			    <div css={fundingContainerFooterPrice}>{new Intl.NumberFormat('en-US').format(funding.totalRewardPrice)}ì›</div>
		    </div>
		</div>
	    ))}
	</div>
	<div>
	    <div css={pageNationContainer}>
		<div css={pageNationIndex} onClick={loadMore}>ë”ë³´ê¸°</div>
	    </div>
	</div>
	    <div css={footerContainer}>
		<Footer />
	    </div>
    </div>
</div>

```

</br>

- ì¹´í…Œê³ ë¦¬ì— ì „ì²´ë§Œ ë”°ë¡œ ë¹¼ë†“ì€ ì´ìœ ëŠ” í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ì—ëŠ” ì „ì²´ë¼ëŠ” ì¹´í…Œê³ ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•Šì•„ ë”°ë¡œ ì²˜ë¦¬í•´ì£¼ì—ˆë‹¤. onClick ì†ì„± ì•ˆì— handleCategoryClickì€ categoryIdë¥¼ ë„˜ê²¨ì¤€ë‹¤.

- ì •ë ¬ ë°©ì‹ì—ì„œ ì—´ë¦¼ê³¼ ë‹«í˜ì„ ë„£ê¸° ìœ„í•´ í´ë¦­ ì‹œì— ì‘ë™í•˜ëŠ” true false ìƒíƒœë¥¼ ì£¼ì—ˆë‹¤.

- í€ë”© ê¸°ê°„ì´ ì¢…ë£Œê°€ ëì„ ë•Œ í€ë”© ê¸ˆì•¡ì´ ëª©í‘œ ê¸ˆì•¡ì— 100í¼ì„¼íŠ¸ ë¯¸ë§Œì¼ ê²½ìš°ì— ì¢…ë£Œ, ì´ìƒì¼ ê²½ìš°ì— ì„±ê³µì„ ì¤Œìœ¼ë¡œì¨ ìœ ì €ë“¤ì´ ì¢…ë£Œëœ í€ë”© ìƒí’ˆë“¤ì˜ ê°€ì¹˜ë¥¼ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.

- ë‚˜ë¨¸ì§€ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë“¤ê³ ì˜¨ ë°ì´í„°ë“¤ì„ ê·¸ëŒ€ë¡œ ë„£ì–´ì¤€ ê²ƒ.

---

</br></br>

**ì‘ë‹µ ë°›ì€ ë°ì´í„° ê°€ê³µ**

```javascript

    const handleCategoryClick = (categoryId) => {
        setSelectedCategoryId(categoryId);
    };

    const statussortingHidden = () => {
        if(statusHiddenFlag) {
            setStatusHiddenFlag(false);
        }else {
            setStatusHiddenFlag(true);
        }
    }

    const rewardsortingHidden = () => {
        if(rewardHiddenFlag) {
            setRewardHiddenFlag(false);
        }else {
            setRewardHiddenFlag(true);
        }
    }

    const sortingStatusHandle = (e) => {
        const statusText = e.target.textContent;
        setSearchParam({...searchParam, fundingSortingStatus: statusText, page: 1})
        setSortingStatus(statusText);
        setStatusHiddenFlag(false);
        setRefresh(true);
    }

    const sortingRewardHandle = (e) => {
        const rewardText = e.target.textContent;
        setSearchParam({ ...searchParam, fundingSortingReward: rewardText, page: 1});
        setSortingReward(rewardText);
        setRewardHiddenFlag(false);
        setRefresh(true);
    };

    const fundingDetailHandle = (pageId) => {
        navigate("/funding/" + pageId);
    }

    const loadMore = () => {
        if(!refresh) {
            setSearchParam({ ...searchParam, page: searchParam.page + 1});
            setRefresh(true);
        }
    };

```

</br>

- ì¹´í…Œê³ ë¦¬ ì„ íƒì— ë³´ë©´ htmlì—ì„œ ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ idê°€ ë“¤ì–´ê°€ëŠ”ë° ê·¸ëŸ¬ë©´ ê·¸ idì— í•´ë‹¹í•˜ëŠ” ëª©ë¡ë“¤ë§Œ ë³´ì—¬ì§„ë‹¤. ì´ˆê¸° ê°’ì€ nullì¸ë° ì•„ë¬´ê²ƒë„ ëˆ„ë¥´ì§€ ì•Šì€ nullì¸ ìƒíƒœë©´ ì „ë¶€ ë‹¤ ë³´ì—¬ì§€ëŠ” ì „ì²´ ì¹´í…Œê³ ë¦¬ë„ ë§Œë“¤ì—ˆë‹¤.

- ì •ë ¬ ë²„íŠ¼ ì—´ê³  ë‹«ê¸°

- ì •ë ¬ì˜ ìƒíƒœê°€ ë°”ë€Œë©´ ë°”ë€ ê°’ì„ ë„£ì–´ì£¼ë©´ì„œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•¨.

- ë³´ê³  ì‹¶ì€ í€ë”©ì˜ ìƒì„¸ ë‚´ìš©ì´ ê¶ê¸ˆí•´ í´ë¦­ì„ í•˜ë©´ í€ë”© ìƒì„¸í˜ì´ì§€ë¡œ ì´ë™ì„ í•œë‹¤.

- ë”ë³´ê¸°ë¥¼ ëˆ„ë¥¼ ë•Œ ë§ˆë‹¤ indexê°€ 0ë¶€í„° 1ì”© ì¦ê°€í•˜ëŠ”ë° ìì„¸í•œ í˜ì´ì§€ë„¤ì´ì…˜ ê¸°ëŠ¥ì€ ì•„ë˜ ì½”ë“œ ë¦¬ë·°ì—ì„œ ì§„í–‰í•  ê²ƒì´ë‹¤. 

---

</br></br>

## BackEnd

**Controller**

```java

@RestController
@RequiredArgsConstructor
@RequestMapping("/funding")
public class FundingMainController {
 
	private final FundingService fundingService;
	
	@GetMapping("/main")
	public ResponseEntity<?> fundingData(FundingEventReqDto fundingMainReqDto) {
		System.out.println(fundingMainReqDto);
		return ResponseEntity.ok(fundingService.toSaveFunding(fundingMainReqDto));
	}
	
	@GetMapping("/category")
	public ResponseEntity<?> fundingCategory() {
		return ResponseEntity.ok(fundingService.fundingCategory());
	}
	
}

```

- ìœ„ì—ì„œ ë³´ë‚¸ ìš”ì²­ ë°ì´í„°ë¥¼ ë°›ê³  Serviceë¡œ ë„˜ê¸´ë‹¤.

---

</br></br>

**Dto**

```java

@Data
public class FundingEventReqDto {
	private int page;
	private String fundingSortingReward;
	private String fundingSortingStatus;
}

```

- ìš”ì²­ì—ì„œ ë³´ë‚¸ ê²ƒì²˜ëŸ¼ ê¸°ë³¸ ê°’ìœ¼ë¡œ page: 1, fundingSortingReward: ìµœì‹  ìˆœ, fundingSortingStatus: ì „ì²´ê°€ê°€ ë“¤ì–´ê°„ë‹¤.

---

</br></br>

**Service**

```java

@Service
@RequiredArgsConstructor
public class FundingService {
	private final FundingRepository fundingRepository;
	
	public Map<String, Object> toSaveFunding(FundingEventReqDto fundingEventReqDto) {
		List<FundingMainRespDto> fundingList = new ArrayList<>();

		int index = (fundingEventReqDto.getPage() * 20) - 1;
		Map<String, Object> eventStatusMap = new HashMap<>();
		eventStatusMap.put("index", index);
		eventStatusMap.put("fundingSortingReward", fundingEventReqDto.getFundingSortingReward());
		eventStatusMap.put("fundingSortingStatus", fundingEventReqDto.getFundingSortingStatus());
		
		fundingRepository.saveFunding(eventStatusMap).forEach(funding -> {
			fundingList.add(funding.toSaveFunding());
		});
		
		Map<String, Object> responseMap = new HashMap<>();
		responseMap.put("fundingList", fundingList);
		return responseMap;
	}
	
	public List<FundingCategoryRespDto> fundingCategory() {
		List<FundingCategoryRespDto> fundingCategorys = new ArrayList<>();
		
		fundingRepository.getFundingCategory().forEach(fundingCategory -> {
			fundingCategorys.add(fundingCategory.fundingCategoryToDto());
		});
		return fundingCategorys;
	}
	
	
}

```

- FundingMainRespDto, FundingCategoryRespDtoì—ëŠ” í€ë”© ë©”ì¸í˜ì´ì§€ì— í•„ìš”í•œ sqlì—ì„œ ê°€ê³µí•œ ë°ì´í„°ê°€ ë“¤ì–´ê°„ë‹¤. ë§ì€ ë°ì´í„°ê°€ ë‹´ê²¨ìˆê¸° ë•Œë¬¸ì— Listë¡œ ë‹´ì•˜ë‹¤.

- pageëŠ” ë”ë³´ê¸°ë¥¼ í´ë¦­í• ìˆ˜ë¡ 20ê°œì”© ë³´ì—¬ì§€ê¸° ìœ„í•´ pageê°€ 1ë¶€í„° ì¦ê°€í•  ë•Œ ë§ˆ 20ì„ ê³±í•˜ë„ë¡ í–ˆë‹¤.

- Mapì„ ì¨ì¤€ ì´ìœ ëŠ” í”„ë¡ íŠ¸ì—ì„œ ë°ì´í„°ë¥¼ íŒŒì•…í•˜ê¸° ì‰½ê²Œ valueì— ê±¸ë§ì€ key ê°’ì„ ì„¤ì •ì„ í•´ì£¼ê³  ìˆë‹¤.

- ë‚˜ë¨¸ì§€ë„ sqlì—ì„œ ê°€ê³µí•œ ë°ì´í„°ë¥¼ ë“¤ê³ ì˜¨ë‹¤.

- ë’¤ì—ì„œë„ ì´ëŸ° í˜•ì‹ì˜ ì½”ë“œë¥¼ ì£¼ë¡œ ì‚¬ìš©í•  ê²ƒì´ë‹¤.

---

</br></br>

**ResponseDto**

- í€ë”© ë©”ì¸

```java

@Builder
@Data
public class FundingMainRespDto {
	private int pageId;
	private String fundingSummaryName;
	private String pageTitle;
	private int recentSort;
	private String nearDeadlineSort;
	private String eventStatus;
	private int goalTotal;
	private int totalRewardPrice;
	private int joinPercent;
	private String mainImgUrl;
	private int fundingCategoryId;
}

```

</br>

- í€ë”© ë©”ì¸ í˜ì´ì§€ì— ì‚¬ìš©í•  ê²ƒë“¤ì´ë‹¤. ìˆœì„œëŒ€ë¡œ
  	- pageIdëŠ” ìƒì„¸ í˜ì´ì§€ ì´ë™ì„ ìœ„í•´ ë„£ì–´ì¤Œ.

  	- fundingSummaryNameì€ ê¸°ì—…ì²´ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë‹‰ë„¤ì„ì„ ëœ»í•¨.

  	- pageTitleì€ í€ë”© ì œëª©.
  	
   	- recentSortëŠ” ìµœì‹  ìˆœë¶€í„° ìˆ«ìë¡œ í‘œì‹œí–ˆë‹¤.
  	
   	- nearDeadlineSortëŠ” ì¢…ë£Œ ì„ë°• ìˆœì„ ìˆ«ìë¡œ í‘œì‹œí–ˆë‹¤.
  	
   	- eventStatusëŠ” ì¢…ë£Œê¹Œì§€ ë‚¨ì€ ì¼ ìˆ˜ë¥¼ í‘œì‹œí•´ì¤€ë‹¤.
  	
   	- goalTotalì€ ëª©í‘œ ê¸ˆì•¡.
  	
   	- totalRewardPriceëŠ” í€ë”©í•œ ì‚¬ëŒë“¤ì˜ ì´ ê¸ˆì•¡ì´ë‹¤.
  	
   	- joinPercentëŠ” ëª©í‘œ ê¸ˆì•¡ ëŒ€ë¹„ ì°¸ì—¬í•œ ê¸ˆì•¡ ìˆ˜ì˜ ì´ í¼ì„¼íŠ¸ì´ë‹¤.
  	
   	- mainImgUrlì€ í€ë”©ì— ë“¤ì–´ê°ˆ ì´ë¯¸ì§€ë‹¤.
  	
   	- fundingCategoryIdëŠ” ì¹´í…Œê³ ë¦¬ í…Œì´ë¸”ì— ìˆëŠ” categoryId.

---

</br>

- í€ë”© ì¹´í…Œê³ ë¦¬

```java

@Data
@Builder
public class FundingCategoryRespDto {
	private int fundingCategoryId;
	private String categoryName;
}

```

- ì¹´í…Œê³ ë¦¬ í…Œì´ë¸”ì— ìˆëŠ” ê²ƒ. ë‚´ìš©ì€ ì•„ë˜ Databaseì— ì‚¬ì§„ì„ ì²¨ë¶€í•  ê²ƒì´ë‹¤. 

---

</br></br>

**Entity**

- Funding

```java

@Builder
@Data
@AllArgsConstructor
@NoArgsConstructor
public class Funding {
	private int fundingId;
	private int userId;
	private String fundingTitle;
	private LocalDate endDate;
	private String fundingSummaryName;
	private String username;
	private int recentSort;
	private String nearDeadline;
	private String eventStatus;
	private int goalTotal;
	private int totalRewardPrice;
	private int joinPercent;
	private String mainImgUrl;
	private String subImgUrl;
	private int fundingCategoryId;
	private String storyTitle;
	private String storyContent;
	
	public FundingMainRespDto toSaveFunding() {
		return FundingMainRespDto.builder()
				.pageId(fundingId)
				.fundingSummaryName(fundingSummaryName)
				.pageTitle(fundingTitle)
				.recentSort(recentSort)
				.nearDeadlineSort(nearDeadline)
				.eventStatus(eventStatus)
				.goalTotal(goalTotal)
				.totalRewardPrice(totalRewardPrice)
				.joinPercent(joinPercent)
				.mainImgUrl(mainImgUrl)
				.fundingCategoryId(fundingCategoryId)
				.build();
	}
}

```

</br>

- Funding ê°ì²´ì— ë©”ì¸ í˜ì´ì§€ì™€ ìƒì„¸ í˜ì´ì§€ì—ì„œ ì“¸ ê²ƒë“¤ì„ í•œ ë²ˆì— ëª¨ì•„ë†¨ë‹¤.

- ìœ„ì—ì„œ ë‹¤ë£¬ ê²ƒì²˜ëŸ¼ í€ë”© ë©”ì¸ í˜ì´ì§€ì— ì‚¬ìš©ë  ê²ƒë“¤ë§Œ ë”°ë¡œ toSaveFundingì´ë€ ê²ƒì„ ë§Œë“¤ì—ˆëŠ”ë°, ë‚˜ë¨¸ì§€ëŠ” ìƒì„¸ í˜ì´ì§€ì—ì„œ ë‹¤ë£° ê²ƒì´ë‹¤.

- Builderë¥¼ ì´ìš©í•˜ì—¬ sqlì—ì„œ ê°€ê³µí•œ ê²ƒë“¤ì„ Funding ê°ì²´ë¡œ ë°˜í™˜ì„ í•˜ê³ , ê°€ê³µëœ ê²ƒë“¤ì„ ë‹¤ì‹œ FundingMainRespDtoì— ë‹´ì•„ì„œ ë°˜í™˜ì„ í•œë‹¤. 

---

</br></br>

**Repository**

```java

@Mapper
public interface FundingRepository {
	public List<FundingCategory> getFundingCategory();
	public List<Funding> saveFunding(Map<String, Object> eventStatusMap);
}

```

</br>

- ì¹´í…Œê³ ë¦¬ëŠ” ìš”ì²­ ë°ì´í„° ì—†ì´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œë§Œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ë“¤ê³ ì™€ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë§¤ê°œë³€ìˆ˜ê°€ ì—†ìŒ.

- ìœ„ì—ì„œ keyì™€ valueë¥¼ ì„¤ì •í•´ì¤¬ëŠ”ë°, ì´ëŠ” ì•„ë˜ sqlë¬¸ì—ì„œ ì‚¬ìš©ë  ê²ƒì´ë‹¤.

---

</br></br>

**Sql**

- ì „ì²´

```sql

<select id="saveFunding" parameterType="hashMap" resultMap="FundingMap">

	<if test="fundingSortingStatus == 'ì „ì²´'">
		select 
		    fpt.funding_id AS page_id,
		    fpt.funding_summary_name,
		    fpt.funding_name AS page_title,
	      	    DATEDIFF(NOW(), fpt.register_date) as recent_sort,
		    DATEDIFF(fpt.end_date, NOW()) as near_deadline_sort,
		    CONCAT(
		    IF(NOW() &lt; fpt.end_date,  CONCAT(DATEDIFF(fpt.end_date, NOW()), 'ì¼ ë‚¨ìŒ'), IF(DATEDIFF(NOW(), fpt.end_date) = 0, 'ì˜¤ëŠ˜ ë§ˆê°', 'ì¢…ë£Œ'))
		    ) AS event_status,
	            fpt.goal_total,
		    IFNULL(sum(if(ft.funder_id is null, null, rt.reward_price)), 0) as total_reward_price,
		    IFNULL(ROUND((sum(if(ft.funder_id is null, null, rt.reward_price)) / fpt.goal_total) * 100), 0) as join_percent,
		    fpt.main_img_url AS main_img_url,
		    fpt.funding_category_id
		from
		   funding_page_tb fpt
		    left outer join reward_tb rt on(rt.funding_id = fpt.funding_id)
		    left outer join funder_tb ft on(ft.reward_id = rt.reward_id)
		    left outer join funding_category_tb fct on(fct.funding_category_id = fpt.funding_category_id)

		<if test="fundingSortingReward == 'ì¢…ë£Œ ì„ë°• ìˆœ'">
		where
		    DATEDIFF(fpt.end_date, NOW()) >= 0
		</if>

		group by
		    page_id,
	            funding_summary_name,
	            page_title,
	            recent_sort,
	            near_deadline_sort,
		    event_status,
	            goal_total,
	            main_img_url,
	            funding_category_id

		<if test="fundingSortingReward == 'ìµœì‹  ìˆœ'">
		order by
		    recent_sort,
		    page_id DESC
		limit 0, #{index};
		</if>
	
		<if test="fundingSortingReward == 'ì°¸ì—¬ ê¸ˆì•¡ ìˆœ'">
		order by
		    total_reward_price DESC,
		    page_id
		limit 0, #{index};
		</if>
		
		<if test="fundingSortingReward == 'ì°¸ì—¬ìœ¨ ìˆœ'">
		order by
		    join_percent DESC,
		    page_id
		limit 0, #{index};
		</if>
		
		<if test="fundingSortingReward == 'ì¢…ë£Œ ì„ë°• ìˆœ'">
		order by
		    DATEDIFF(fpt.end_date, NOW()),
		    page_id
		limit 0, #{index};
		</if>
	</if>

```

</br>

- ì§„í–‰ì¤‘

```sql

	<if test="fundingSortingStatus == 'ì§„í–‰ì¤‘'">
		select 
	            fpt.funding_id AS page_id,
		    fpt.funding_summary_name,
		    fpt.funding_name AS page_title,
		    DATEDIFF(NOW(), fpt.register_date) as recent_sort,
		    DATEDIFF(fpt.end_date, NOW()) as near_deadline_sort,
		    CONCAT(
		    IF(NOW() &lt; fpt.end_date,  CONCAT(DATEDIFF(fpt.end_date, NOW()), 'ì¼ ë‚¨ìŒ'), IF(DATEDIFF(NOW(), fpt.end_date) = 0, 'ì˜¤ëŠ˜ ë§ˆê°', 'ì¢…ë£Œ'))
		    ) AS event_status,
		    fpt.goal_total,
		    IFNULL(sum(if(ft.funder_id is null, null, rt.reward_price)), 0) as total_reward_price,
		    IFNULL(ROUND((sum(if(ft.funder_id is null, null, rt.reward_price)) / fpt.goal_total) * 100), 0) as join_percent,
		    fpt.main_img_url AS main_img_url,
		    fpt.funding_category_id
		from
		    funding_page_tb fpt
	            left outer join reward_tb rt on(rt.funding_id = fpt.funding_id)
	            left outer join funder_tb ft on(ft.reward_id = rt.reward_id)
	   	    left outer join funding_category_tb fct on(fct.funding_category_id = fpt.funding_category_id)
		where
		    DATEDIFF(fpt.end_date, NOW()) >= 0
		group by
		    page_id,
		    funding_summary_name,
		    page_title,
		    recent_sort,
		    near_deadline_sort,
		    event_status,
		    goal_total,
		    main_img_url,
		    funding_category_id
			
		<if test="fundingSortingReward == 'ìµœì‹  ìˆœ'">
		order by
		    recent_sort,
		    page_id DESC
		limit 0, #{index};
		</if>	
		
		<if test="fundingSortingReward == 'ì°¸ì—¬ ê¸ˆì•¡ ìˆœ'">
		order by
		    total_reward_price DESC,
		    page_id
		limit 0, #{index};
		</if>
		
		<if test="fundingSortingReward == 'ì°¸ì—¬ìœ¨ ìˆœ'">
		order by
		    join_percent DESC,
		    page_id
		limit 0, #{index};
		</if>
		
		<if test="fundingSortingReward == 'ì¢…ë£Œ ì„ë°• ìˆœ'">
		order by
		    DATEDIFF(fpt.end_date, NOW()),
		    page_id
		limit 0, #{index};
		</if>
	</if>

```

</br>

- ì¢…ë£Œ

```sql

	<if test="fundingSortingStatus == 'ì¢…ë£Œ'">
		select 
			fpt.funding_id AS page_id,
			fpt.funding_summary_name,
			fpt.funding_name AS page_title,
			DATEDIFF(NOW(), fpt.register_date) as recent_sort,
			DATEDIFF(fpt.end_date, NOW()) as near_deadline_sort,
			CONCAT(
			IF(NOW() &lt; fpt.end_date,  CONCAT(DATEDIFF(fpt.end_date, NOW()), 'ì¼ ë‚¨ìŒ'), IF(DATEDIFF(NOW(), fpt.end_date) = 0, 'ì˜¤ëŠ˜ ë§ˆê°', 'ì¢…ë£Œ'))
			) AS event_status,
			fpt.goal_total,
		    IFNULL(sum(if(ft.funder_id is null, null, rt.reward_price)), 0) as total_reward_price,
			IFNULL(ROUND((sum(if(ft.funder_id is null, null, rt.reward_price)) / fpt.goal_total) * 100), 0) as join_percent,
			fpt.main_img_url AS main_img_url,
			fpt.funding_category_id
		from
		   funding_page_tb fpt
			left outer join reward_tb rt on(rt.funding_id = fpt.funding_id)
			left outer join funder_tb ft on(ft.reward_id = rt.reward_id)
			left outer join funding_category_tb fct on(fct.funding_category_id = fpt.funding_category_id)
		where
			DATEDIFF(fpt.end_date, NOW()) &lt; 0
		group by
		   	page_id,
            		funding_summary_name,
			page_title,
            		recent_sort,
            		near_deadline_sort,
			event_status,
			goal_total,
			main_img_url,
			funding_category_id
			
		<if test="fundingSortingReward == 'ìµœì‹  ìˆœ'">
		order by
			recent_sort,
			page_id DESC
		limit 0, #{index};
		</if>	
		
		<if test="fundingSortingReward == 'ì°¸ì—¬ ê¸ˆì•¡ ìˆœ'">
		order by
			total_reward_price DESC,
			page_id
		limit 0, #{index};
		</if>
		
		<if test="fundingSortingReward == 'ì°¸ì—¬ìœ¨ ìˆœ'">
		order by
			join_percent DESC,
			page_id
		limit 0, #{index};
		</if>
		
		<if test="fundingSortingReward == 'ì¢…ë£Œ ì„ë°• ìˆœ'">
		order by
		    DATEDIFF(fpt.end_date, NOW()),
		    page_id
		limit 0, #{index};
		</if>
	</if>

</select>

```

</br>

- 3ê°€ì§€ ë‹¤ í˜•ì‹ì´ ë˜‘ê°™ì•„ì„œ "ì „ì²´"ë§Œ ë‹¤ë¤„ë³´ê² ë‹¤.

- join
	- reward í…Œì´ë¸”ì—ëŠ” í•´ë‹¹ í€ë”©ì˜ ë¦¬ì›Œë“œì™€ ê·¸ ê¸ˆì•¡ë“¤ì´ ë“¤ì–´ê°€ìˆë‹¤.
   
  	- funder í…Œì´ë¸”ì—ëŠ” í€ë”©í•œ ì‚¬ëŒë“¤ì˜ ëª©ë¡ë“¤ì´ ìˆë‹¤.
  	
   	- ì´ë¥¼ í† ëŒ€ë¡œ í•´ë‹¹ í€ë”©ì„ í•œ ì‚¬ëŒë“¤ì˜ ì´ ê¸ˆì•¡ê³¼ ëª©í‘œ ê¸ˆì•¡ ëŒ€ë¹„ í¼ì„¼íŠ¸ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.
 
- ì¡°íšŒ
	- recentSortê°€ ìœ„ì—ì„œ ë§í–ˆë˜ ìµœì‹  ìˆœì¸ë° ì´ëŠ” ì˜¤ëŠ˜ ë‚ ì§œì—ì„œ ë“±ë¡ ë‚ ì§œë¥¼ ë¹¼ì¤€ë‹¤. ê·¸ëŸ¼ ìˆ«ìê°€ ì‘ì„ìˆ˜ë¡ ìµœì‹  ìˆœì´ ëœë‹¤.

  	- nearDeadlineSortëŠ” ì¢…ë£Œ ì„ë°• ìˆœì¸ë° ì´ëŠ” ì¢…ë£Œ ë‚ ì§œì—ì„œ ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ë¹¼ì¤€ë‹¤. ê·¸ëŸ¼ ìˆ«ìê°€ ì‘ì„ìˆ˜ë¡ ì¢…ë£Œ ì„ë°•ìˆœì´ ëœë‹¤. ì´ ìˆ«ìë¥¼ í† ëŒ€ë¡œ ë””ë°ì´ë¥¼ ì„¤ì •í•  ìˆ˜ 		ìˆëŠ”ë°, ë¬¸ì œê°€ ì˜¤ëŠ˜ ë‚ ì§œì¼ ë•Œì™€ ì¢…ë£Œ ë‚ ì§œê°€ ì§€ë‚¬ì„ ë•Œ 0ê³¼ -1~ ì´ë ‡ê²Œ ë– ë²„ë ¸ë‹¤. ê·¸ë˜ì„œ ì¡°ê±´ìœ¼ë¡œ í‰ìƒì‹œì—ëŠ” ~ì¼ ë‚¨ìŒì´ë¼ê³  ë¬¸ìì—´ì„ í•©ì¹˜ê³ , ì˜¤ëŠ˜ ë‚ ì§œì—ì„œ ì¢…ë£Œ 	ë‚ ì§œë¥¼ ëºì„ ë•Œ 0ì´ë©´(D-Day) ì˜¤ëŠ˜ ë§ˆê°, ì•„ë‹ˆë©´(ê¸°ê°„ì´ ì§€ë‚¬ì„ ë•Œ) ì¢…ë£Œë¡œ ì„¤ì •ì„ í•´ì£¼ì—ˆë‹¤.
  	
   	- funder_idê°€ nullì´ë©´(í€ë”©ì„ í•œ ì‚¬ëŒì´ ì—†ë‹¤.) nullì„ ë°˜í™˜í•œë‹¤. ì´ëŠ” 0ì„ ë°˜í™˜í•˜ëŠ” ê²ƒì„. funder_idê°€ ì¡´ì¬í•˜ë©´ ê·¸ ìœ ì €ê°€ í€ë”©í•œ ë¦¬ì›Œë“œì˜ ê°€ê²©ì„ ëª¨ë‘ í•©ì‚°í•¨.
  	
   	- ìœ„ë¥¼ í† ëŒ€ë¡œ ëª©í‘œ ê¸ˆì•¡ ëŒ€ë¹„ í¼ì„¼íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ ë§Œë“¤ì–´ì¤¬ë‹¤. í¼ì„¼íŠ¸ë¥¼ êµ¬í•œ í›„, ì†Œìˆ˜ì  ì œê±°ë¥¼ ìœ„í•´ Round í•¨ìˆ˜ë¥¼ ì¼ë‹¤.
  	
   	- ë‚˜ë¨¸ì§€ëŠ” ì¡°íšŒì—ì„œ ë³´ì—¬ì¤€ ëŒ€ë¡œ ì¡°ê±´ì— ë§ê²Œ ì •ë ¬ì„ ê±¸ì–´ì¤¬ë‹¤.
  	
   	- ë§ˆì§€ë§‰ì€ í˜ì´ì§€ë„¤ì´ì…˜ì„ ê±¸ì–´ì£¼ê¸° ìœ„í•´ limitì„ ì‚¬ìš©í–ˆëŠ”ë° ì˜ˆë¥¼ ë“¤ì–´ limit 0, 19ë©´ 0ë¶€í„° 19ê¹Œì§€ ì´ 20ê°œë§Œ ì¶œë ¥ì´ ëœë‹¤. ê·¸ ë‹¤ìŒ í˜ì´ì§€ê°€ ëŠ˜ì–´ì„œ 0ë¶€í„° 39, 0
  	  ë¶€í„° 59 ì´ëŸ° ì‹ìœ¼ë¡œ ë‚˜ì˜¤ê²Œ ëœë‹¤.
  	  
---

</br></br>

**Database**

- í€ë”© ë©”ì¸ í˜ì´ì§€ í…Œì´ë¸”

![í€ë”© ë©”ì¸ í˜ì´ì§€](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/78cb3dee-00d1-4ada-8dd4-91356545692a)

</br>

- ìµœì‹  ìˆœ ì •ë ¬

![ìµœì‹  ìˆœ](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/f19ec76e-63ca-4cbb-ad17-eebaf3f5b4e5)

</br>

- ë¦¬ì›Œë“œ í…Œì´ë¸”

![ë¦¬ì›Œë“œ](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/b1e3542c-cf36-4e2b-8219-04c3b6fd0916)

</br>

- í€ë”©í•œ ì‚¬ëŒ í…Œì´ë¸”

![í€ë”©í•œ ì‚¬ëŒ](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/11a6b9d0-35c2-448e-a999-debdbedd4072)
  
</div>
</details>

<br/>

### **í€ë”© ìƒì„¸ í˜ì´ì§€ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°**

<details>
<summary>í˜„ì¬ ì§„í–‰ ì¤‘ì¸ í€ë”© ì˜ìƒ</summary>
<div markdown="1">

![ìƒì„¸í˜ì´ì§€ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/03dbfdd9-aa06-49b6-ae18-cbc3eb8a917a)

</div>
</details>

<details>
<summary>í€ë”© ì°¸ì—¬í•˜ê¸°(ê²°ì œ) ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°, HTTP ë³´ì•ˆ ì„¤ì •</summary>
<div markdown="1">

![ê²°ì œ ì²˜ìŒ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/efa13972-cf36-46ce-8d24-88ef1951057a)

<br/><br/>

![KakaoTalk_20230624_165355960_01](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/3fab79c9-46f7-4985-8761-4cdb7d354bed)

<br/><br/>

![KakaoTalk_20230624_165355960_02](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/bf156ff1-3fbe-4c58-aba3-f42d68983b0c)

<br/><br/>

![KakaoTalk_20230624_165355960_03](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/d8413386-8d92-42d4-a32c-69af3ceb6727)

<br/><br/>

--- ê²°ì œ ì‹œìŠ¤í…œ ---

êµ¬ê¸€ì—ì„œ ë¦¬ì•¡íŠ¸ ì•„ì„í¬íŠ¸ ê²€ìƒ‰ ->

https://velog.io/@gunilna/%ED%8F%AC%ED%8A%B8%EC%9B%90-Front-end-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0

</br> 

í¬íŠ¸ì› ê²€ìƒ‰ ->

https://portone.io/korea/ko?utm_source=google&utm_medium=google_sa&utm_campaign=pf_conversion_2302_kr&utm_content=homepage&gclid=CjwKCAjwvdajBhBEEiwAeMh1U6u6y3g3vQLBloftPyxVmnOSARlJ2tDDjQz4Yon9REbYIoPVpeeAKBoCAvQQAvD_BwE 

</br>

-> íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ -> ê²°ì œ ì—°ë™ -> ë‚´ ì‹ë³„ ì½”ë“œ -> ê°€ë§¹ì  ì‹ë³„ ì½”ë“œê°€ ì¤‘ìš”í•¨! -> ê²°ì œ ëŒ€í–‰ì‚¬ ì„¤ì • -> í…ŒìŠ¤íŠ¸, ì¹´ì¹´ì˜¤í˜ì´, ì¹´ì¹´ì˜¤í˜ì´

</br>

https://portone.gitbook.io/docs/tip/pg-2

pgì‚¬ëŠ” ì´ê±¸ ì°¸ê³ í•˜ë©´ ëœë‹¤.

</br>

https://portone.gitbook.io/docs/sdk/javascript-sdk/payrq

ì´ê±¸ ê¸°ì¤€ìœ¼ë¡œ ë‚´ê°€ ë°›ê³  ì‹¶ì€ ë°ì´í„°ë¡œ ë°›ìœ¼ë©´ ë¨

ê²°ì œê°€ ì™„ë£Œ ë˜ë©´

https://admin.portone.io/payments

ì—¬ê¸°ì„œ í™•ì¸ ê°€ëŠ¥.

í…ŒìŠ¤íŠ¸ëŠ” ë¬´ë£Œì„

</br></br>

## FrontEnd

**ê²°ì œ ì„œë¹„ìŠ¤**

```javascript

    const [ authenticated, setAuthenticated ] = useRecoilState(authenticatedState);

    useEffect(() => {
        const iamport = document.createElement("script");
        iamport.src = "https://cdn.iamport.kr/v1/iamport.js"
        document.head.appendChild(iamport);
        return () => {
            document.head.removeChild(iamport);
        }
    });

    useEffect(() => {
        if (accessToken) {
          setAuthenticated(true);
        } else {
          setAuthenticated(false);
        }
    }, []);

    const joinFunding = () => {
        if (!authenticated) {
            alert("ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.")
            navigate('/login');
        } else if (rewards.length === 0) {
            alert("ë¦¬ì›Œë“œ ìˆ˜ëŸ‰ê³¼ ì˜µì…˜ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
        } else {
            setIsOpen(true);
        }
    }

    const joinSubmitHandle = () => {
        if (!window.IMP) return;
        /* 1. ê°€ë§¹ì  ì‹ë³„í•˜ê¸° */
        const { IMP } = window;
        IMP.init("imp26700005"); // ê°€ë§¹ì  ì‹ë³„ì½”ë“œ

        /* 2. ê²°ì œ ë°ì´í„° ì •ì˜í•˜ê¸° */
        const data = {
            pg: "kakaopay", // PGì‚¬ : https://portone.gitbook.io/docs/sdk/javascript-sdk/payrq#undefined-1 ì°¸ê³ 
            pay_method: "kakaopay", // ê²°ì œìˆ˜ë‹¨
            merchant_uid: `mid_${new Date().getTime()}`, // ì£¼ë¬¸ë²ˆí˜¸
            amount: totalPrice, // ê²°ì œê¸ˆì•¡
            name: funding.fundingTitle, // ì£¼ë¬¸ëª…
            buyer_name: principalUser.data.data.name, // êµ¬ë§¤ì ì´ë¦„
            buyer_tel: principalUser.data.data.phoneNumber, // êµ¬ë§¤ì ì „í™”ë²ˆí˜¸
            buyer_email: principalUser.data.data.email, // êµ¬ë§¤ì ì´ë©”ì¼
            buyer_addr: getAddress.data.data.address // êµ¬ë§¤ì ì£¼ì†Œ
        };

        const rewardIds = [];
        const counts = [];
        rewards.map(reward => (rewardIds.push(reward.fundingReward.rewardId), counts.push(reward.fundingReward.count)));

        /* 4. ê²°ì œ ì°½ í˜¸ì¶œí•˜ê¸° */
        IMP.request_pay(data, (response) => {
            const { success, error_msg } = response;

            if (success) {
                alert("ê²°ì œ ì„±ê³µ");
                joinFund.mutate({
                    userId: principalUser.data.data.userId,
                    addressId: getAddress.data.data.addressId,
                    rewardIds: rewardIds,
                    counts: counts
                });
            } else {
                alert(`ê²°ì œ ì‹¤íŒ¨: ${error_msg}`);
            }
        });
    };

```

</br>

- useEffectì—ì„œ ì•„ì„í¬íŠ¸ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ êµ¬ì¶•í•œë‹¤.

- í€ë”© ì°¸ì—¬í•˜ê¸° ë²„íŠ¼ì„ í´ë¦­í–ˆì„ ë•Œ ë¡œê·¸ì¸ì´ ëœ ìœ ì € ì¦‰, ì¸ì¦ì´ ëœ ìœ ì €ì— í•œí•´ì„œë§Œ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •ì„ í–ˆë‹¤. ì¸ì¦ì´ ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ë²„íŠ¼ì„ í´ë¦­í–ˆì„ ë•Œ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ë³´ë‚´ê²Œ í•˜ê³ , ìˆ˜ëŸ‰ê³¼ ì˜µì…˜ì„ ì„ íƒí•˜ì§€ ì•Šê³  í´ë¦­ì„ í•˜ë©´ alertì°½ì„ ë„ìš°ê²Œ í–ˆë‹¤. authenticatedëŠ” ìœ„ ë¡œê·¸ì¸ ì½”ë“œ ë¦¬ë·°ì— app.js ì½”ë“œê°€ ìˆëŠ”ë° ê±°ê¸°ì— authenticatedì— ê´€í•œ ì½”ë“œê°€ ì‘ì„±ë˜ì–´ ìˆì–´ì„œ ì°¸ê³ í•˜ë©´ ëœë‹¤. ì´ ì›¹í˜ì´ì§€ê°€ í•œ ë²ˆ ë Œë”ë§ì´ ë  ë•Œ í† í°ìœ¼ë¡œ authenticatedë¥¼ trueë‚˜ false ìƒíƒœë¡œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë‹¤.

- window.IMP ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì œ ì°½ì„ ì—°ë‹¤. ê°ì²´ê°€ ì—†ì„ ê²½ìš° ê²°ì œ ì‹¤íŒ¨ë¡œ ëŒì•„ê°€ëŠ”ë° ì´ ì„œë¹„ìŠ¤ë¥¼ ë¡œë“œí•˜ê¸° ìœ„í•´ useEffect ì½”ë“œë¥¼ ë§Œë“  ê²ƒì´ë‹¤.

- ì•„ë˜ ì½”ë“œì—ì„œ ê°€ê³µí•œ ê²ƒë“¤ì„ ë„£ì–´ì„œ ìš”ì²­ì„ ë³´ë‚¸ë‹¤.

---

</br></br>

**ìš”ì²­**

```javascript

    const joinFund = useMutation(async (funder) => {
        const option = {
            headers: {
                Authorization: `Bearer ${accessToken}`
            }
        }
        return await axios.post("http://localhost:8080/auth/funding/payment", funder, option);
    }, {
        onSuccess: () => {
            alert("í€ë”©ì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤.");
            setIsOpen(false);
        }
    });

```

</br>

- ê²°ì œí•˜ëŠ” ìœ ì €ì˜ ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ê¸° ìœ„í•´ post ìš”ì²­ì„ ë³´ë‚¸ë‹¤.

---

</br></br>

## BackEnd

**WebMvcConfig**

```java

@Configuration
public class WebMvcConfig implements WebMvcConfigurer{
	
	@Override
	public void addCorsMappings(CorsRegistry registry) {
		registry.addMapping("/**") // 3000í¬íŠ¸ì—ì„œ ë“¤ì–´ì˜¤ëŠ” ëª¨ë“  ìš”ì²­ë“¤ 
				.allowedMethods("*")
				.allowedOrigins("*");
	}

```

</br>

- ì›ë˜ëŠ” Controllerì— @CrossOriginì´ë¼ëŠ” ì–´ë…¸í…Œì´ì…˜ì„ ë‹¬ì•„ì¤˜ì•¼ í•œë‹¤. ë§¤ ë²ˆ ì–´ë…¸í…Œì´ì…˜ì„ ë‹¬ê¸°ì—” ë²ˆê±°ë¡­ê¸°ì— ì´ëŸ° ì„¤ì •ë²•ì´ ìˆë‹¤.

- ì´ ì„¤ì •ì„ í•´ì£¼ëŠ” ì´ìœ ë¥¼ ê°„ëµíˆ ì–˜ê¸°í•˜ìë©´, ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ ìš”ì²­ì„ ì°¨ë‹¨ì„ í•œë‹¤. ê·¸ë˜ì„œ ìš”ì²­ì„ í—ˆìš©í•˜ê¸° ìœ„í•´ Cross-Origin ì„¤ì •ì„ í•„ìˆ˜ë¡œ í•´ì¤˜ì•¼ í•œë‹¤.

---

</br></br>

**SecurityConfig**

```java

public class SecurityConfig extends WebSecurityConfigurerAdapter {
	
	private final JwtTokenProvider jwtTokenProvider;
	private final OAuth2SuccessHandler oAuth2SuccessHandler;
	private final OAuth2Service oAuth2Service;
	private final JwtAuthenticationEntryPoint jwtAuthenticationEntryPoint;
	
	@Bean
	public BCryptPasswordEncoder passwordEncoder() {
		return new BCryptPasswordEncoder();
	}

	// HTTP ë³´ì•ˆ ì„¤ì •ì„ êµ¬ì„±
	@Override
	protected void configure(HttpSecurity http) throws Exception {
		http.cors();	// Cross-Origin Resource Sharing (CORS)ë¥¼ í™œì„±í™”.
		http.csrf().disable();		// CSRF(Cross-Site Request Forgery) ë³´í˜¸ ê¸°ëŠ¥ì„ ë¹„í™œì„±í™”.
		http.httpBasic().disable();	// HTTP ê¸°ë³¸ ì¸ì¦ì„ ë¹„í™œì„±í™”.
		http.formLogin().disable();	// form ê¸°ë°˜ì˜ ë¡œê·¸ì¸ì— ëŒ€í•´ ë¹„í™œì„±í™”.

		// ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•Šê³  ìƒíƒœë¥¼ ìœ ì§€í•˜ì§€ ì•ŠëŠ” ì„¸ì…˜ ê´€ë¦¬ ì •ì±…ì„ ì„¤ì •.
		http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);

		// ìš”ì²­ì— ëŒ€í•œ í—ˆìš© ì„¤ì •
		http.authorizeRequests()
			.antMatchers("/image/**", "/funding/**", "/giving/**", "/main/**", "/page/**")	 // íŠ¹ì • URL íŒ¨í„´ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì„ ì„¤ì •
			.permitAll()		// ìœ„ URL ìš”ì²­ì€ ëª¨ë‘ í—ˆìš©
			.antMatchers("/auth/funding/**", "/auth/giving/**", "/admin/**")
			.authenticated()	// ìœ„ URL ìš”ì²­ì€ ëª¨ë‘ ì¸ì¦ì´ í•„ìš”
			.and()
			.addFilterBefore(new JwtAuthenticationFilter(jwtTokenProvider), UsernamePasswordAuthenticationFilter.class)	// JWT ì¸ì¦ì„ ì²˜ë¦¬í•˜ëŠ” 				í•„í„°
			.exceptionHandling()
			.authenticationEntryPoint(jwtAuthenticationEntryPoint)		//  ì¸ì¦ ì§„ì… ì§€ì  ì„¤ì •

```

</br>

- jwt ì¸ì¦ ê´€ë ¨í•´ì„œ ë¡œê·¸ì¸ì— ì½”ë“œë¥¼ í’€ì–´ë†¨ë‹¤.

- ê°„ëµí•˜ê²Œ ë³´ìë©´, ì„œë²„ì— ìš”ì²­ì„ ë”°ë¼ ë“¤ì–´ì˜¬ ë•Œ ìš”ì²­ ì£¼ì†Œê°€ ì¸ì¦ì´ í•„ìš”í•œì§€ ì•ˆ í•„ìš”í•œì§€ í™•ì¸ì„ í•˜ê³ , ì¸ì¦ì´ í•„ìš”í•œ ë¶€ë¶„ì€ ë¡œê·¸ì¸ ì •ë³´ë¥¼ í†µí•´ ì¸ì¦ì„ í•œë‹¤. ì¸ì¦ì´ í•„ìš” ì—†ëŠ” URLì€ ì¸ì¦ ì ˆì°¨ ì—†ì´ ìš”ì²­ì´ ê·¸ëŒ€ë¡œ ë“¤ì–´ì˜¨ë‹¤. ê·¸ë˜ì„œ ì¸ì¦ ì ˆì°¨ê°€ í•„ìš”ì—†ëŠ” ìš”ì²­ì— ê´€í•œ ê±´ ë¡œê·¸ì¸ì„ í•˜ì§€ ì•Šì€ ì‚¬ëŒë“¤ë„ ëª¨ë‘ ë³¼ ìˆ˜ ìˆëŠ” ê²ƒë“¤ë¡œ ì„¤ì •ì„ í–ˆê³ , ì¸ì¦ì´ í•„ìš”í•œ ë¶€ë¶„ì€ ì•„ë¬´ë‚˜ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ê²°ì œì™€ ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì— ì„¤ì •ì„ í•´ì¤¬ë‹¤.

---

</br></br>

**Controller**

```java

@RestController
@RequestMapping("/auth")
@RequiredArgsConstructor
public class AuthController {
	
	private final AuthService authService;

	@PostMapping("/funding/payment")
	public ResponseEntity<?> toPaymentInfo(@RequestBody FunderReqDto funderReqDto) {
		return ResponseEntity.ok(authService.saveFunder(funderReqDto));
	}
}

```

</br>

- ìš”ì²­ìœ¼ë¡œ ë°›ì€ ë°ì´í„°ë¥¼ ë„˜ê¸°ê³  ì‘ë‹µì„ í•˜ê³  ìˆë‹¤.

---

</br></br>

**Dto**

```java

@Data
public class FunderReqDto {
	private int userId;
	private int addressId;
	private List<Integer> rewardIds;
	private List<Integer> counts;
	
	public List<Funder> toFunderEntity() {
	    List<Funder> funders = new ArrayList<>();
	    for (int i = 0; i < counts.size(); i++) {
	        int rewardId = rewardIds.get(i);
	        int count = counts.get(i);
	        	for (int j = 0; j < count; j++) {
		            Funder funder = Funder.builder()
		                    .userId(userId)
		                    .addressId(addressId)
		                    .rewardId(rewardId)
		                    .build();
		            funders.add(funder);
	        	}
	    	}
	    return funders;
	}
}

```

</br>

- ë¦¬ì›Œë“œì˜ ê°œìˆ˜ê°€ Listë¡œ ë“¤ì–´ì˜¤ê¸° ë•Œë¬¸ì— ê°œìˆ˜ì— ë§ì¶° forë¬¸ì„ ëŒë ¤ì¤€ í›„ í•˜ë‚˜ì”© ê°’ì„ ë„£ì–´ì¤€ í›„, ìƒˆë¡œìš´ Listì— ì¶”ê°€ë¥¼ í•˜ê³  ë°˜í™˜ì„ í•˜ê³  ìˆë‹¤.

---

</br></br>

**Service**

```java

@Service
@RequiredArgsConstructor
public class AuthService {
	
	private final AuthRepository authRepository;
	
	public int saveFunder(FunderReqDto funderReqDto) {
		List<Funder> funderEntity = funderReqDto.toFunderEntity();
		return authRepository.toSaveFunder(funderEntity);
	}
 }

```

</br>

- ì„œë²„ë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ê¸° ìœ„í•´ Repositoryë¡œ ë„˜ê²¨ì£¼ê³  ìˆë‹¤.

---

</br></br>

**Repository**

```java

@Mapper
public interface AuthRepository {
	public int toSaveFunder(List<Funder> funder);
}

```

</br>

- sqlë¬¸ì„ ì‘ì„±í•˜ê¸° ìœ„í•´ Funder ê°ì²´ë¥¼ ë„£ì–´ì¤€ë‹¤.

---

</br></br>

**Sql**

```sql

<insert id="toSaveFunder"
	parameterType="com.webproject.crowdfunding.entity.Funder"
	keyProperty="funderId"
	useGeneratedKeys="true">
	insert into funder_tb
	values
	<foreach collection="list" item="funder" separator=",">
		(0, #{funder.userId}, NOW(), #{funder.addressId}, #{funder.rewardId})
	</foreach>
</insert>

```

</br>

- foreachë¥¼ ëŒë ¤ ë¦¬ìŠ¤íŠ¸ë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ì„œ insertí•œë‹¤.

- ì´ì œ ê²°ì œí•œ ì‚¬ëŒë“¤ì˜ ì •ë³´ê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ë“¤ì–´ê°€ê²Œ ëœë‹¤.

---

</br></br>

**Database**

![Funder](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/d2b3687f-47c0-4f99-8520-141bc0ad6646)

</br>

- ê²°ì œì°½ì—ì„œ ì´ 6ê°œë¥¼ ì„ íƒí–ˆëŠ”ë°, ì—¬ê¸°ì—ë„ 6ê°œê°€ ì˜ ë“¤ì–´ê°„ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.

---

</div>
</details>

<details>
<summary>ì¢…ë£Œëœ í€ë”© ì˜ìƒ</summary>
<div markdown="1">

![ì¢…ë£Œëœ í€ë”©](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/238f395c-98bc-4262-99c6-e3ce59013b34)

</div>
</details>

<details>
<summary>í€ë”© ìƒì„¸ í˜ì´ì§€ ì½”ë“œ ë¦¬ë·°</summary>
<div markdown="1">

</br>

## FrontEnd

**ìš”ì²­**

- ì£¼ìš” ë‚´ìš©

```javascript

    const fundingDetail = useQuery(["fundingDetail"], async () => {
        return await axios.get(`http://localhost:8080/fundingdetail/${pageId}`);
    });

    const fundingDetailReward = useQuery(["fundingDetailReward"], async () => {
        return await axios.get(`http://localhost:8080/fundingdetail/reward/${pageId}`);
    });

    const fundingBusinessInfo = useQuery(["fundingBusinessInfo"], async () => {
        return await axios.get(`http://localhost:8080/fundingdetail/businessinfo/${pageId}`);
    })

    const fundingJoinBreakdown = useQuery(["fundingJoinBreakDown"], async () => {
        return await axios.get(`http://localhost:8080/fundingdetail/breakdown/${pageId}`);
    })

```

</br>

- ë¡œê·¸ì¸í•œ ìœ ì €ì— ëŒ€í•œ ì •ë³´ í™•ì¸

```javascript

    const principalUser = useQuery(["principalUser"], async () => {
        const option = {
            headers: {
                Authorization: `Bearer ${accessToken}`
            }
        }
        const response = await axios.get("http://localhost:8080/principal", option)
        setRole(response.data.authorities.split(",").includes("ROLE_ADMIN"));
        return response;
    },{
        enabled: !!accessToken
    })

    const getAddress = useQuery(["getAddress"], async () => {
        const option = {
            params: {
                userId: principalUser.data.data.userId
            },
            headers: {
                Authorization: `Bearer ${accessToken}`
            }
        }
        return await axios.get("http://localhost:8080/fundingdetail/address", option);
    }, {
        enabled: !!principalUser.data
    })

```

</br>

- í˜„ì¬ ê²½ë¡œì˜ URL ë§¤ê°œë³€ìˆ˜ë¥¼ ë“¤ê³ ì˜¤ê¸° ìœ„í•´ ë³€ìˆ˜ëª…ì„ pageIdë¡œ í•œ useParamsë¥¼ ë°›ì•„ì¤¬ë‹¤.

- ë‚˜ë¨¸ì§€ëŠ” ë°±ì—ì„œ ê°€ê³µëœ ë°ì´í„°ë¥¼ ë“¤ê³ ì˜¬ ê²ƒì´ë‹¤.

- ìœ ì €ì— ëŒ€í•œ ì •ë³´ë¥¼ ë“¤ê³ ì˜¨ ì´ìœ ëŠ” ê²°ì œí•  ë•Œ ìœ ì €ì˜ ì •ë³´ê°€ í•„ìš”í•´ì„œ ë“¤ê³ ì™”ë‹¤.

---

</br></br>

**í€ë”© ìƒì„¸ í˜ì´ì§€ html ì½”ë“œ**

```html

        <div>
            <div css={fundingDetailContainer}>
                <div css={fundingDetailHeader}>
                    <img css={fundingDetailImg} src={`http://localhost:8080/image/main/${funding.mainImgUrl}`} />
                    <div css={fundingDetailHeaderRight}>
                        <div css={fundingDetailNearDeadline}>{funding.deadline === "ì¢…ë£Œ" ? "ì¢…ë£Œ" : funding.deadline === "ì˜¤ëŠ˜ ë§ˆê°" ?  "ì˜¤ëŠ˜ ë§ˆê°" : `D-${funding.deadline}`}</div>
                        <div css={fundingDetailFundingTitle}>{funding.fundingTitle}</div>
                        <div css={fundingDetailJoinPercent}>{funding.joinPercent}%</div>
                        <progress css={fundingDetailJoinPercentProgress} value={funding.joinPercent} max="100"/>
                        <div css={fundingDetailTotal}>
                            <div css={fundingDetailGoalTotal}>{new Intl.NumberFormat('en-US').format(funding.goalTotal)}ì› ëª©í‘œ</div>
                            <div css={fundingDetailTotalRewardPrice}>{new Intl.NumberFormat('en-US').format(funding.totalRewardPrice)}ì›</div>
                        </div>
                        <div css={funderName}>{funding.fundingSummaryName}</div>
                        <div css={fundingDetailRewardContainer}>
                            <div css={SelectFundingDetail}>
                                <button css={SelectRewardButton} onClick={selectRewardHandle}>
                                    <div css={SelectRewardTxt}>ë¦¬ì›Œë“œ ì„ íƒí•˜ê¸°</div>
                                    <div css={SelectRewardArrow}>{selectRewardHidden ? "â–³" : "â–½"}</div>
                                </button>
                                {selectRewardHidden ? (<ul css={SelectRewardList}>
                                    {fundingDetailReward.data.data.rewardList.map(fundingReward => (
                                        <li css={SelectRewardName} 
                                            onClick={() => selectRewardNameHandle(fundingReward)}>{fundingReward.rewardName}</li>
                                        ))}
                                        </ul>) : ""}
                                    {rewards.map(reward =>(
                                            <div css={rewardsMain} key={reward.fundingReward.rewardId}>
                                                <div css={rewardNameAndDelete}>
                                                    <div css={rewardsName}>{reward.fundingReward.rewardName}</div>
                                                    <button css={rewardsDeleteButton} onClick={() => deleteRewardHandle(reward)}>X</button>
                                                </div>
                                                <div css={rewardCountAndPriceContainer}>
                                                    <div css={rewardButtonAndPrice}>
                                                        <button css={minusButton}
                                                                onClick={() => decreaseCount(reward)}>-</button>
                                                        <input  css={rewardCount}
                                                                type="number"
                                                                value={reward.fundingReward.count || 1}
                                                                onChange={(e) => countHandle(e, reward)} />
                                                        <button css={plusButton}
                                                                onClick={() => increaseCount(reward)}>+</button>
                                                    </div>
                                                    <div css={rewardsPrice}>{new Intl.NumberFormat('en-US').format(reward.fundingReward.rewardPrice)}ì›</div>
                                                </div>
                                            </div>
                                    ))}
                                <div css={TotalReward}>
                                    <div css={TotalRewardCount}>ì´ ìˆ˜ëŸ‰ {totalQuantity}ê°œ</div>
                                        <div css={TotalRewardPriceContainer}>
                                            <div css={TotalRewardPriceTxt}>ì´ ê¸ˆì•¡</div>
                                            <div css={TotalRewardPrice}>{new Intl.NumberFormat('en-US').format(totalPrice)}ì›</div>
                                        </div>
                                </div>
                            </div>
                        </div>
                        <div css={joinFundingButtonContainer}>
                            {funding.deadline === "ì¢…ë£Œ" ?
                            <button css={endFundingButton}>í€ë”© ì¢…ë£Œí•˜ê¸°</button> :
                            <button css={joinFundingButton} onClick={joinFunding}>í€ë”© ì°¸ì—¬í•˜ê¸°</button>}
                            {isOpen ?
                                <div css={joinFundContainer}>
                                    <div css={joinFundIdentifyContainer}>
                                        <div css={joinFundIdentifyMain}>
                                            <div css={joinFundHeader}>
                                                <div css={joinFundTitle}>{funding.fundingTitle}</div>
                                                <div css={joinFundNickname}>By UniSecond</div>
                                            </div>
                                            <div css={joinFundBorderBottom}>
                                            {rewards.map(reward => (
                                                <div css={joinFundRewardContainer} key={reward.fundingReward.rewardId}>
                                                    <div css={joinFundRewardName}>{reward.fundingReward.rewardName}</div>
                                                    <div css={joinFundCountAndPrice}>
                                                        <div css={joinFundCount}>ìˆ˜ëŸ‰: {reward.fundingReward.count}ê°œ</div>
                                                        <div css={joinFundPrice}>ê°€ê²©: {new Intl.NumberFormat('en-US').format(reward.fundingReward.rewardPrice)}ì›</div>
                                                    </div>
                                                </div>
                                            ))}
                                            </div>
                                            <div css={paymentTxtContainer}>
                                                <div css={paymentTxt}>ê²°ì œë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
                                            </div>
                                            <div css={joinTotalRewardPriceContainer}>
                                                <div css={joinTotalRewardPriceTxt}> ì´ ê¸ˆì•¡:</div>
                                                <div css={joinTotalRewardPrice}>{new Intl.NumberFormat('en-US').format(totalPrice)}ì›</div>
                                            </div>
                                            <div css={joinIdentifyButtonContainer}>
                                                <button css={joinIdentifyButton} onClick={joinSubmitHandle}>ê²°ì œí•˜ê¸°</button>
                                                <button css={joinCancelButton} onClick={joinCancelButtonHandle}>ì·¨ì†Œ</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            : ""}
                        </div>
                    </div>
                </div>
            </div>
            <div css={storyHeadLine}>
                <div css={storyHeadLineContainer}>
                    <div css={storyTxt}>ìŠ¤í† ë¦¬</div>
                </div>
            </div>
            <div css={fundingStoryContainer}>
                <div css={fundingStory}>
                    <div css={fundingStoryTitle}>{funding.storyTitle}</div>
                    <div css={fundingStoryContent}>{funding.storyContent}</div>
                    <img css={fundingStoryImg} src={`http://localhost:8080/image/sub/${funding.subImgUrl}`} />
                </div>
                <div css={rewardGuide}>
                    <div css={txtGuide}>ë¦¬ì›Œë“œ ì•ˆë‚´</div>
                    {fundingDetailReward.data.data.rewardList.map(reward => (
                        <div css={rewardGuideList} key={reward.rewardId}>
                            <div css={rewardGuidePriceAndJoin}>
                                <div css={rewardGuidePrice}>{new Intl.NumberFormat('en-US').format(reward.rewardPrice)}ì›</div>
                                <div css={rewardGuideJoin}>í€ë”© ì°¸ì—¬</div>
                            </div>
                            <div css={rewardGuideInfo}>
                                <div css={rewardGuideRewardName}>{reward.rewardName}</div>
                                <div css={rewardGuideDetailContainer}>
                                    <li css={rewardGuideDetailInfo}>í˜„ì¬ {reward.userCount}ëª… ì°¸ì—¬</li>
                                    <li css={rewardGuideDetailInfo}>ë°œì†¡ ì˜ˆìƒì¼ {reward.endDate}</li>
                                </div>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
            <div css={joinUserContainer}>
                <div css={joinUserMain}>
                    <div css={joinUserContent}>
                        <div css={joinBreakdownTxt}>ì°¸ì—¬ë‚´ì—­</div>
                        <div css={joinBreakdownCount}>
                            <div css={joinBreakdownTotalCount}>ì´ {fundingJoinBreakdown.data.data.breakdownList.length}ëª…</div>
                            <div css={joinBreakdownJoinTxt}>ì´ ì°¸ì—¬í•˜ì˜€ìŠµë‹ˆë‹¤.</div>
                        </div>
                        {fundingJoinBreakdown.data.data.breakdownList.map(breakdown => (
                            <div>
                                <div css={joinBreakdownUserContainer}>
                                    <div css={joinBreakdownUser}>{breakdown.username}ë‹˜</div>
                                    <div css={joinBreakdownUserPrice}>{new Intl.NumberFormat('en-US').format(breakdown.totalRewardPrice)}</div>
                                    <div css={joinBreakdownPriceTxt}>ì› ì°¸ì—¬</div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            </div>
            <div css={businessInfoContainer}>
                <div css={businessInfoMain} key={businessInfo.fundingId}>
                    <div css={businessInfoPadding}>
                        <div css={businessInfoTxt}>ì‚¬ì—…ì ì •ë³´</div>
                        <div css={businessInfoContent}>
                            <div css={businessInfoDetailContent}>ìƒí˜¸ëª…: {businessInfo.companyName}</div>
                            <div css={businessInfoDetailContent}>ëŒ€í‘œì: {businessInfo.ceoName}</div>
                            <div css={businessInfoDetailContent}>ì‚¬ì—…ì ì†Œì¬ì§€: {businessInfo.companyAddress}</div>
                            <div css={businessInfoDetailContent}>ê³ ê°ì„¼í„°: {businessInfo.companyPhoneNumber}</div>
                            <div css={businessInfoDetailContent}>ì´ë©”ì¼: {businessInfo.ceoEmail}</div>
                        </div>
                    </div>
                </div>
            </div>
            <div css={fundingDetailFooter}>
                <Footer />
            </div>
        </div>

```

- ì—¬ê¸°ì„œ ë”°ë¡œ ì²˜ë¦¬í•´ì¤€ ê±°ë¼ê³¤ ë‚ ì§œ ê´€ë ¨í•´ì„œ ë””ë°ì´ ì„¤ì •ê³¼ ì¢…ë£Œê°€ ë˜ë©´ í€ë”© ì°¸ì—¬í•˜ê¸° ë²„íŠ¼ì„ ì¢…ë£Œë¡œ ë°”ê¾¼ ê²ƒì´ê³ , ë‚˜ë¨¸ì§€ëŠ” ì„œë²„ì—ì„œ ë“¤ê³ ì˜¨ ë°ì´í„°ë¥¼ ë„£ì–´ì¤€ ê²ƒ.

---

</br></br>

**ì‘ë‹µ ë°›ì€ ë°ì´í„° ê°€ê³µ**

```javascript

    const [ selectRewardHidden, setSelectRewardHidden ] = useState(false);
    const [ rewards, setRewards ] = useState([]);
    const [ totalQuantity, setTotalQuantity ] = useState(0);
    const [ totalPrice, setTotalPrice ] = useState(0);

    const selectRewardNameHandle = (fundingReward) => {
        const isDuplicate = rewards.some(reward => reward.fundingReward.rewardId === fundingReward.rewardId);
        if (isDuplicate) {
          alert("ì´ë¯¸ ë“±ë¡ëœ ìƒí’ˆì…ë‹ˆë‹¤.");
          setSelectRewardHidden(false);
        } else {
          setSelectRewardHidden(false);
          setRewards([...rewards, { fundingReward: { ...fundingReward, count: 1 } }]);
          setTotalQuantity(quantity => quantity + 1);
          setTotalPrice(price => price + fundingReward.rewardPrice)
        }
    }

    const deleteRewardHandle = (reward) => {
        const deletedRewardCount = reward.fundingReward.count || 1;
        const deletedRewardPrice = reward.fundingReward.rewardPrice;
        console.log(deletedRewardPrice);
        const newRewards = rewards.filter(r => r.fundingReward.rewardId !== reward.fundingReward.rewardId);
        setRewards(newRewards);
      
        setTotalQuantity(quantity => quantity - deletedRewardCount);
        setTotalPrice(price => price - deletedRewardPrice);

        reward.fundingReward.count = 1;
      }
    
    const decreaseCount = (reward) => {
        const newRewards = [...rewards];
        const rewardIndex = newRewards.findIndex(r => r.fundingReward.rewardId === reward.fundingReward.rewardId);
        
        if (rewardIndex !== -1) {
          const count = newRewards[rewardIndex].fundingReward.count || 1;
          if (count > 1) {
            const rewardPrice = reward.fundingReward.rewardPrice;
            const priceDecrease = rewardPrice / count;
            newRewards[rewardIndex].fundingReward.count = count - 1;
            newRewards[rewardIndex].fundingReward.rewardPrice -= priceDecrease;
            setTotalQuantity(quantity => quantity - 1);
            setTotalPrice(price => price - priceDecrease);
          }
        }
        
        setRewards(newRewards);
      }


    const countHandle = (e, reward) => {
        const newRewards = [...rewards];
        const rewardIndex = newRewards.findIndex(r => r.fundingReward.rewardId === reward.fundingReward.rewardId);

        if (rewardIndex !== -1) {
            const count = parseInt(e.target.value, 10);
            const prevCount = newRewards[rewardIndex].fundingReward.count || 1;

            if (!isNaN(count) && count >= 1) {
            const diffCount = count - prevCount;
            newRewards[rewardIndex].fundingReward.count = count;

            if (diffCount !== 0) {
                const prevPrice = newRewards[rewardIndex].fundingReward.rewardPrice;
                const newPrice = prevPrice * (count / prevCount);
                newRewards[rewardIndex].fundingReward.rewardPrice = newPrice;
            }

            setRewards(newRewards);

            const updatedTotalQuantity = newRewards.reduce((total, r) => total + (r.fundingReward.count || 1), 0);
            const updatedTotalPrice = newRewards.reduce((total, r) => total + (r.fundingReward.rewardPrice), 0);
            console.log(updatedTotalPrice);
            setTotalQuantity(updatedTotalQuantity);
            setTotalPrice(updatedTotalPrice);
            }
        }
    };

    const increaseCount = (reward) => {
        const newRewards = [...rewards];
        const rewardIndex = newRewards.findIndex(r => r.fundingReward.rewardId === reward.fundingReward.rewardId);
        if (rewardIndex !== -1) {
          newRewards[rewardIndex].fundingReward.count = (newRewards[rewardIndex].fundingReward.count || 1) + 1;
          const count = newRewards[rewardIndex].fundingReward.count;
          if (count >= 1) {
            const rewardPrice = reward.fundingReward.rewardPrice;
            const priceIncrease = rewardPrice / (newRewards[rewardIndex].fundingReward.count - 1);
            newRewards[rewardIndex].fundingReward.rewardPrice += priceIncrease;
            setTotalQuantity(quantity => quantity + 1);
            setTotalPrice(price => price + priceIncrease);
        }
    }
        setRewards(newRewards);
    };

```

- selectRewardNameHandle
	- ë§¤ê°œ ë³€ìˆ˜ë¡œ ë°›ì€ fundingRewardì—ëŠ” í•´ë‹¹ í€ë”©ì˜ ë¦¬ì›Œë“œë“¤ì´ ë“¤ì–´ê°€ìˆë‹¤.

  	- rewardsëŠ” ì„œë²„ì—ì„œ ë“¤ê³ ì˜¨ ë¦¬ì›Œë“œë“¤ì„ ë‹´ê¸° ìœ„í•´ ìƒˆë¡œìš´ ë°°ì—´ ìƒíƒœë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ì£¼ì—ˆë‹¤. fundingRewardë¡œ í•´ê²°í•˜ë ¤ë‹ˆ ì˜¤ë¥˜ê°€ ë§ì•„ ê³ ë¯¼ ëì— ìƒˆë¡œìš´ ë°°ì—´ ìƒíƒœë¥¼ 	ë§Œë“œëŠ” ê±¸ë¡œ ê²°ì •í–ˆë‹¤.

  	- ê·¸ë˜ì„œ ì´ ë‘˜ì„ ë¹„êµí•˜ì—¬ ìƒˆë¡œìš´ ë°°ì—´ì— ë‹´ê²¨ìˆëŠ” ê±¸ ë˜ ë‹´ìœ¼ë ¤ê³  í•  ê²½ìš°ì— ì´ë¯¸ ë“±ë¡ëœ ìƒí’ˆì´ë¼ê³  ì²˜ë¦¬ë¥¼ í•˜ê³ , ì¤‘ë³µì´ ë˜ì§€ ì•Šë‹¤ë©´ ê·¸ê±¸ rewardsì— ìƒˆë¡œ ë‹´ê³  		ê¸°ë³¸ ìˆ˜ëŸ‰ì„ 1ë¡œ ì„¤ì •.
   
 	- ë‚˜ë¨¸ì§€ëŠ” ì´ ìˆ˜ëŸ‰ì„ ë‹¤ ë”í•´ì¤Œìœ¼ë¡œì¨ í‘œì‹œë¥¼ í•´ì¤„ ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë¦¬ì›Œë“œê°€ ì´ 3ê°œì¼ ê²½ìš°ì— ê¸°ë³¸ ìˆ˜ëŸ‰ í•˜ë‚˜ì”© ë‹¤ ë”í•´ì¤˜ì„œ ì´ ìˆ˜ëŸ‰ì´ 1ì´ ëœë‹¤. ì´ ê¸ˆì•¡ë„ ë§ˆ		ì°¬ê°€ì§€.

- deleteRewardHandle
	- ì§€ê¸ˆë¶€í„°ëŠ” ìœ„ì—ì„œ ìƒˆë¡œìš´ ë°°ì—´ì— ë¦¬ì›Œë“œë“¤ì„ ë‹´ì•˜ê¸° ë•Œë¬¸ì— ê·¸ê²ƒë“¤ì„ ê°€ê³µí•  ê²ƒì´ë‹¤.
   
	- deletedRewardCount ë³€ìˆ˜ëŠ” ì‚­ì œëœ ë¦¬ì›Œë“œì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. reward.fundingReward.count ê°’ì´ ì¡´ì¬í•˜ë©´ í•´ë‹¹ ê°’ì„ ì‚¬ìš©í•˜ê³ , ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ì¸ 1ì„ ì‚¬ìš©		í•œë‹¤.
   
	- deletedRewardPrice ë³€ìˆ˜ ì—­ì‹œ ì‚­ì œëœ ë¦¬ì›Œë“œì˜ ê°€ê²©ì„ ë‚˜íƒ€ë‚¸ë‹¤.
   
 	- newRewards ë³€ìˆ˜ëŠ” rewards ë°°ì—´ì—ì„œ ì‚­ì œëœ ë¦¬ì›Œë“œë¥¼ ì œì™¸í•œ ìƒˆë¡œìš´ ë°°ì—´ì„ ìƒì„±í•œë‹¤. filter í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ reward.fundingReward.rewardIdì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” 		ë¦¬ì›Œë“œë§Œì„ ë‚¨ê²¨ë‘”ë‹¤.
    
	- setRewards(newRewards)ë¥¼ í˜¸ì¶œí•˜ì—¬ rewards ìƒíƒœ ê°’ì„ ìƒˆë¡œìš´ ë°°ì—´ë¡œ ì—…ë°ì´íŠ¸í•œë‹¤. ì´ë¥¼ í†µí•´ ì‚­ì œëœ ë¦¬ì›Œë“œê°€ ì œì™¸ëœ ìƒˆë¡œìš´ ë¦¬ì›Œë“œ ëª©ë¡ì„ ë°˜ì˜í•˜ê²Œ ëœë‹¤. 
 
- decreaseCount
	- newRewards ë³€ìˆ˜ëŠ” rewards ë°°ì—´ì„ ì–•ì€ ë³µì‚¬í•˜ì—¬ ìƒˆë¡œìš´ ë°°ì—´ì„ ìƒì„±í•œë‹¤. ì´ë¥¼ í†µí•´ ê¸°ì¡´ ë°°ì—´ì„ ì§ì ‘ ìˆ˜ì •í•˜ì§€ ì•Šê³  ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë‹¤.

  	- rewardIndex ë³€ìˆ˜ëŠ” newRewards ë°°ì—´ì—ì„œ reward.fundingReward.rewardIdì™€ ì¼ì¹˜í•˜ëŠ” ë³´ìƒì˜ indexë¥¼ ì°¾ëŠ”ë‹¤. findIndex ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ì›Œë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ëŠ” 	ê²½ìš° -1ì„ ë°˜í™˜í•œë‹¤.

	- rewardIndexê°€ -1ì´ ì•„ë‹Œ ê²½ìš°, ì¦‰ ë¦¬ì›Œë“œë¥¼ ì°¾ì€ ê²½ìš°ì—ë§Œ ì•„ë˜ì˜ ì½”ë“œ ì‹¤í–‰í•œë‹¤.

	- count ë³€ìˆ˜ëŠ” ë¦¬ì›Œë“œì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ë§Œì•½ newRewards[rewardIndex].fundingReward.count ê°’ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ì¸ 1ì„ ì‚¬ìš©í•œë‹¤.

	- countê°€ 1ë³´ë‹¤ í° ê²½ìš°, ì¦‰ ê°œìˆ˜ë¥¼ ê°ì†Œì‹œí‚¬ ìˆ˜ ìˆëŠ” ê²½ìš°ì—ë§Œ ì•„ë˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤.

	- rewardPrice ë³€ìˆ˜ëŠ” ë¦¬ì›Œë“œì˜ ê°€ê²©ì„ ë‚˜íƒ€ë‚¸ë‹¤. reward.fundingReward.rewardPrice ê°’ì„ ì‚¬ìš©í•œë‹¤.

	- priceDecrease ë³€ìˆ˜ëŠ” ê° ê°œìˆ˜ ê°ì†Œì— ë”°ë¼ ê°ì†Œë˜ì–´ì•¼ í•  ê°€ê²©ì„ ê³„ì‚°í•œë‹¤. ì¦‰, ë³´ìƒì˜ ê°€ê²©ì„ í˜„ì¬ ê°œìˆ˜ë¡œ ë‚˜ëˆˆ ê°’ì´ë‹¤.

	- newRewards[rewardIndex].fundingReward.count ê°’ì„ 1 ê°ì†Œì‹œí‚¨ë‹¤.

	- newRewards[rewardIndex].fundingReward.rewardPriceì—ì„œ priceDecreaseë¥¼ ëº€ ê°’ì„ í• ë‹¹í•˜ì—¬ ë¦¬ì›Œë“œì˜ ê°€ê²©ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

	- setTotalQuantity(quantity => quantity - 1)ë¥¼ í˜¸ì¶œí•˜ì—¬ totalQuantity ìƒíƒœ ê°’ì„ 1 ê°ì†Œì‹œí‚¨ë‹¤.

	- setTotalPrice(price => price - priceDecrease)ë¥¼ í˜¸ì¶œí•˜ì—¬ totalPrice ìƒíƒœ ê°’ì„ priceDecreaseë§Œí¼ ê°ì†Œì‹œí‚¨ë‹¤.

	- setRewards(newRewards)ë¥¼ í˜¸ì¶œí•˜ì—¬ rewards ìƒíƒœ ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

	- ì´ë¥¼ í†µí•´ decreaseCount í•¨ìˆ˜ëŠ” ë¦¬ì›Œë“œì˜ ê°œìˆ˜ë¥¼ 1 ê°ì†Œì‹œí‚¤ê³ , ê°œìˆ˜ì— ë”°ë¼ ê°€ê²©ì„ ì¡°ì •í•˜ì—¬ rewards, totalQuantity, totalPrice ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

- countHandle
	- count ë³€ìˆ˜ëŠ” ì •ìˆ˜ë¡œ ë³€í™˜í•˜ì—¬ í• ë‹¹í•œë‹¤.

	- prevCount ë³€ìˆ˜ëŠ” ì´ì „ì— ì €ì¥ëœ ë¦¬ì›Œë“œì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.

	- diffCount ë³€ìˆ˜ëŠ” ë³€ê²½ëœ ê°œìˆ˜ì™€ ì´ì „ ê°œìˆ˜ì˜ ì°¨ì´ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.

	- newRewards[rewardIndex].fundingReward.count ê°’ì„ ë³€ê²½ëœ ê°œìˆ˜ë¡œ ì—…ë°ì´íŠ¸í•œë‹¤.

	- newPrice ë³€ìˆ˜ëŠ” ì´ì „ ê°€ê²©ì— ë³€ê²½ëœ ê°œìˆ˜ì˜ ë¹„ìœ¨ì„ ê³±í•œ ê°’ì„ ë‚˜íƒ€ë‚¸ë‹¤.

	- newRewards[rewardIndex].fundingReward.rewardPrice ê°’ì„ newPriceë¡œ ì—…ë°ì´íŠ¸í•˜ì—¬ ë³´ìƒì˜ ê°€ê²©ì„ ì¡°ì •í•œë‹¤.

	- setRewards(newRewards)ë¥¼ í˜¸ì¶œí•˜ì—¬ rewards ìƒíƒœ ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

	- newRewards ë°°ì—´ì´ ëŒë©´ì„œ ë³´ìƒì˜ ê°œìˆ˜ë¥¼ í•©ì‚°í•˜ì—¬ updatedTotalQuantityë¥¼ ê³„ì‚°í•œë‹¤.

	- newRewards ë°°ì—´ì´ ëŒë©´ì„œ ë³´ìƒì˜ ê°€ê²©ì„ í•©ì‚°í•˜ì—¬ updatedTotalPriceë¥¼ ê³„ì‚°í•œë‹¤.

	- setTotalQuantity(updatedTotalQuantity)ë¥¼ í˜¸ì¶œí•˜ì—¬ totalQuantity ìƒíƒœ ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

	- setTotalPrice(updatedTotalPrice)ë¥¼ í˜¸ì¶œí•˜ì—¬ totalPrice ìƒíƒœ ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

	- ì´ë¥¼ í†µí•´ countHandle í•¨ìˆ˜ëŠ” ë¦¬ì›Œë“œì˜ ê°œìˆ˜ë¥¼ ì²˜ë¦¬í•˜ê³ , ê°œìˆ˜ì™€ ê°€ê²©ì˜ ë³€í™”ì— ë”°ë¼ rewards, totalQuantity, totalPrice ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

- increaseCount
	- newRewards[rewardIndex].fundingReward.count ê°’ì„ 1 ì¦ê°€ì‹œí‚¨ë‹¤.

	- rewardPrice ë³€ìˆ˜ëŠ” ë¦¬ì›Œë“œì˜ ê°€ê²©ì„ ë‚˜íƒ€ë‚¸ë‹¤.

	- priceIncrease ë³€ìˆ˜ëŠ” ê° ê°œìˆ˜ ì¦ê°€ì— ë”°ë¼ ì¦ê°€ë˜ì–´ì•¼ í•  ê°€ê²©ì„ ê³„ì‚°í•œë‹¤. ì¦‰, ë¦¬ì›Œë“œì˜ ê°€ê²©ì„ ê°œìˆ˜ì—ì„œ 1ì„ ëº€ ê°’ìœ¼ë¡œ ë‚˜ëˆˆ ê²ƒì´ë‹¤.

	- newRewards[rewardIndex].fundingReward.rewardPriceì— priceIncreaseë¥¼ ë”í•˜ì—¬ ë¦¬ì›Œë“œì˜ ê°€ê²©ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

	- setTotalQuantity(quantity => quantity + 1)ë¥¼ í˜¸ì¶œí•˜ì—¬ totalQuantity ìƒíƒœ ê°’ì„ 1 ì¦ê°€ì‹œí‚¨ë‹¤.

	- setTotalPrice(price => price + priceIncrease)ë¥¼ í˜¸ì¶œí•˜ì—¬ totalPrice ìƒíƒœ ê°’ì„ priceIncreaseë§Œí¼ ì¦ê°€ì‹œí‚¨ë‹¤.

	- setRewards(newRewards)ë¥¼ í˜¸ì¶œí•˜ì—¬ rewards ìƒíƒœ ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

	- ì´ë¥¼ í†µí•´ increaseCount í•¨ìˆ˜ëŠ” ë³´ìƒì˜ ê°œìˆ˜ë¥¼ 1 ì¦ê°€ì‹œí‚¤ê³ , ê°œìˆ˜ì— ë”°ë¼ ê°€ê²©ì„ ì¡°ì •í•˜ì—¬ rewards, totalQuantity, totalPrice ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤.

---

</br></br>

## BackEnd

**Controller**

- í€ë”© ìƒì„¸ í˜ì´ì§€ì— í•„ìš”í•œ ê²ƒë“¤

```java

@RestController
@RequiredArgsConstructor
@RequestMapping("/fundingdetail")
public class FundingDetailController {
	
	private final FundingDetailService fundingDetailService;

	@GetMapping("/{pageId}")
	public ResponseEntity<?> fundingDetail(@PathVariable int pageId) {
		
		return ResponseEntity.ok(fundingDetailService.fundingDetail(pageId));
	}
	
	@GetMapping("/reward/{pageId}")
	public ResponseEntity<?> fundingReward(@PathVariable int pageId) {
		
		return ResponseEntity.ok(fundingDetailService.getReward(pageId));
	}
	
	@GetMapping("/businessinfo/{pageId}")
	public ResponseEntity<?> fundingBusinessInfo(@PathVariable int pageId) {
		
		return ResponseEntity.ok(fundingDetailService.getBusinessInfo(pageId));
	}
	
	@GetMapping("/breakdown/{pageId}")
	public ResponseEntity<?> breakdown(@PathVariable int pageId) {
		
		return ResponseEntity.ok(fundingDetailService.getBreakdown(pageId));
	}
	
	@GetMapping("/address")
	public ResponseEntity<?> getAddress(@RequestParam int userId) {
		return ResponseEntity.ok(fundingDetailService.getAddressId(userId));
	}
	
}

```

</br>

```java

@RestController
@RequiredArgsConstructor
public class AccountController {

	private final AccountService accountService;
	
	@GetMapping("/principal")
	public ResponseEntity<?> principal() {
		return ResponseEntity.ok().body(accountService.getPrincipal());
	}
	
}

```

</br>

- í€ë”© ìƒì„¸í˜ì´ì§€ì— í•„ìš”í•œ ë°ì´í„°ì¸ ê¸°ë³¸ ì •ë³´ë“¤ì„ ë“¤ê³ ì˜¤ë ¤ê³  í•œë‹¤.

- ê²°ì œë¥¼ ìœ„í•´ ìœ ì €ì— ëŒ€í•œ ì •ë³´ë¥¼ ë“¤ê³ ì˜¤ë ¤ê³  í•œë‹¤.

---

</br></br>

**Service**

- í€ë”© ìƒì„¸ í˜ì´ì§€ì— ì“¸ ì •ë³´

```java

@Service
@RequiredArgsConstructor
public class FundingDetailService {

	private final FundingDetailRepository fundingDetailRepository;
	
	public FundingDetailRespDto fundingDetail(int pageId) {
		return fundingDetailRepository.fundingDetail(pageId).getDetailFunding();
	}
	
	public Map<String, Object> getReward(int pageId) {
		List<RewardRespDto> rewardList = new ArrayList<>();
		
		fundingDetailRepository.getReward(pageId).forEach(reward -> {
			rewardList.add(reward.getFundingReward());
		});
		
		Map<String, Object> rewardMap = new HashMap<>();
		rewardMap.put("rewardList", rewardList);
		
		return rewardMap;
	}
	
	public BusinessInfoRespDto getBusinessInfo(int pageId) {
		return fundingDetailRepository.getBusinessInfo(pageId).toBusinessInfo();
	}
	
	public Map<String, Object> getBreakdown(int pageId) {
		List<BreakdownRespDto> breakdownList = new ArrayList<>();
		fundingDetailRepository.getBreakdown(pageId).forEach(breakdown -> {
			breakdownList.add(breakdown.toBreakdown());
		});
		
		Map<String, Object> breakdownMap = new HashMap<>();
		breakdownMap.put("breakdownList", breakdownList);
		
		return breakdownMap;
	}
	
	public Address getAddressId(int userId) {
		return fundingDetailRepository.getAddressId(userId);
	}
	
}

```

</br>

- ë¡œê·¸ì¸í•œ ìœ ì €ê°€ ë§ëŠ”ì§€ í™•ì¸

```java

@Service
@RequiredArgsConstructor
public class AccountService {

	private final UserRepository signUpRepository;

	public PrincipalRespDto getPrincipal() {
		PrincipalUserDetails principalUserDetails = (PrincipalUserDetails) SecurityContextHolder.getContext().getAuthentication().getPrincipal();
		User userEntity = signUpRepository.findUserByEmail(principalUserDetails.getEmail());
		StringBuilder roles = new StringBuilder();
		principalUserDetails.getAuthorities().forEach(authority -> {
			roles.append(authority.getAuthority() + ",");
		});
		roles.delete(roles.length() - 1, roles.length());
		
		return PrincipalRespDto.builder()
				.userId(userEntity.getUserId())
				.email(userEntity.getEmail())
				.name(userEntity.getName())
				.authorities(roles.toString())
				.phoneNumber(userEntity.getPhoneNumber())
				.build();
	}
	
}

```

</br>

- FundingDetailServiceì—ì„œëŠ” ì—¬íƒœ ì¨ì™”ë˜ ë°©ì‹ëŒ€ë¡œ Mapì—ë‹¤ê°€ ë°ì´í„°ë¥¼ ë°›ì•„ì„œ ë°˜í™˜ì„ í•œë‹¤.

- ìš”ì²­ ë°›ì€ tokenì— ëŒ€í•œ ì¸ì¦ì„ í•˜ê¸° ìœ„í•´ ê°’ì„ ë„˜ê²¨ì¤€ë‹¤.

- ìœ ì € ì •ë³´ì— ëŒ€í•œ í™•ì¸ì„ ìœ„í•œ ê²€ì‚¬ ê³¼ì •

- dbì— ìˆëŠ” emailê³¼ ìš”ì²­ìœ¼ë¡œ ë°›ì€ tokenì„ ì—´ì–´ì„œ ê·¸ emailì´ ì¼ì¹˜í•œì§€ ì•Œì•„ë³¸ë‹¤.

---

</br></br>

**Dto**

- í€ë”© ìƒì„¸ í˜ì´ì§€ ìƒë‹¨ì— ë“¤ì–´ê°€ëŠ” ê¸°ë³¸ ì •ë³´

```java

@Builder
@Data
public class FundingDetailRespDto {
	private int fundingId;
	private String fundingSummaryName;
	private String fundingTitle;
	private String deadline;
	private int goalTotal;
	private int totalRewardPrice;
	private String storyTitle;
	private String storyContent;
	private String mainImgUrl;
	private String subImgUrl;
	private int joinPercent;
}

```

</br>

- ë¦¬ì›Œë“œ ê´€ë ¨ëœ ì •ë³´

```java

@Data
@Builder
public class RewardRespDto {
	private int rewardId;
	private String rewardName;
	private int rewardPrice;
	private int fundingId;
	private LocalDate endDate;
	private String userCount;
}

```

</br>

- ì‚¬ì—…ì ì •ë³´

```java

@Builder
@Data
public class BusinessInfoRespDto {
	private int businessInfoId;
	private String companyName;
	private String ceoName;
	private String companyAddress;
	private String companyPhoneNumber;
	private String ceoEmail;
	private int fundingId;
}

```

</br>

- ì°¸ì—¬ë‚´ì—­

```java

@Data
@Builder
public class BreakdownRespDto {
	private int fundingId;
	private int userId;
	private String username;
	private int totalRewardPrice;
}

```

</br>

- ê°ê¸° í•„ìš”í•œ ì •ë³´ë¥¼ ë°˜í™˜í•  ê°ì²´ë“¤ì´ë‹¤. 

---

</br></br>

**Entity**

- í€ë”© ìƒì„¸ í˜ì´ì§€ ìƒë‹¨ì— ë“¤ì–´ê°€ëŠ” ê¸°ë³¸ ì •ë³´

```java

@Builder
@Data
@AllArgsConstructor
@NoArgsConstructor
public class Funding {
	private int fundingId;
	private int userId;
	private String fundingTitle;
	private LocalDate endDate;
	private String fundingSummaryName;
	private String username;
	private int recentSort;
	private String nearDeadline;
	private String eventStatus;
	private int goalTotal;
	private int totalRewardPrice;
	private int joinPercent;
	private String mainImgUrl;
	private String subImgUrl;
	private int fundingCategoryId;
	private String storyTitle;
	private String storyContent;

	public FundingDetailRespDto getDetailFunding() {
		return FundingDetailRespDto.builder()
				.fundingId(fundingId)
				.fundingSummaryName(fundingSummaryName)
				.fundingTitle(fundingTitle)
				.deadline(nearDeadline)
				.goalTotal(goalTotal)
				.totalRewardPrice(totalRewardPrice)
				.storyTitle(storyTitle)
				.storyContent(storyContent)
				.mainImgUrl(mainImgUrl)
				.subImgUrl(subImgUrl)
				.joinPercent(joinPercent)
				.build();
	}
}

```

</br>

- ë¦¬ì›Œë“œ ê´€ë ¨ëœ ì •ë³´

```java

@Builder
@Data
@AllArgsConstructor
@NoArgsConstructor
public class Reward {
	private String pageCategory;
	private int rewardId;
	private String rewardName;
	private int rewardPrice;
	private int fundingId;
	private LocalDate endDate;
	private String userCount;
	
	public RewardRespDto getFundingReward() {
		return RewardRespDto.builder()
				.rewardId(rewardId)
				.rewardName(rewardName)
				.rewardPrice(rewardPrice)
				.fundingId(fundingId)
				.endDate(endDate)
				.userCount(userCount)
				.build();
	}
}

```

</br>

- ì‚¬ì—…ì ì •ë³´

```java

@Builder
@Data
@NoArgsConstructor
@AllArgsConstructor
public class BusinessInfo {
	private String pageCategory;
	private int businessInfoId;
	private String companyName;
	private String ceoName;
	private String companyAddress;
	private String companyPhoneNumber;
	private String ceoEmail;
	private int fundingId;
	
	public BusinessInfoRespDto toBusinessInfo() {
		return BusinessInfoRespDto.builder()
				.businessInfoId(businessInfoId)
				.companyName(companyName)
				.ceoName(ceoName)
				.companyAddress(companyAddress)
				.companyPhoneNumber(companyPhoneNumber)
				.ceoEmail(ceoEmail)
				.fundingId(fundingId)
				.build();
	}
}

```

</br>

- ì°¸ì—¬ë‚´ì—­

```java

@Builder
@Data
@AllArgsConstructor
@NoArgsConstructor
public class Funding {
	private int fundingId;
	private int userId;
	private String fundingTitle;
	private LocalDate endDate;
	private String fundingSummaryName;
	private String username;
	private int recentSort;
	private String nearDeadline;
	private String eventStatus;
	private int goalTotal;
	private int totalRewardPrice;
	private int joinPercent;
	private String mainImgUrl;
	private String subImgUrl;
	private int fundingCategoryId;
	private String storyTitle;
	private String storyContent;

	public BreakdownRespDto toBreakdown() {
		return BreakdownRespDto.builder()
				.fundingId(fundingId)
				.userId(userId)
				.username(username)
				.totalRewardPrice(totalRewardPrice)
				.build();
	}

}

```

</br>

- sqlì—ì„œ ë°›ì€ ë°ì´í„°ë“¤ì„ RespDtoë¡œ ë°˜í™˜í•´ì£¼ê³  ìˆë‹¤.

---

</br></br>

**Repository**

```java

@Mapper
public interface FundingDetailRepository {
	public Funding fundingDetail(int pageId);
	public List<Reward> getReward(int pageId);
	public BusinessInfo getBusinessInfo(int pageId);
	public List<Funding> getBreakdown(int pageId);
	public Address getAddressId(int userId);
}

```

</br>

- pageId(ë‚´ê°€ í´ë¦­í•œ í€ë”©)ë¡œ sqlì—ì„œ íŠ¹ì • í€ë”©ì„ ì°¾ì•„ ë°ì´í„°ë¥¼ ë“¤ê³ ì˜¬ ê²ƒì´ë‹¤. 

- userIdëŠ” ìœ„ì—ì„œ ë¡œê·¸ì¸ í™•ì¸ì´ ëë‚œ ìœ ì €ì˜ ë²ˆí˜¸ë‹¤. ê·¸ ë²ˆí˜¸ë¡œ ìœ ì €ì˜ ì£¼ì†Œë¥¼ ë“¤ê³ ì˜¬ ê²ƒì„.

---

</br></br>

**Sql**

- í€ë”© ìƒì„¸ í˜ì´ì§€ ìƒë‹¨ì— ë“¤ì–´ê°€ëŠ” ê¸°ë³¸ ì •ë³´

```sql

	<resultMap type="com.webproject.crowdfunding.entity.Funding" id="FundingDetailMap">
		<id property="fundingId" column="funding_id"/>
		<result property="userId" column="user_id"/>
		<result property="fundingSummaryName" column="funding_summary_name"/>
		<result property="fundingTitle" column="funding_title"/>
		<result property="username" column="username"/>
		<result property="nearDeadline" column="deadline"/>
		<result property="goalTotal" column="goal_total"/>
		<result property="totalRewardPrice" column="total_reward_price"/>
		<result property="storyTitle" column="story_title"/>
		<result property="storyContent" column="story_content"/>
		<result property="mainImgUrl" column="main_img_url"/>
		<result property="subImgUrl" column="sub_img_url"/>
		<result property="joinPercent" column="join_percent"/>
	</resultMap>

	<select id="fundingDetail" resultMap="FundingDetailMap" parameterType="integer">
		select
		    fpt.funding_id,
		    fpt.funding_summary_name,
		    fpt.funding_name as funding_title,
		    CONCAT(
		    IF(NOW() &lt; fpt.end_date,  DATEDIFF(fpt.end_date, NOW()), IF(DATEDIFF(NOW(), fpt.end_date) = 0, 'ì˜¤ëŠ˜ ë§ˆê°', 'ì¢…ë£Œ'))
		    ) as deadline,
		    fpt.goal_total,
		    sum(if(ft.funder_id is null, 0, rt.reward_price)) as total_reward_price,
		    fpt.story_title,
		    fpt.story_content,
		    fpt.main_img_url as main_img_url,
		    fpsit.img_url as sub_img_url,
		    ROUND((sum(if(ft.funder_id is null, 0, rt.reward_price)) / fpt.goal_total) * 100) as join_percent
		from
		    funding_page_tb fpt
		    left outer join reward_tb rt on (rt.funding_id = fpt.funding_id)
		    left outer join funder_tb ft on (ft.reward_id = rt.reward_id)
		    left outer join funding_page_sub_img_tb fpsit on (fpsit.funding_id = fpt.funding_id)
		where
		    fpt.funding_id = #{pageId};
	</select>

```

</br>

- ë¦¬ì›Œë“œ ê´€ë ¨ëœ ì •ë³´

```sql

	<resultMap type="com.webproject.crowdfunding.entity.Reward" id="RewardMap">
		<id property="rewardId" column="reward_id"/>
		<result property="fundingId" column="funding_id"/>
		<result property="rewardName" column="reward_name"/>
		<result property="rewardPrice" column="reward_price"/>
		<result property="endDate" column="end_date"/>
		<result property="userCount" column="user_count"/>
	</resultMap>

	<select id="getReward" parameterType="integer" resultMap="RewardMap">
		select
		    rt.reward_id,
		    rt.funding_id,
		    rt.reward_name,
		    rt.reward_price,
		    fpt.end_date,
		    count(distinct ut.user_id) as user_count
		from 
	            reward_tb rt
		    left outer join funding_page_tb fpt on(fpt.funding_id = rt.funding_id)
		    left outer join funder_tb ft on(ft.reward_id = rt.reward_id)
		    left outer join user_tb ut on(ut.user_id = ft.user_id)
		where
		    rt.funding_id = #{pageId}
		group by
		    reward_id;
	</select>

```

</br>

- ì‚¬ì—…ì ì •ë³´

```sql

	<resultMap type="com.webproject.crowdfunding.entity.BusinessInfo" id="BusinessInfoMap">
		<id property="businessInfoId" column="business_info_id"/>
		<result property="companyName" column="company_name"/>
		<result property="ceoName" column="ceo_name"/>
		<result property="companyAddress" column="company_address"/>
		<result property="companyPhoneNumber" column="company_phone_number"/>
		<result property="ceoEmail" column="ceo_email"/>
		<result property="fundingId" column="funding_id"/>
	</resultMap>

	<select id="getBusinessInfo" parameterType="integer" resultMap="BusinessInfoMap">
		select
		    bt.business_info_id,
		    bt.company_name,
		    bt.ceo_name,
		    bt.company_address,
		    bt.company_phone_number,
		    bt.ceo_email,
		    bt.funding_id
		from
		    business_info_tb bt
		where
		    bt.funding_id = #{pageId};
	</select>

```

</br>

- ì°¸ì—¬ë‚´ì—­

```sql

	<select id="getBreakdown" parameterType="integer" resultMap="FundingDetailMap">
		select
		    fpt.funding_id,
		    ut.user_id,
		    ut.name as username,
		    sum(if(ft.funder_id is null, 0, rt.reward_price)) as total_reward_price
		from
		    funding_page_tb fpt
		    left outer join reward_tb rt on(rt.funding_id = fpt.funding_id)
		    left outer join funder_tb ft on(ft.reward_id = rt.reward_id)
		    left outer join user_tb ut on(ut.user_id = ft.user_id)
		where
		    fpt.funding_id = #{pageId}
		    AND ut.user_id IS NOT NULL
		    AND ut.name IS NOT NULL
		group by
		    funding_id,
		    user_id,
		    username
	</select>

```

</br>

- ì£¼ì†Œ ì •ë³´

```sql

	<resultMap type="com.webproject.crowdfunding.entity.Address" id="AddressMap">
		<id property="addressId" column="address_id"/>
		<result property="userId" column="user_id"/>
		<result property="zonecode" column="zonecode"/>
		<result property="address" column="address"/>
		<result property="buildingName" column="building_name"/>
		<result property="bname" column="bname"/>
		<result property="detailAddress" column="detail_address"/>
		<result property="addressType" column="address_type"/>
	</resultMap>

	<select id="getAddressId" parameterType="integer" resultMap="AddressMap">
		select
			at.address_id,
			at.user_id,
			at.zonecode,
			at.address,
			at.building_name,
			at.bname,
			at.detail_address,
			at.address_type
		from
			address_tb at
		where
			at.user_id = #{userId};
	</select>

```

</br>

- í˜•ì‹ì€ í€ë”© ë©”ì¸ í˜ì´ì§€ ì½”ë“œ ë¦¬ë·°ì—ì„œ í•œ ê²ƒê³¼ ë™ì¼í•˜ë‹¤. ê° í…Œì´ë¸”ì—ì„œ í•„ìš”í•œ ê²ƒë“¤ì„ joiní•˜ê³ , í•„ìš”ì— ë§ê²Œ ì´ë¦„ì„ ë°”ê¿”ì£¼ì—ˆë‹¤.

- ì´ ì •ë³´ë“¤ì„ ê° Entityì— ë§ê²Œ ê°’ì„ ë°˜í™˜í•´ì£¼ê³  ìˆë‹¤.

---

</br></br>

**Database**

- í€ë”© ìƒì„¸ í˜ì´ì§€ ìƒë‹¨ ì •ë³´

![í€ë”© ìƒì„¸ í˜ì´ì§€ ìƒë‹¨](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/8b2fe954-9373-45f4-98d2-ec9644bcb9f4)

</br>

- ë¦¬ì›Œë“œ ê´€ë ¨ ì •ë³´

![ë¦¬ì›Œë“œ ê´€ë ¨ ì •ë³´](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/d3ce8b99-2f61-44bb-92c1-dcd74f51312d)

</br>

- ì‚¬ì—…ì ì •ë³´

![ì‚¬ì—…ì ì •ë³´](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/ea82184e-8e52-46f3-8687-eda044f1a220)

</br>

- ì°¸ì—¬ë‚´ì—­

![ì°¸ì—¬ë‚´ì—­2](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/5653092f-0cb8-463d-a71b-d7455bf3cdbc)

</br>

- ì£¼ì†Œ ì •ë³´

![ì£¼ì†Œ ì •ë³´](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/4dbc05f2-c7a1-4cc0-9624-fb0344e4800c)

</div>
</details>

<br/>

### **ê´€ë¦¬ì í€ë”© ë° ê¸°ë¶€ ë“±ë¡ í˜ì´ì§€ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°**

<details>
<summary>ê¸°ë¶€ ë° í€ë”© ë“±ë¡ ìœ íš¨ì„± ê²€ì‚¬ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°</summary>
<div markdown="1">

</br>

**ì˜ìƒ**

</br>

![ê´€ë¦¬ì í˜ì´ì§€ ìœ íš¨ì„± ê²€ì‚¬ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/d5d256ce-e970-40a9-9496-9aa57a43197f)

</br></br>

## FrontEnd

**ìš”ì²­**

- ê¸°ë¶€

```javascript

    const giveRegisterPage = async () => {
        const formData = new FormData();
        formData.append("pageCategory", giveInputParams.pageCategory);
        formData.append("detailCategory", giveInputParams.detailCategory)
        formData.append("title", giveInputParams.title)
        formData.append("storyTitle", giveInputParams.storyTitle)
        formData.append("story", giveInputParams.story)
        mainImgFiles.forEach(imgFile => {
            formData.append("mainImgUrl", imgFile.file);
        })
        subImgFiles.forEach(imgFile => {
            formData.append("subImgUrl", imgFile.file);
        })
        formData.append("goalTotal", giveInputParams.goalTotal);
        formData.append("endDate", giveInputParams.endDate);
        formData.append("giveUsing", giveInputParams.giveUsing);
        formData.append("donationExpense", giveInputParams.donationExpense);
        formData.append("businessStartDate", giveInputParams.businessStartDate);
        formData.append("businessEndDate", giveInputParams.businessEndDate);
        formData.append("target", giveInputParams.target);
        formData.append("targetCount", giveInputParams.targetCount);
        formData.append("benefitEffect", giveInputParams.benefitEffect);
        formData.append("companyName", giveInputParams.companyName)
        formData.append("ceoName", giveInputParams.ceoName)
        formData.append("companyAddress", giveInputParams.companyAddress)
        formData.append("companyPhoneNumber", giveInputParams.companyPhoneNumber)

        const option = {
            headers: {
                "Content-Type": "multipart/form-data"
            }
        }
        try {
            await axios.post("http://localhost:8080/admin/giving/registerpage", formData, option)
            alert("ê¸°ë¶€ í˜ì´ì§€ ë“±ë¡ ì„±ê³µ");
            navigate("/giving");
        } catch (error) {
            giveFundErrorMessages({
                title: "",
                storyTitle: "",
                story: "",
                mainImgUrl: "",
                subImgUrl: "",
                endDate: "",
                giveUsing: "",
                businessStartDate: "",
                businessEndDate: "",
                target: "",
                benefitEffect: "",
                companyName: "",
                ceoName: "",
                companyAddress: "",
                companyPhoneNumber: "",
                ...error.response.data.errorData})
        }
    };

```

</br>

- í€ë”©

```javascript

    const fundingRegisterPage = async () => {
        const formData = new FormData();
        formData.append("pageCategory", fundingInputParams.pageCategory);
        formData.append("detailCategory", fundingInputParams.detailCategory)
        formData.append("title", fundingInputParams.title)
        formData.append("storyTitle", fundingInputParams.storyTitle)
        formData.append("story", fundingInputParams.story)
        mainImgFiles.forEach(imgFile => {
            formData.append("mainImgUrl", imgFile.file);
        })
        subImgFiles.forEach(imgFile => {
            formData.append("subImgUrl", imgFile.file);
        })
        formData.append("goalTotal", fundingInputParams.goalTotal);
        formData.append("endDate", fundingInputParams.endDate);
        formData.append("rewardName", fundingInputParams.rewardName)
        formData.append("rewardPrice", fundingInputParams.rewardPrice)
        formData.append("companyName", fundingInputParams.companyName)
        formData.append("ceoName", fundingInputParams.ceoName)
        formData.append("nickname", fundingInputParams.nickname)
        formData.append("companyAddress", fundingInputParams.companyAddress)
        formData.append("companyPhoneNumber", fundingInputParams.companyPhoneNumber)
        formData.append("email", fundingInputParams.email)
        const option = {
            headers: {
                "Content-Type": "multipart/form-data",
                Authorization: `Bearer ${accessToken}`
            }
        }
        try {
            await axios.post("http://localhost:8080/admin/funding/registerpage", formData, option);
            alert("í€ë”© í˜ì´ì§€ ë“±ë¡ ì„±ê³µ");
            navigate("/funding");
        } catch (error) {
            setFundErrorMessages({
                title: "",
                storyTitle: "",
                story: "",
                mainImgUrl: "",
                subImgUrl: "",
                endDate: "",
                rewardName: "",
                companyName: "",
                ceoName: "",
                nickname: "",
                companyAddress: "",
                companyPhoneNumber: "",
                email:""
                , ...error.response.data.errorData})
        }
    };

```

</br>

- ìš”ì²­ì„ ë³´ë‚´ê³  ì—ëŸ¬ê°€ ìˆì„ ê²½ìš° ì˜¤ëŠ” ë©”ì„¸ì§€ë¥¼ ë‹´ê³  ìˆë‹¤. 

---

</br></br>

## BackEnd

**Dto**

- ê¸°ë¶€

```java

@Data
public class GivingRegisterReqDto {
	private String pageCategory;
	private String detailCategory;
	@NotBlank(message= "ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String title;
	
	@NotBlank(message= "ìŠ¤í† ë¦¬ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String storyTitle;
	
	@NotBlank(message= "ìŠ¤í† ë¦¬ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String story;
	
	@NotNull(message= "ë©”ì¸ ì´ë¯¸ì§€ë¥¼ ì²¨ë¶€í•´ì£¼ì„¸ìš”.")
	private MultipartFile mainImgUrl;
	
	@NotNull(message= "ìƒì„¸ ì´ë¯¸ì§€ë¥¼ ì²¨ë¶€í•´ì£¼ì„¸ìš”.")
	private MultipartFile subImgUrl;
	
	private int goalTotal;
	
	@NotBlank(message= "ì¢…ë£Œ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
    	@Pattern(regexp = "^\\d{4}-\\d{2}-\\d{2}$",
            	message = "ì¢…ë£Œ ë‚ ì§œë¥¼ í˜•ì‹ì— ë§ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.")
	private String endDate;
    
	@NotEmpty(message= "ê¸°ë¶€ê¸ˆ ì‚¬ìš© ê³„íšì€ í•œ ê°œ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
	private List<
	@NotBlank(message= "ê¸°ë¶€ê¸ˆ ì‚¬ìš© ë‚´ì—­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	String> giveUsing;
	
	private List<Integer> donationExpense;
	
	@NotBlank(message= "ì‚¬ì—… ì‹œì‘ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
    	@Pattern(regexp = "^\\d{4}-\\d{2}-\\d{2}$",
           	 message = "ì‚¬ì—… ì‹œì‘ ë‚ ì§œë¥¼ í˜•ì‹ì— ë§ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.")
	private String businessStartDate;
    
	@NotBlank(message= "ì‚¬ì—… ì¢…ë£Œ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
    	@Pattern(regexp = "^\\d{4}-\\d{2}-\\d{2}$",
    	message = "ì‚¬ì—… ì¢…ë£Œ ë‚ ì§œë¥¼ í˜•ì‹ì— ë§ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.")
	private String businessEndDate;
    
    	@NotBlank(message= "ëŒ€ìƒì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String target;
    
	private int targetCount;
    
    	@NotBlank(message= "ì‚¬ì—… íš¨ê³¼ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String benefitEffect;
    
    	@NotBlank(message= "ë‹¨ì²´ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String companyName;
    
    	@NotBlank(message= "ëŒ€í‘œëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String ceoName;
    
    	@NotBlank(message= "ì‚¬ì—…ì ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String companyAddress;
    
    	@NotBlank(message= "ê³ ê°ì„¼í„° ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String companyPhoneNumber;
}

```

</br>

- í€ë”© 

```java

@Data
public class FundingRegisterPageReqDto {
	private String pageCategory;
	private String detailCategory;
	@NotBlank(message= "ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String title;
	
	@NotBlank(message= "ìŠ¤í† ë¦¬ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String storyTitle;
	
	@NotBlank(message= "ìŠ¤í† ë¦¬ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String story;
	
	@NotNull(message= "ë©”ì¸ ì´ë¯¸ì§€ë¥¼ ì²¨ë¶€í•´ì£¼ì„¸ìš”.")
	private MultipartFile mainImgUrl;
	
	@NotNull(message= "ìƒì„¸ ì´ë¯¸ì§€ë¥¼ ì²¨ë¶€í•´ì£¼ì„¸ìš”.")
	private MultipartFile subImgUrl;
	
	private int goalTotal;
	
	@NotBlank(message= "ì¢…ë£Œ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
    	@Pattern(regexp = "^\\d{4}-\\d{2}-\\d{2}$",
            	message = "ì¢…ë£Œ ë‚ ì§œë¥¼ í˜•ì‹ì— ë§ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.")
	private String endDate;
    
    	@NotEmpty(message= "ë¦¬ì›Œë“œëŠ” í•œ ê°œ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
    	private List<
    	@NotBlank(message= "ë¦¬ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
    	String> rewardName;
    
	private List<Integer> rewardPrice;
    
    	@NotBlank(message= "ìƒí˜¸ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String companyName;
    
    	@NotBlank(message= "ëŒ€í‘œëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String ceoName;
    
	@NotBlank(message= "ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String nickname;
    
    	@NotBlank(message= "ì‚¬ì—…ì ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String companyAddress;
    
    	@NotBlank(message= "ê³ ê°ì„¼í„° ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
	private String companyPhoneNumber;
    
    	@NotBlank(message= "ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
    	@Email
	private String email;

```

- Controllerë¡œ ë„˜ì–´ì˜¤ë©´ì„œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•˜ëŠ” ë¶€ë¶„. í•´ë‹¹ë˜ëŠ” ë¶€ë¶„ì— ì—ëŸ¬ë©”ì„¸ì§€ë¥¼ ë°˜í™˜í•œë‹¤.

---

</div>
</details>

<details>
<summary>ê¸°ë¶€ ë“±ë¡ ì˜ìƒ</summary>
<div markdown="1">

![ê¸°ë¶€ ë“±ë¡ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/311a9a48-11e9-44a9-8691-0def0355ba07)

</div>
</details>

<details>
<summary>í€ë”© ë“±ë¡ ì˜ìƒ</summary>
<div markdown="1">

![í€ë”© ë“±ë¡ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/69890336-542c-42f2-b6fd-43ee0dbd6f89)

</div>
</details>

<details>
<summary>í€ë”© & ê¸°ë¶€ ë“±ë¡ ì½”ë“œ ë¦¬ë·° - íŒŒì¼ ì…ì¶œë ¥ í¬í•¨</summary>
<div markdown="1">

## FrontEnd

**ê¸°ë¶€ & í€ë”© ë“±ë¡ html ì½”ë“œ**

- ê¸°ë¶€

```html

{giveInputParams.pageCategory === 'ê¸°ë¶€' ? 
            <>
                <div css={mainTitleContainer}>
                    <h1 css={mainTitle}>ê¸°ë¶€ í˜ì´ì§€ ë“±ë¡</h1>
                </div>
                <div css={infoInputContainer}>
                    <div css={subTitle}>
                        ê¸°ë¶€ ì¹´í…Œê³ ë¦¬ ì„¤ì •
                    </div>
                    <div css={infoInput}>
                        <div css={infoTitle}>ê¸°ë¶€ í˜ì´ì§€ ì¹´í…Œê³ ë¦¬</div>
                        <div css={inputContainer}>
                        <select onChange={changeGivePageCategory} css={comboBox}>
                            {mainCategoryList.map((item) => (
                                <option value={item} key={item}>
                                    {item}
                                </option>
                                ))}
                        </select> 
                        </div> 
                    </div>
                </div>
                    <div css={infoInput}>
                        <div css={infoTitle}>ê¸°ë¶€ ìƒì„¸ ì¹´í…Œê³ ë¦¬</div>
                        <div css={inputContainer}>
                            {giveInputParams.pageCategory === 'ê¸°ë¶€' ? 
                        <select onChange={changeDetailCategory} css={comboBox}>
                            {giveSubCategoryList.map((item) => (
                                <option value={item} key={item}>
                                    {item}
                                </option>
                                ))}
                                </select> :<select onChange={changeDetailCategory} css={comboBox}>
                            {fundSubCateogoryList.map((item) => (
                                <option value={item} key={item}>
                                    {item}
                                </option>
                            ))}
                            </select>}
                        </div> 
                    </div>
                    <div css={subTitle}>
                        ê¸°ë¶€ í˜ì´ì§€ ì„¤ì •
                    </div>
                    <div css={infoInput}>
                        <div css={infoTitle}>ê¸°ë¶€ ì œëª©</div>
                        <div css={inputContainer}>
                            <input onChange={changeTitle} css={input} type="text"/>
                            <div css={errorMsg}>{giveErrorMessages.title}</div>
                        </div> 
                    </div>
                    <div css={infoInput}>
                        <div css={infoTitle}>ê¸°ë¶€ ìŠ¤í† ë¦¬ ì œëª©</div>
                        <div css={inputContainer}>
                            <input onChange={changeStoryTitle} css={input} type="text"/>
                            <div css={errorMsg}>{giveErrorMessages.storyTitle}</div>  
                        </div> 
                    </div>
                    <div css={storyInfoInput}>
                        <div css={storyInfoTitle}>ê¸°ë¶€ ìŠ¤í† ë¦¬ ë‚´ìš©</div>
                        <div css={storyInputContainer}>
                        <textarea onChange={changeStory} css={storyTextArea} name="" id="" cols="30" rows="10"></textarea>
                        <div css={errorMsg}>{giveErrorMessages.story}</div> 
                        </div> 
                    </div>
                    <div css={infoInput}>
                        <div css={infoTitle}>ê¸°ë¶€ ë©”ì¸ ì´ë¯¸ì§€</div>
                        <div css={inputContainer}>
                            <input css={input} type="file" onChange={changeMainImgUrl} accept={".jpg, .png"}/>
                            <div css={errorMsg}>{giveErrorMessages.mainImgUrl}</div>   
                        </div> 
                    </div>

                    <div css={infoInput}>
                        <div css={infoTitle}>ê¸°ë¶€ ìŠ¤í† ë¦¬ ì´ë¯¸ì§€</div>
                        <div css={inputContainer}>
                            <input css={input} type="file" onChange={changeSubImgUrl} accept={".jpg, .png"}/>
                            <div css={errorMsg}>{giveErrorMessages.subImgUrl}</div>  
                        </div> 
                    </div>
                
                    <div css={infoInput}>
                        <div css={infoTitle}>ê¸°ë¶€ ëª©í‘œ ê¸ˆì•¡</div>
                        <div css={inputContainer}>
                            <input onChange={changeGoalTotal} css={input} type="text"/>ì›    
                        </div> 
                    </div>

                    <div css={infoInput}>
                        <div css={infoTitle}>ê¸°ë¶€ ì¢…ë£Œì¼</div>
                        <div css={inputContainer}>
                            <input onChange={changeEndDate} css={input} type="text"/>
                            <div css={errorMsg}>{giveErrorMessages.endDate}</div>   
                        </div> 
                    </div>
                    {showTable && giveInputParams.pageCategory === 'ê¸°ë¶€' ?
                    <div css={rewardInfoInputContainer}>
                        <div css={rewardHeader}>
                            <h1 css={rewardH1}>ê¸°ë¶€ê¸ˆ ì‚¬ìš© ê³„íš</h1>
                            <div css={btnContainer}>
                                <button css={rewardBtn} onClick={addGiveUsingInputComponentHandle}>+</button>
                            </div>
                        </div>
                        <table css={rewardTable}>
                            <thead>
                                <tr css={rewardTr}>
                                    <th css={rewardNameThAndTd}>ì‚¬ìš© ë‚´ì—­</th>
                                    <th css={rewardPriceThAndTd}>ì‚¬ìš© ê¸ˆì•¡</th>
                                </tr>
                            </thead>
                            <tbody>
                                {giveTds.map(giveTd => (
                                    <tr css={rewardTr} key={giveTd.id}>
                                        <td css={rewardNameThAndTd}><input onChange={(e)=> handleGivingUsingChange(giveTd.id,e)} css={rewardTdInput} type="text"/></td>
                                        <td css={rewardPriceThAndTd}><input onChange={(e)=> handleGivingUsingPriceChange(giveTd.id,e)} css={rewardTdInput} type="number" placeholder='(ì›)'/><button css={rewardBtn} value={giveTd.id} onClick={(e)=>removeGiveUsingInputComponentHandle(giveTd.id,e)}>-</button></td>    
                                    </tr>
                                ))}
                                <div css={rewardMsg}>{giveErrorMessages.giveUsing}</div>
                            </tbody>
                        </table>
                        <div css={saveBtnContainer}>
                            <button onClick={madeGiveUsingList}>ì €ì¥í•˜ê¸°</button>
                        </div>
                    </div>
                : ""}
                <div css={subTitle}>
                    ì‚¬ì—…ëŒ€ìƒ ë° ê¸°ëŒ€íš¨ê³¼
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ì‚¬ì—… ì‹œì‘ì¼</div>
                    <div css={inputContainer}>
                        <input onChange={changeBusinessStartDate} css={input} type="text"/>
                        <div css={errorMsg}>{giveErrorMessages.businessStartDate}</div>
                    </div> 
                </div> 
                <div css={infoInput}>
                    <div css={infoTitle}>ì‚¬ì—… ì¢…ë£Œì¼</div>
                    <div css={inputContainer}>
                        <input onChange={changeBusinessEndDate} css={input} type="text"/>
                        <div css={errorMsg}>{giveErrorMessages.businessEndDate}</div>
                    </div> 
                </div> 
                <div css={infoInput}>
                    <div css={infoTitle}>ì‚¬ì—… ëŒ€ìƒ</div>
                    <div css={inputContainer}>
                        <input onChange={changeTarget} css={input} type="text"/> 
                        <div css={errorMsg}>{giveErrorMessages.target}</div>   
                    </div> 
                </div> 
                <div css={infoInput}>
                    <div css={infoTitle}>ëŒ€ìƒ ìˆ˜</div>
                    <div css={inputContainer}>
                        <input onChange={changeTargetCount} css={input} type="text"/>    
                    </div> 
                </div> 
                <div css={infoInput}>
                    <div css={infoTitle}>ê¸°ëŒ€ íš¨ê³¼</div>
                    <div css={inputContainer}>
                        <input onChange={changeBenefitEffect} css={input} type="text"/>
                        <div css={errorMsg}>{giveErrorMessages.benefitEffect}</div> 
                    </div> 
                </div>
                <div css={subTitle}>
                    ê¸°ë¶€ ì‹ ì²­ì¸ ë“±ë¡
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ë‹¨ì²´ëª…</div>
                    <div css={inputContainer}>
                        <input onChange={changeCompanyName} css={input} type="text"/>
                        <div css={errorMsg}>{giveErrorMessages.companyName}</div> 
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ëŒ€í‘œì</div>
                    <div css={inputContainer}>
                        <input onChange={changeCeoName} css={input} type="text"/>
                        <div css={errorMsg}>{giveErrorMessages.ceoName}</div>
                    </div> 
                </div> 
                <div css={infoInput}>
                    <div css={infoTitle}>ì£¼ì†Œ</div>
                    <div css={inputContainer}>
                        <input onChange={changeCompanyAddress} css={input} type="text"/>    
                        <div css={errorMsg}>{giveErrorMessages.companyAddress}</div>
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ê³ ê°ì„¼í„°</div>
                    <div css={inputContainer}>
                        <input onChange={changePhoneNumber} css={input} type="text"/>    
                        <div css={errorMsg}>{giveErrorMessages.companyPhoneNumber}</div>
                    </div> 
                </div>
            <div css={submitBtnContainer}>
                <button onClick={giveRegisterPage}>ê¸°ë¶€ í˜ì´ì§€ ë“±ë¡í•˜ê¸°</button>
            </div>

```

</br>

- í€ë”©

```html
        </> :          
        <>
            <div css={mainTitleContainer}>
                <h1 css={mainTitle}>í€ë”© í˜ì´ì§€ ë“±ë¡</h1>
            </div>
            <div css={infoInputContainer}>
                <div css={subTitle}>
                    í€ë”© ì¹´í…Œê³ ë¦¬ ì„¤ì •
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>í€ë”© í˜ì´ì§€ ì¹´í…Œê³ ë¦¬</div>
                    <div css={inputContainer}>
                    <select onChange={changeFundingPageCategory} css={comboBox}>
                        {mainCategoryList.map((item) => (
                            <option value={item} key={item}>
                                {item}
                            </option>
                            ))}
                            </select> 
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>í€ë”© ìƒì„¸ ì¹´í…Œê³ ë¦¬</div>
                    <div css={inputContainer}>
                    {fundingInputParams.pageCategory === 'í€ë”©' ? 
                    <select onChange={changeDetailCategory} css={comboBox}>
                        {fundSubCateogoryList.map((item) => (
                            <option value={item} key={item}>
                                {item}
                            </option>
                            ))}
                            </select> :<select onChange={changeDetailCategory} css={comboBox}>
                        {giveSubCategoryList.map((item) => (
                            <option value={item} key={item}>
                                {item}
                            </option>
                            ))}
                            </select>}
                    </div> 
                </div>
                <div css={subTitle}>
                    í€ë”© í˜ì´ì§€ ì„¤ì •
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>í€ë”© ì œëª©</div>
                    <div css={inputContainer}>
                        <input onChange={changeTitle} css={input} type="text"/>
                        <div css={errorMsg}>{fundErrorMessages.title}</div>  
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>í€ë”© ìŠ¤í† ë¦¬ ì œëª©</div>
                    <div css={inputContainer}>
                        <input onChange={changeStoryTitle} css={input} type="text"/>
                        <div css={errorMsg}>{fundErrorMessages.storyTitle}</div>
                    </div> 
                </div>
                <div css={storyInfoInput}>
                    <div css={storyInfoTitle}>í€ë”© ìŠ¤í† ë¦¬ ë‚´ìš©</div>
                    <div css={storyInputContainer}>
                    <textarea onChange={changeStory} css={storyTextArea} name="" id="" cols="30" rows="10"></textarea>
                    <div css={errorMsg}>{fundErrorMessages.story}</div> 
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>í€ë”© ë©”ì¸ ì´ë¯¸ì§€</div>
                    <div css={inputContainer}>
                    <input css={input} type="file" onChange={changeMainImgUrl} accept={".jpg, .png"}/>
                    <div css={errorMsg}>{fundErrorMessages.mainImgUrl}</div>    
                    </div> 
                </div>

                <div css={infoInput}>
                    <div css={infoTitle}>í€ë”© ìŠ¤í† ë¦¬ ì´ë¯¸ì§€</div>
                    <div css={inputContainer}>
                    <input css={input} type="file" onChange={changeSubImgUrl} accept={".jpg, .png"}/>
                    <div css={errorMsg}>{fundErrorMessages.subImgUrl}</div>
                    </div> 
                </div>
            
                <div css={infoInput}>
                    <div css={infoTitle}>í€ë”© ëª©í‘œ ê¸ˆì•¡</div>
                    <div css={inputContainer}>
                        <input onChange={changeGoalTotal} css={input} type="text" placeholder='ìˆ«ìë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”'/>ì› 
                    </div> 
                </div>

                <div css={infoInput}>
                    <div css={infoTitle}>í€ë”© ì¢…ë£Œì¼</div>
                    <div css={inputContainer}>
                        <input onChange={changeEndDate} css={input} type="text" placeholder='ì˜ˆ) 2000-05-10'/>
                        <div css={errorMsg}>{fundErrorMessages.endDate}</div>
                    </div> 
                </div>
                {showTable && fundingInputParams.pageCategory === 'í€ë”©' ? 
                    <div css={rewardInfoInputContainer}>
                        <div css={rewardHeader}>
                            <h1 css={rewardH1}>ë¦¬ì›Œë“œ ì¶”ê°€</h1>
                            <div css={btnContainer}>
                                <button css={rewardBtn} onClick={addRewardInputComponentHandle}>+</button>
                            </div>
                        </div>
                        <table css={rewardTable}>
                            <thead>
                                <tr css={rewardTr}>
                                    <th css={rewardNameThAndTd}>ë¦¬ì›Œë“œ</th>
                                    <th css={rewardPriceThAndTd}>ê¸ˆì•¡</th>
                                </tr>
                            </thead>
                            <tbody>
                                {rewardTds.map(rewardTd => (
                                    <tr css={rewardTr} key={rewardTd.id}>
                                        <td css={rewardNameThAndTd}><input onChange={(e)=> handleRewardNameChange(rewardTd.id,e)} css={rewardTdInput} type="text"/></td>
                                        <td css={rewardPriceThAndTd}><input onChange={(e)=> handleRewardPriceChange(rewardTd.id,e)} css={rewardTdInput} type="number" placeholder='(ì›)'/><button css={rewardBtn} value={rewardTd.id} onClick={(e)=>removeRewardInputComponentHandle(rewardTd.id,e)}>-</button></td>    
                                    </tr>
                                ))}
                                <div css={rewardMsg}>{fundErrorMessages.rewardName}</div>
                            </tbody>
                        </table>
                        <div css={saveBtnContainer}>
                            <button onClick={madeRewardList}>ì €ì¥í•˜ê¸°</button>
                        </div>
                    </div>
                : ""}
                <div css={subTitle}>
                    í€ë”© ì‹ ì²­ì¸ ë“±ë¡
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ìƒí˜¸ëª…</div>
                    <div css={inputContainer}>
                        <input onChange={changeCompanyName} css={input} type="text"/>    
                        <div css={errorMsg}>{fundErrorMessages.companyName}</div>
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ëŒ€í‘œì</div>
                    <div css={inputContainer}>
                        <input onChange={changeCeoName} css={input} type="text"/>
                        <div css={errorMsg}>{fundErrorMessages.ceoName}</div> 
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ë‹‰ë„¤ì„</div>
                    <div css={inputContainer}>
                        <input onChange={changeNickname} css={input} type="text"/>
                        <div css={errorMsg}>{fundErrorMessages.nickname}</div>  
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ì£¼ì†Œ</div>
                    <div css={inputContainer}>
                        <input onChange={changeCompanyAddress} css={input} type="text"/>
                        <div css={errorMsg}>{fundErrorMessages.companyAddress}</div>
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ê³ ê°ì„¼í„°</div>
                    <div css={inputContainer}>
                        <input onChange={changePhoneNumber} css={input} type="text"/>
                        <div css={errorMsg}>{fundErrorMessages.companyPhoneNumber}</div>
                    </div> 
                </div>
                <div css={infoInput}>
                    <div css={infoTitle}>ì´ë©”ì¼</div>
                    <div css={inputContainer}>
                        <input onChange={changeEmail} css={input} type="text"/>
                        <div css={errorMsg}>{fundErrorMessages.email}</div>  
                    </div> 
                </div>
            </div>
            <div css={submitBtnContainer}>
                <button onClick={fundingRegisterPage}>í€ë”© í˜ì´ì§€ ë“±ë¡í•˜ê¸°</button>
            </div>
        </>}

```

</br>

- ì›¹ í˜ì´ì§€ì—ì„œ input ì°½ì— ê°’ì„ ì¨ì£¼ê³  ê·¸ ê°’ë“¤ì„ onChange ì†ì„±ìœ¼ë¡œ ë„˜ê²¨ì¤€ë‹¤.

---

</br></br>

**ì…ë ¥ ë°›ì€ ê°’ ì²˜ë¦¬**

```javascript

    const [ mainImgFiles, setMainImgFiles ] = useState([]);
    const [ subImgFiles, setSubImgFiles ] = useState([]);
    const fileId = useRef(1);
    const navigate = useNavigate();
    const [giveInputParams, setGiveInputParams] = useState({ 
        pageCategory: "ê¸°ë¶€",
        detailCategory : "ì•„ë™",
        title: "",
        storyTitle: "",
        story: "",
        imgUrl: "",
        goalTotal: 0,
        endDate: "",
        giveUsing: [],
        donationExpense: [],
        businessStartDate: "",
        businessEndDate: "",
        target: "",
        targetCount: 0,
        benefitEffect: "",
        companyName: "",
        ceoName: "",
        companyAddress: "",
        companyPhoneNumber: "",
    });

    const [fundingInputParams, setFundingInputParams] = useState({ 
        pageCategory: "í€ë”©",
        detailCategory : "ìŒì‹",
        title: "",
        storyTitle: "",
        story: "",
        imgUrl: "",
        goalTotal: 0,
        endDate: "",
        rewardName: [],
        rewardPrice: [],
        companyName: "",
        ceoName: "",
        nickname: "",
        companyAddress: "",
        companyPhoneNumber: "",
        email:""
    });

    const [ giveErrorMessages, giveFundErrorMessages ] = useState({
        title: "",
        storyTitle: "",
        story: "",
        mainImgUrl: "",
        subImgUrl: "",
        goalTotal: "",
        endDate: "",
        giveUsing: "",
        businessStartDate: "",
        businessEndDate: "",
        target: "",
        benefitEffect: "",
        companyName: "",
        ceoName: "",
        companyAddress: "",
        companyPhoneNumber: "",
    });

    const [ fundErrorMessages, setFundErrorMessages ] = useState({
        title: "",
        storyTitle: "",
        story: "",
        mainImgUrl: "",
        subImgUrl: "",
        goalTotal: "",
        endDate: "",
        rewardName: "",
        companyName: "",
        ceoName: "",
        nickname: "",
        companyAddress: "",
        companyPhoneNumber: "",
        email:""
    });
    
    const [giveTds, setGiveTds] = useState([{id: 1}]);
    
    const [rewardTds, setRewardTds] = useState([{id: 1}]);
    const giveId = useRef(2);
    const rewardId = useRef(2);
    const [showTable, setShowTable] = useState(true);
    const mainCategoryList = ["ê¸°ë¶€", "í€ë”©"];
    const giveSubCategoryList = ["ì•„ë™","ë…¸ì¸","ì¥ì• ì¸","ë‹¤ë¬¸í™”","í™˜ê²½"];
    const fundSubCateogoryList = ["ìŒì‹", "ë„ì„œ", "ì˜ë¥˜", "ì•¡ì„¸ì„œë¦¬&í™”ì¥í’ˆ", "ê½ƒ&ê³¼ì¼", "ìƒí™œìš©í’ˆ"];

    const [giveUsingMap, setGiveUsingMap] = useState(new Map());
    const [giveUsingPriceMap, setGiveUsingPriceMap] = useState(new Map());

    const [rewardNameMap, setRewardNameMap] = useState(new Map());
    const [rewardPriceMap, setRewardPriceMap] = useState(new Map());

    const [rewardNameIsBlank, setRewarNameIsBlank] = useState(false);
    const [rewardPriceIsBlank, setRewarPriceIsBlank] = useState(false);

    const [giveUsingIsBlank, setGiveUsingIsBlank] = useState(false);
    const [givesingPriceIsBlank, setGiveUsingPriceIsBlank] = useState(false);

    const handleGivingUsingChange = (id, e) => {
        const newInputValues = new Map(giveUsingMap);
        newInputValues.set(id, e.target.value);
        setGiveUsingMap(newInputValues);
        if(e.target.value === "") {
            setGiveUsingIsBlank(false);
        }else {
            setGiveUsingIsBlank(true);
        }
    };

    const handleRewardNameChange = (id, e) => {
        const newInputValues = new Map(rewardNameMap);
        newInputValues.set(id, e.target.value);
        setRewardNameMap(newInputValues);
        if(e.target.value === "") {
            setRewarNameIsBlank(false);
        }else {
            setRewarNameIsBlank(true);
        }
    };

    const handleGivingUsingPriceChange = (id, e) => {
        const newInputValues = new Map(giveUsingPriceMap);
        newInputValues.set(id, parseInt(e.target.value));
        setGiveUsingPriceMap(newInputValues);
        if(e.target.value === "") {
            setGiveUsingPriceIsBlank(false);
        }else {
            setGiveUsingPriceIsBlank(true);
        }
      };

    const handleRewardPriceChange = (id, e) => {
        const newInputValues = new Map(rewardPriceMap);
        newInputValues.set(id, parseInt(e.target.value));
        setRewardPriceMap(newInputValues);
        if(e.target.value === "") {
            setRewarPriceIsBlank(false);
        }else {
            setRewarPriceIsBlank(true);
        }
      };

    const madeGiveUsingList = () => {
        const giveUsingList = Array.from(giveUsingMap.values())
        const giveUsingPriceList = Array.from(giveUsingPriceMap.values())

        if(!giveUsingIsBlank && !givesingPriceIsBlank) {
            alert("ê¸°ë¶€ê¸ˆ ì‚¬ìš© ê³„íšì€ ë¹„ì›Œì ¸ìˆìœ¼ë©´ ì•ˆ ë©ë‹ˆë‹¤.");
        }else{
            setGiveInputParams({...giveInputParams, giveUsing: giveUsingList, donationExpense: giveUsingPriceList})
            setShowTable(false);
        }
    };

    const madeRewardList = () => {
        const nameList = Array.from(rewardNameMap.values())
        const priceList = Array.from(rewardPriceMap.values())

        if(!rewardNameIsBlank && !rewardPriceIsBlank) {
            alert("rewardëŠ” ë¹„ì›Œì ¸ìˆìœ¼ë©´ ì•ˆ ë©ë‹ˆë‹¤.");
        }else{
            setFundingInputParams({...fundingInputParams, rewardName: nameList, rewardPrice: priceList})
            setShowTable(false);
        }
    };

    const addGiveUsingInputComponentHandle = () => {
        setGiveTds([...giveTds, {id: giveId.current}]);
        giveId.current += 1;
    }

    const addRewardInputComponentHandle = () => {
        setFundingInputParams({...fundingInputParams, showRewardTable: true});
        setRewardTds([...rewardTds, {id: rewardId.current}]);
        rewardId.current += 1;
    }

    const removeGiveUsingInputComponentHandle = (id,e) => {
        setGiveTds([...giveTds.filter(giveTd => giveTd.id !== parseInt(e.target.value))]);
        const newGiveUsing = new Map(giveUsingMap);
        const newGiveUsingPrice = new Map(giveUsingPriceMap);
        newGiveUsing.delete(id);
        newGiveUsingPrice.delete(id);
        setGiveUsingMap(newGiveUsing);
        setGiveUsingPriceMap(newGiveUsingPrice);
    }

    const removeRewardInputComponentHandle = (id,e) => {
        setRewardTds([...rewardTds.filter(rewardTd => rewardTd.id !== parseInt(e.target.value))]);
        const newRewardName = new Map(rewardNameMap);
        const newRewardPrice = new Map(rewardPriceMap);
        newRewardName.delete(id);
        newRewardPrice.delete(id);
        setRewardNameMap(newRewardName);
        setRewardPriceMap(newRewardPrice);
    }

      const changeGivePageCategory = (e) => {
        const givePageCategory = e.target.value;
        let giveDetailCategory = giveSubCategoryList.detailCategory;
      
        if (givePageCategory === "ê¸°ë¶€") {
            giveDetailCategory = "ì•„ë™";
            setGiveInputParams({...giveInputParams, pageCategory: givePageCategory, detailCategory: giveDetailCategory})
        }else if(givePageCategory === "í€ë”©") {
            giveDetailCategory = "ìŒì‹";
            setFundingInputParams({...fundingInputParams, pageCategory: givePageCategory, detailCategory: giveDetailCategory})
        }
      
        setGiveInputParams({...giveInputParams, pageCategory: givePageCategory, detailCategory: giveDetailCategory,});
      };

    const changeFundingPageCategory = (e) => {
        const fundingPageCategory = e.target.value;
        let fundingDetailCategory = fundSubCateogoryList.detailCategory;
    
        if (fundingPageCategory === "í€ë”©") {
            fundingDetailCategory = "ìŒì‹";
            setFundingInputParams({...fundingInputParams, pageCategory: fundingPageCategory, detailCategory: fundingDetailCategory})
        }else if(fundingPageCategory === "ê¸°ë¶€") {
            fundingDetailCategory = "ì•„ë™"
            setGiveInputParams({...giveInputParams, pageCategory: fundingPageCategory, detailCategory: fundingDetailCategory})
        }
    }

    const changeDetailCategory = (e) => {
        setGiveInputParams({...giveInputParams, detailCategory:e.target.value})
        setFundingInputParams({...fundingInputParams, detailCategory:e.target.value})
    }

    const changeTitle = (e) => {
        setGiveInputParams({...giveInputParams, title:e.target.value})
        setFundingInputParams({...fundingInputParams, title:e.target.value})
    }

    const changeStoryTitle = (e) => {
        setGiveInputParams({...giveInputParams, storyTitle:e.target.value})
        setFundingInputParams({...fundingInputParams, storyTitle:e.target.value})
    }

    const changeStory = (e) => {
        setGiveInputParams({...giveInputParams, story:e.target.value})
        setFundingInputParams({...fundingInputParams, story:e.target.value})
    }

    const changeMainImgUrl = (e) => {
        const newImgFiles = [];

        // ìë°”ì—ì„œ ì“°ë˜ foreachì—ì„œ : ëŒ€ì‹ ì— ofë¥¼ ì“´ ê²ƒ
        for(const file of e.target.files) {
            const fileData = {
                id: fileId.current,
                file
            }
            fileId.current += 1;
            newImgFiles.push(fileData)      
        }

        setMainImgFiles([newImgFiles[newImgFiles.length - 1]]);
    }

    const changeSubImgUrl = (e) => {
        const newImgFiles = [];

        for(const file of e.target.files) {
            const fileData = {
                id: fileId.current,
                file
            }
            fileId.current += 1;
            newImgFiles.push(fileData)      
        }

        setSubImgFiles([newImgFiles[newImgFiles.length - 1]]);
    }


    const changeGoalTotal = (e) => {
        const parsedGoalTotal = parseInt(e.target.value, 10);

        setGiveInputParams({...giveInputParams, goalTotal: parsedGoalTotal})
        setFundingInputParams({...fundingInputParams, goalTotal: parsedGoalTotal})
    }

    const changeEndDate = (e) => {
        setGiveInputParams({...giveInputParams, endDate:e.target.value})
        setFundingInputParams({...fundingInputParams, endDate:e.target.value})
    }

    const changeBusinessStartDate = (e) => {
        setGiveInputParams({...giveInputParams, businessStartDate:e.target.value})
    }

    const changeBusinessEndDate = (e) => {
        setGiveInputParams({...giveInputParams, businessEndDate:e.target.value})
    }

    const changeTarget = (e) => {
        setGiveInputParams({...giveInputParams, target:e.target.value})
    }

    const changeTargetCount = (e) => {
        setGiveInputParams({...giveInputParams, targetCount:e.target.value})
    }

    const changeBenefitEffect = (e) => {
        setGiveInputParams({...giveInputParams, benefitEffect:e.target.value})
    }

    const changeCompanyName = (e) => {
        setGiveInputParams({...giveInputParams, companyName:e.target.value})
        setFundingInputParams({...fundingInputParams, companyName:e.target.value})
    }

    const changeCeoName = (e) => {
        setGiveInputParams({...giveInputParams, ceoName:e.target.value})
        setFundingInputParams({...fundingInputParams, ceoName:e.target.value})
    }

    const changeNickname = (e) => {
        setFundingInputParams({...fundingInputParams, nickname:e.target.value})
    }

    const changeCompanyAddress = (e) => {
        setGiveInputParams({...giveInputParams, companyAddress:e.target.value})
        setFundingInputParams({...fundingInputParams, companyAddress:e.target.value})
    }

    const changePhoneNumber = (e) => {
        setGiveInputParams({...giveInputParams, companyPhoneNumber:e.target.value})
        setFundingInputParams({...fundingInputParams, companyPhoneNumber:e.target.value})
    }

    const changeEmail = (e) => {
        setGiveInputParams({...giveInputParams, email:e.target.value})
        setFundingInputParams({...fundingInputParams, email:e.target.value})
    }

```

</br>

- ì¹´í…Œê³ ë¦¬ë¥¼ ë³€ê²½í•  ë•Œ ë§ˆë‹¤ ìƒíƒœê°’ì´ ë°”ë€Œê²Œ í€ë”©ì´ë©´ í€ë”©ê³¼ ê´€ë ¨ëœ ê²ƒë“¤, ê¸°ë¶€ë©´ ê¸°ë¶€ì™€ ê´€ë ¨ëœ ê²ƒë“¤ë¡œ ë§Œë“¤ì–´ì¤¬ë‹¤.

- ê¸°ë¶€ê¸ˆ ì‚¬ìš©ê¸ˆì•¡ ì¶”ê°€ì™€ ë¦¬ì›Œë“œ ì¶”ê°€í•˜ëŠ” ë¶€ë¶„ì—ì„œ Mapìœ¼ë¡œ ë°›ì•„ ë¦¬ìŠ¤íŠ¸ë¥¼ idë¡œ ì¶”ê°€ì™€ ì œê±°ë¥¼ í•  ìˆ˜ ìˆê³ , valueë¡œ ê°’ì„ ë°›ì„ ìˆ˜ ìˆê²Œ ë§Œë“¤ì—ˆë‹¤.

- ë‚˜ë¨¸ì§€ëŠ” input ì°½ì— ë°›ì€ ê°’ì„ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ í•´ì£¼ê³  ìˆë‹¤.

- ì´ë¯¸ì§€ íŒŒì¼ì„ ìƒˆë¡œìš´ ë°°ì—´ì— ë°›ì•„ì£¼ê³ , ì´ë¯¸ì§€ ìƒíƒœê°’ì— ë°°ì—´ì˜ ë§ˆì§€ë§‰ ê°’ë§Œ ì—…ë°ì´íŠ¸ í•˜ë„ë¡ í–ˆë‹¤.

---

</br></br>

**ìš”ì²­**

```javascript

    const giveRegisterPage = async () => {
        const formData = new FormData();
        formData.append("pageCategory", giveInputParams.pageCategory);
        formData.append("detailCategory", giveInputParams.detailCategory)
        formData.append("title", giveInputParams.title)
        formData.append("storyTitle", giveInputParams.storyTitle)
        formData.append("story", giveInputParams.story)
        mainImgFiles.forEach(imgFile => {
            formData.append("mainImgUrl", imgFile.file);
        })
        subImgFiles.forEach(imgFile => {
            formData.append("subImgUrl", imgFile.file);
        })
        formData.append("goalTotal", giveInputParams.goalTotal);
        formData.append("endDate", giveInputParams.endDate);
        formData.append("giveUsing", giveInputParams.giveUsing);
        formData.append("donationExpense", giveInputParams.donationExpense);
        formData.append("businessStartDate", giveInputParams.businessStartDate);
        formData.append("businessEndDate", giveInputParams.businessEndDate);
        formData.append("target", giveInputParams.target);
        formData.append("targetCount", giveInputParams.targetCount);
        formData.append("benefitEffect", giveInputParams.benefitEffect);
        formData.append("companyName", giveInputParams.companyName)
        formData.append("ceoName", giveInputParams.ceoName)
        formData.append("companyAddress", giveInputParams.companyAddress)
        formData.append("companyPhoneNumber", giveInputParams.companyPhoneNumber)

        const option = {
            headers: {
                "Content-Type": "multipart/form-data"
            }
        }
        try {
            await axios.post("http://localhost:8080/admin/giving/registerpage", formData, option)
            alert("ê¸°ë¶€ í˜ì´ì§€ ë“±ë¡ ì„±ê³µ");
            navigate("/giving");
        } catch (error) {
            giveFundErrorMessages({
                title: "",
                storyTitle: "",
                story: "",
                mainImgUrl: "",
                subImgUrl: "",
                endDate: "",
                giveUsing: "",
                businessStartDate: "",
                businessEndDate: "",
                target: "",
                benefitEffect: "",
                companyName: "",
                ceoName: "",
                companyAddress: "",
                companyPhoneNumber: "",
                ...error.response.data.errorData})
        }
    };

    const fundingRegisterPage = async () => {
        const formData = new FormData();
        formData.append("pageCategory", fundingInputParams.pageCategory);
        formData.append("detailCategory", fundingInputParams.detailCategory)
        formData.append("title", fundingInputParams.title)
        formData.append("storyTitle", fundingInputParams.storyTitle)
        formData.append("story", fundingInputParams.story)
        mainImgFiles.forEach(imgFile => {
            formData.append("mainImgUrl", imgFile.file);
        })
        subImgFiles.forEach(imgFile => {
            formData.append("subImgUrl", imgFile.file);
        })
        formData.append("goalTotal", fundingInputParams.goalTotal);
        formData.append("endDate", fundingInputParams.endDate);
        formData.append("rewardName", fundingInputParams.rewardName)
        formData.append("rewardPrice", fundingInputParams.rewardPrice)
        formData.append("companyName", fundingInputParams.companyName)
        formData.append("ceoName", fundingInputParams.ceoName)
        formData.append("nickname", fundingInputParams.nickname)
        formData.append("companyAddress", fundingInputParams.companyAddress)
        formData.append("companyPhoneNumber", fundingInputParams.companyPhoneNumber)
        formData.append("email", fundingInputParams.email)
        const option = {
            headers: {
                "Content-Type": "multipart/form-data",
                Authorization: `Bearer ${accessToken}`
            }
        }
        try {
            await axios.post("http://localhost:8080/admin/funding/registerpage", formData, option);
            alert("í€ë”© í˜ì´ì§€ ë“±ë¡ ì„±ê³µ");
            navigate("/funding");
        } catch (error) {
            setFundErrorMessages({
                title: "",
                storyTitle: "",
                story: "",
                mainImgUrl: "",
                subImgUrl: "",
                endDate: "",
                rewardName: "",
                companyName: "",
                ceoName: "",
                nickname: "",
                companyAddress: "",
                companyPhoneNumber: "",
                email:""
                , ...error.response.data.errorData})
        }
    };

```

</br>

- ì§€ê¸ˆê» jsonìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ì™”ì§€ë§Œ ì´ë¯¸ì§€ê°€ ë“¤ì–´ê°„ ê°’ë“¤ì„ ìš”ì²­ì„ ë³´ë‚´ë ¤ë©´ formdataë¡œ ë°›ì•„ì„œ ë³´ë‚´ì•¼ í•œë‹¤. ê·¸ë˜ì„œ FormDataë¥¼ ìƒì„±í•˜ê³  ê°’ì„ ë°›ì•„ì¤€ í›„ Content-Typeì— form-dataë¥¼ ë„£ì–´ì£¼ê²Œ í–ˆë‹¤.

- ê´€ë¦¬ìë§Œ ë“±ë¡ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ì„œë²„ë¡œ ìš”ì²­ì´ ë“¤ì–´ê°€ë©´ì„œ í† í°ìœ¼ë¡œ ì¸ì¦ ë‹¨ê³„ë¥¼ ê±°ì¹˜ê²Œ ëœë‹¤.

---

</br></br>

## BackEnd

**Controller**

- ê¸°ë¶€

```java

@RestController
@RequiredArgsConstructor
public class GiveRegisterController {

	private final GiveRegsterPageService giveRegsterPageService;
	
	@ValidAspect
	@PostMapping("/admin/giving/registerpage")
	public ResponseEntity<?> registerPage(@Valid GivingRegisterReqDto givingRegisterReqDto, BindingResult bindingResult) {
		giveRegsterPageService.giveRegisterPage(givingRegisterReqDto);
		return ResponseEntity.ok().body(true);
	}
	
}

```

</br>

- í€ë”©

```java

@RestController
@RequiredArgsConstructor
public class FundingRegisterController {

	private final FundingRegisterPageService fundingRegisterPageService;

	@ValidAspect
	@PostMapping("/admin/funding/registerpage")
	public ResponseEntity<?> registerPage(@Valid FundingRegisterPageReqDto registerPageReqDto, BindingResult bindingResult) {
		fundingRegisterPageService.registerPage(registerPageReqDto);
		return ResponseEntity.ok().body(true);
	}

}

```

</br>

- ìš”ì²­ì— ëŒ€í•œ ì¸ì¦ì´ ëë‚˜ê³  ë°ì´í„°ë¥¼ Serviceë¡œ ë„˜ê¸´ë‹¤.

---

</br></br>

**Service**

- ê¸°ë¶€

```java

@Service
@RequiredArgsConstructor
public class GiveRegsterPageService {
	
	private final GiveRegisterPageRepository giveRegisterPageRepository;
	private Center centerEntity;
	private GiveRegisterPage giveRegisterPageEntity;
	
	@Value("${file.path}")
	private String filePath;
	
	public int giveRegisterPage (GivingRegisterReqDto givingRegisterReqDto) {
		centerEntity = givingRegisterReqDto.toCenterEntity();
		giveRegisterPageRepository.toSaveCenter(centerEntity);
		
		giveRegisterPageEntity = givingRegisterReqDto.toGiveRegisterEntity(filePath);
		giveRegisterPageEntity.setCenterId(centerEntity.getCenterId());
		giveRegisterPageRepository.toSaveGiveRegisterPage(giveRegisterPageEntity);
		
		TargetBenefit targetBenefitEntity = givingRegisterReqDto.toTargetBenefitEntity();
		targetBenefitEntity.setGivingPageId(giveRegisterPageEntity.getGivingPageId());
		giveRegisterPageRepository.toSaveTarget(targetBenefitEntity);
		
		List<DonationUsePlan> donationEntity = givingRegisterReqDto.toDonationUsePlanEntity();
		donationEntity.forEach(donation -> {
			giveRegisterPageRepository.toSaveDonation(
			DonationUsePlan.builder()
			.pageCategory(donation.getPageCategory())
			.giveUsing(donation.getGiveUsing())
			.donationExpense(donation.getDonationExpense())
			.givingPageId(giveRegisterPageEntity.getGivingPageId())
			.build());
		});
		
		GivingSubImg givingSubImgEntity = givingRegisterReqDto.togivingSubImgEntity(filePath);
		givingSubImgEntity.setGivingPageId(giveRegisterPageEntity.getGivingPageId());
		return giveRegisterPageRepository.toSaveGivingSubImg(givingSubImgEntity);
	}

}

```

</br>

- í€ë”©

```java

@Service
@RequiredArgsConstructor
public class FundingRegisterPageService {

	private final FundingRegisterPageRepository registerPageRepository;
	private FundingRegisterPage fundingRegisterEntity;
	
	@Value("${file.path}")
	private String filePath;
	
	
	public int registerPage(FundingRegisterPageReqDto registerPageReqDto) {
		fundingRegisterEntity = registerPageReqDto.toRegisterEntity(filePath);
		registerPageRepository.toSaveRegisterPage(fundingRegisterEntity);
		
		BusinessInfo businessInfoEntity = registerPageReqDto.toBusinessEntity();
		businessInfoEntity.setFundingId(fundingRegisterEntity.getFundingId());
		registerPageRepository.toSaveBusinessInfo(businessInfoEntity);
		
		List<Reward> rewardEntity = registerPageReqDto.toRewardEntity();
		rewardEntity.forEach(reward -> {
			registerPageRepository.toSaveReward(
					Reward.builder()
					.pageCategory(reward.getPageCategory())
					.rewardName(reward.getRewardName())
					.rewardPrice(reward.getRewardPrice())
					.fundingId(fundingRegisterEntity.getFundingId())
					.build());
		});
		
		FundingSubImg fundingSubImgEntity = registerPageReqDto.toFundingSubImgEntity(filePath);
		fundingSubImgEntity.setFundingId(fundingRegisterEntity.getFundingId());
		return registerPageRepository.toSaveFundingSubImg(fundingSubImgEntity);
	}
}

```

</br>

- Dtoì—ì„œ Entityë¡œ ë°”ê¾¸ëŠ” ê°’ì„ ë°›ì•„ Repositoryë¡œ ë°ì´í„°ë¥¼ ë³´ë‚¸ë‹¤.

---

</br></br>

**íŒŒì¼ ê²½ë¡œ ì„¤ì •**

- application.yml

```html

spring:
  servlet:
    multipart:
      max-file-size: 100MB
      max-request-size: 100MB

file:
  path: C:\aws_project\workspace\CrowdFunding-portfolio\Backend\crowdfunding\upload\

```

</br>

- ê²½ë¡œ ì ‘ê·¼ ì„¤ì •

```java

@Configuration
public class WebMvcConfig implements WebMvcConfigurer{

	@Override
	public void addResourceHandlers(ResourceHandlerRegistry registry) {
		WebMvcConfigurer.super.addResourceHandlers(registry);
		registry.addResourceHandler("/image/**")
				.addResourceLocations("file:///" + filePath)
				.resourceChain(true)
				.addResolver(new PathResourceResolver() {
					@Override
					protected Resource getResource(String resourcePath, Resource location) throws IOException {
						resourcePath = URLDecoder.decode(resourcePath, StandardCharsets.UTF_8);
						return super.getResource(resourcePath, location);
					}
				});
	}
}

```

</br>

- ì—…ë¡œë“œí•  ìˆ˜ ìˆëŠ” íŒŒì¼ì˜ í¬ê¸°ë¥¼ ìµœëŒ€ 100MBë¡œ ì„¤ì •ì„ í•œë‹¤. ì´ ê°’ì„ ì´ˆê³¼í•  ê²½ìš° ìš”ì²­ì´ ê±°ë¶€ê°€ ëœë‹¤.

- ì—…ë¡œë“œí•  íŒŒì¼ ê²½ë¡œë¥¼ ì„¤ì •ì„ í•˜ëŠ”ë°, ìš°ë¦¬ëŠ” upload í´ë” ì•ˆì— íŒŒì¼ì„ ì—…ë¡œë“œë¥¼ í•  ê²ƒì´ë‹¤.

- ì™¸ë¶€ì—ì„œ ì´ë¯¸ì§€ ê²½ë¡œì— ì§ì ‘ì ìœ¼ ì ‘ê·¼ì„ ëª»í•˜ë„ë¡ file:/// ~~ ë¼ëŠ” ì‹¤ì œ ê²½ë¡œë¥¼ /image/**ë¡œ ë°”ê¿”ì¤¬ë‹¤. ê·¸ë˜ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ htmlì— imageë¥¼ ë°›ì„ ë•Œ

```html

<img css={img} src={`http://localhost:8080/image/main/${funding.mainImgUrl}`} />

```

ì´ëŸ° ì‹ìœ¼ë¡œ í•´ì¤€ ê²ƒì´ë‹¤. funding.mainImgUrlì˜ ê°’ìœ¼ë¡œëŠ” ì•„ë˜ì—ì„œ ì„¤ì •í•´ì¤€ tempFileNameì´ ë“¤ì–´ê°€ìˆë‹¤.

---

</br></br>

**Dto**

- ê¸°ë¶€

```java

	public GiveRegisterPage toGiveRegisterEntity(String filePath) {
		MultipartFile file = mainImgUrl;
		if(file == null) {
			return null;
		}
		String originFileName = file.getOriginalFilename();
		String extension = originFileName.substring(originFileName.lastIndexOf("."));
		String tempFileName = UUID.randomUUID().toString().replaceAll("-", "") + extension;
		Path uploadPath = Paths.get(filePath + "main/" + tempFileName);	// ê²½ë¡œ/post/UUID.jpg
	
		File f = new File(filePath + "main");
		if(!f.exists()) {
			f.mkdirs();
		}
		
		try {
			Files.write(uploadPath, file.getBytes());
		} catch (IOException e) {
			e.printStackTrace();
		}
		return GiveRegisterPage.builder()
				.pageCategory(pageCategory)
				.detailCategory(detailCategory)
				.title(title)
				.storyTitle(storyTitle)
				.story(story)
				.goalTotal(goalTotal)
				.mainImgUrl(tempFileName)
				.endDate(endDate)
				.build();
	}
	
	public GivingSubImg togivingSubImgEntity(String filePath) {
		MultipartFile file = subImgUrl;
		if(file == null) {
			return null;
		}
		String originFileName = file.getOriginalFilename();
		String extension = originFileName.substring(originFileName.lastIndexOf("."));
		String tempFileName = UUID.randomUUID().toString().replaceAll("-", "") + extension;
		Path uploadPath = Paths.get(filePath + "sub/" + tempFileName);	// ê²½ë¡œ/post/UUID.jpg
		File f = new File(filePath + "sub");
		if(!f.exists()) {
			f.mkdirs();
		}
		
		try {
			Files.write(uploadPath, file.getBytes());
		} catch (IOException e) {
			e.printStackTrace();
		}
		return GivingSubImg.builder()
				.subImgUrl(tempFileName)
				.pageCategory(pageCategory)
				.build();
	}
	
	public Center toCenterEntity() {
		return Center.builder()
				.pageCategory(pageCategory)
				.centerName(companyName)
				.centerAddress(companyAddress)
				.centerPhoneNumber(companyPhoneNumber)
				.centerCeo(ceoName)
				.build();
	}
	
	public TargetBenefit toTargetBenefitEntity() {
		return TargetBenefit.builder()
				.pageCategory(pageCategory)
				.target(target)
				.targetCount(targetCount)
				.benefitEffect(benefitEffect)
				.businessStartDate(businessStartDate)
				.businessEndDate(businessEndDate)
				.build();
	}
	
	public List<DonationUsePlan> toDonationUsePlanEntity() {
	    List<DonationUsePlan> donationUsePlans = new ArrayList<>();
	    int size = Math.min(giveUsing.size(), donationExpense.size());
	    for (int i = 0; i < size; i++) {
	        String give = giveUsing.get(i);
	        int donation = donationExpense.get(i);
	        DonationUsePlan donationPlan = DonationUsePlan.builder()
	        		.pageCategory(pageCategory)
	        		.giveUsing(give)
	        		.donationExpense(donation)
	        		.build();
	        donationUsePlans.add(donationPlan);
	    }
	    return donationUsePlans;
	}

```

</br>

- í€ë”©

```java

	public FundingRegisterPage toRegisterEntity(String filePath) {
		MultipartFile file = mainImgUrl;
		if(file == null) {
			return null;
		}
		String originFileName = file.getOriginalFilename();
		String extension = originFileName.substring(originFileName.lastIndexOf("."));
		String tempFileName = UUID.randomUUID().toString().replaceAll("-", "") + extension;
		Path uploadPath = Paths.get(filePath + "main/" + tempFileName);	// ê²½ë¡œ/post/UUID.jpg
		System.out.println("filePath: " + filePath);
		File f = new File(filePath + "main");
		if(!f.exists()) {
			f.mkdirs();
		}
		
		try {
			Files.write(uploadPath, file.getBytes());
		} catch (IOException e) {
			e.printStackTrace();
		}
		
		return FundingRegisterPage.builder()
				.pageCategory(pageCategory)
				.detailCategory(detailCategory)
				.title(title)
				.storyTitle(storyTitle)
				.story(story)
				.goalTotal(goalTotal)
				.mainImgUrl(tempFileName)
				.endDate(endDate)
				.nickname(nickname)
				.build();
	}
	
	public BusinessInfo toBusinessEntity() {
		return BusinessInfo.builder()
				.pageCategory(pageCategory)
				.companyName(companyName)
				.ceoName(ceoName)
				.companyAddress(companyAddress)
				.companyPhoneNumber(companyPhoneNumber)
				.ceoEmail(email)
				.build();
	}
	

	public List<Reward> toRewardEntity() {
	    List<Reward> rewards = new ArrayList<>();
	    int size = Math.min(rewardName.size(), rewardPrice.size()); // ë‘ ë¦¬ìŠ¤íŠ¸ ì¤‘ ì‘ì€ í¬ê¸°ë¥¼ ì„ íƒ

	    for (int i = 0; i < size; i++) {
	        String name = rewardName.get(i);
	        int price = rewardPrice.get(i);
	        Reward reward = Reward.builder()
	            .pageCategory(pageCategory)
	            .rewardName(name)
	            .rewardPrice(price)
	            .build();
	        rewards.add(reward);
	    }

	    return rewards;
	}
	
	public FundingSubImg toFundingSubImgEntity(String filePath) {
		MultipartFile file = subImgUrl;
		if(file == null) {
			return null;
		}
		String originFileName = file.getOriginalFilename();
		String extension = originFileName.substring(originFileName.lastIndexOf("."));
		String tempFileName = UUID.randomUUID().toString().replaceAll("-", "") + extension;
		Path uploadPath = Paths.get(filePath + "sub/" + tempFileName);	// ê²½ë¡œ/post/UUID.jpg
		File f = new File(filePath + "sub");
		if(!f.exists()) {
			f.mkdirs();
		}
		
		try {
			Files.write(uploadPath, file.getBytes());
		} catch (IOException e) {
			e.printStackTrace();
		}
		return FundingSubImg.builder()
				.subImgUrl(tempFileName)
				.pageCategory(pageCategory)
				.build();
	}
	

```

</br>

- íŒŒì¼ì´ ì—†ëŠ” ê²½ìš° nullì„ ë°˜í™˜í•œë‹¤.

- ì—…ë¡œë“œëœ íŒŒì¼ì˜ ì›ë³¸ íŒŒì¼ ì´ë¦„ê³¼ í™•ì¥ìë¥¼ ì¶”ì¶œí•œë‹¤. í™•ì¥ìëŠ” íŒŒì¼ ì´ë¦„ì—ì„œ ë§ˆì§€ë§‰ . ì´í›„ì˜ ë¬¸ìì—´ë¡œ ì¶”ì¶œëœë‹¤.

- ì„ì‹œ íŒŒì¼ ì´ë¦„ì„ ìƒì„±í•˜ê¸° ìœ„í•´ UUIDë¥¼ ì‚¬ìš©í•œë‹¤. UUIDëŠ” ëœë¤í•œ í‚¤ê°’ì„ ìƒì„±í•˜ëŠ”ë° ì‚¬ìš©ë˜ë©°, ì´ê²ƒì´ íŒŒì¼ ì´ë¦„ì— í¬í•¨ëœë‹¤. ë¬¸ìì—´ë§Œ ì‚¬ìš©í•  ê²ƒì´ê¸°ì— UUID ì•ˆì— í¬í•¨ë˜ì–´ìˆëŠ” "-"ë¥¼ ì œê±°í•´ì¤€ë‹¤.

- uploadPathëŠ” ì—…ë¡œë“œëœ íŒŒì¼ì„ ì €ì¥í•  ê²½ë¡œë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. filePath ë³€ìˆ˜ì™€ ìœ„ì—ì„œ ë§Œë“¤ì–´ì¤€ ì„ì‹œ íŒŒì¼ ì´ë¦„ì„ ê²°í•©í•˜ì—¬ ë§Œë“¤ì–´ì¤€ë‹¤.

- íŒŒì¼ì„ ì €ì¥í•  ë””ë ‰í† ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš°, í•´ë‹¹ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•œë‹¤.

- Files.write(uploadPath, file.getBytes())ëŠ” ì‹¤ì œë¡œ íŒŒì¼ì„ ì €ì¥í•˜ëŠ” ë¶€ë¶„. uploadPathì— ì—…ë¡œë“œëœ íŒŒì¼ì˜ byteë¥¼ ì‚¬ìš©í•œë‹¤.

- ë°ì´í„°ë² ì´ìŠ¤ì—ëŠ” íŒŒì¼ ì´ë¦„ë§Œ ì¡´ì¬í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— tempFileNameë§Œ ë³´ë‚´ëŠ” ê²ƒ.

- ë‚˜ë¨¸ì§€ëŠ” ë˜‘ê°™ì´ Builderë¥¼ ì‚¬ìš©í•˜ì—¬ ê°’ì„ Entityì— ë„£ì–´ì£¼ê³  ìˆë‹¤.

---

</br></br>

**Repository**

- ê¸°ë¶€

```java

@Mapper
public interface GiveRegisterPageRepository {
	public int toSaveCenter(Center center);
	public int toSaveGiveRegisterPage(GiveRegisterPage giveRegisterPage);
	public int toSaveDonation(DonationUsePlan donationUsePlan);
	public int toSaveTarget(TargetBenefit targetBenefit);
	public int toSaveGivingSubImg(GivingSubImg givingSubImg);
}

```

</br>

- í€ë”©

```java

@Mapper
public interface FundingRegisterPageRepository {
	public int toSaveRegisterPage(FundingRegisterPage registerPage);
	public int registerPostsImgs(List<PostsImg> postsImgs);
	public int toSaveBusinessInfo(BusinessInfo businessInfo);
	public int toSaveReward(Reward reward);
	public int toSaveFundingSubImg(FundingSubImg fundingSubImg);
}

```

</br>

- Entityë¥¼ insert í•˜ê¸° ìœ„í•´ ë‘˜ ë‹¤ ë˜‘ê°™ì´ ë³´ë‚´ê³  ìˆë‹¤. ì„±ê³µ ê±´ìˆ˜ë¡œ int ê°’ì„ ë°˜í™˜.

--- 

**Sql**

- ê¸°ë¶€

```sql

	<insert id="toSaveCenter"
		parameterType="com.webproject.crowdfunding.entity.Center"
		useGeneratedKeys="true"
		keyProperty="centerId">
		<if test="pageCategory == 'ê¸°ë¶€'">
			insert into center_tb
			values
			(0, #{centerName}, #{centerAddress}, #{centerPhoneNumber}, #{centerCeo})
		</if>
	</insert>
	
	<insert id="toSaveGiveRegisterPage"
		parameterType="com.webproject.crowdfunding.entity.GiveRegisterPage"
		useGeneratedKeys="true"
		keyProperty="givingPageId">
				
	<if test="pageCategory == 'ê¸°ë¶€' &amp;&amp; detailCategory == 'ì•„ë™'">
			insert into giving_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{centerId}, #{mainImgUrl}, 1)
	</if>
	<if test="pageCategory == 'ê¸°ë¶€' &amp;&amp; detailCategory == 'ë…¸ì¸'">
			insert into giving_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{centerId}, #{mainImgUrl}, 2)
	</if>
	<if test="pageCategory == 'ê¸°ë¶€' &amp;&amp; detailCategory == 'ì¥ì• ì¸'">
			insert into giving_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{centerId}, #{mainImgUrl}, 3)
	</if>
	<if test="pageCategory == 'ê¸°ë¶€' &amp;&amp; detailCategory == 'ë‹¤ë¬¸í™”'">
			insert into giving_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{centerId}, #{mainImgUrl}, 4)
	</if>
	<if test="pageCategory == 'ê¸°ë¶€' &amp;&amp; detailCategory == 'í™˜ê²½'">
			insert into giving_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{centerId}, #{mainImgUrl}, 5)
	</if>
	</insert>
	  
	<insert id="toSaveTarget"
		parameterType="com.webproject.crowdfunding.entity.TargetBenefit"
		useGeneratedKeys="true"
		keyProperty="tbId">
		<if test="pageCategory == 'ê¸°ë¶€'">
			insert into target_benefit_tb
			values
			(0, #{target}, #{targetCount}, #{benefitEffect}, #{businessStartDate}, #{businessEndDate}, #{givingPageId})
		</if>
	</insert>
	
	<insert id="toSaveDonation"
		parameterType="com.webproject.crowdfunding.entity.DonationUsePlan"
		useGeneratedKeys="true"
		keyProperty="dupId">
		<if test="pageCategory == 'ê¸°ë¶€'">
			insert into donation_use_plan_tb
			values
			(0, #{giveUsing}, #{donationExpense}, #{givingPageId})
		</if>
	</insert>
	
	<insert id="toSaveGivingSubImg"
		parameterType="com.webproject.crowdfunding.entity.GivingSubImg"
		useGeneratedKeys="true"
		keyProperty="gpsiId">
		<if test="pageCategory == 'ê¸°ë¶€'">
			insert into giving_page_sub_img_tb
			values
			(0, #{givingPageId}, #{subImgUrl})
		</if>	
	</insert>

```

</br>

- í€ë”©

```sql

	<insert id="toSaveRegisterPage"
		parameterType="com.webproject.crowdfunding.entity.FundingRegisterPage"
		useGeneratedKeys="true"
		keyProperty="fundingId">
				
	<if test="pageCategory == 'í€ë”©' &amp;&amp; detailCategory == 'ìŒì‹'">
			insert into funding_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{mainImgUrl}, 1, #{nickname})
	</if>
	<if test="pageCategory == 'í€ë”©' &amp;&amp; detailCategory == 'ë„ì„œ'">
			insert into funding_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{mainImgUrl}, 2, #{nickname})
	</if>
	<if test="pageCategory == 'í€ë”©' &amp;&amp; detailCategory == 'ì˜ë¥˜'">
			insert into funding_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{mainImgUrl}, 3, #{nickname})
	</if>
	<if test="pageCategory == 'í€ë”©' &amp;&amp; detailCategory == 'ì•¡ì„¸ì„œë¦¬&amp;í™”ì¥í’ˆ'">
			insert into funding_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{mainImgUrl}, 4, #{nickname})
	</if>
	<if test="pageCategory == 'í€ë”©' &amp;&amp; detailCategory == 'ê½ƒ&amp;ê³¼ì¼'">
			insert into funding_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{mainImgUrl}, 5, #{nickname})
	</if>
	<if test="pageCategory == 'í€ë”©' &amp;&amp; detailCategory == 'ìƒí™œìš©í’ˆ'">
			insert into funding_page_tb
			values
			(0, #{title}, NOW(), #{endDate},  #{goalTotal}, #{storyTitle}, #{story}, #{mainImgUrl}, 6, #{nickname})
	</if>
	</insert>
	
	<insert id="toSaveBusinessInfo"
		parameterType="com.webproject.crowdfunding.entity.BusinessInfo"
		useGeneratedKeys="true"
		keyProperty="businessInfoId">
		<if test="pageCategory == 'í€ë”©'">
			insert into business_info_tb
			values
			(0, #{companyName}, #{ceoName}, #{companyAddress}, #{companyPhoneNumber}, #{ceoEmail}, #{fundingId})
		</if>
	</insert>
	
	<insert id="toSaveReward"
		parameterType="com.webproject.crowdfunding.entity.Reward"
		useGeneratedKeys="true"
		keyProperty="rewardId">
		<if test="pageCategory == 'í€ë”©'">
			insert into reward_tb
			values
			(0, #{rewardName}, #{rewardPrice}, #{fundingId})
		</if>
	</insert>
	
	<insert id="toSaveFundingSubImg"
		parameterType="com.webproject.crowdfunding.entity.FundingSubImg"
		useGeneratedKeys="true"
		keyProperty="fpsiId">
		<if test="pageCategory == 'í€ë”©'">
			insert into funding_page_sub_img_tb
			values
			(0, #{fundingId}, #{subImgUrl})
		</if>
	</insert>

```

</br>

- ê¸°ë¶€ëŠ” ìˆœì„œëŒ€ë¡œ ì‚¬ì—…ì ì •ë³´, ê¸°ë¶€ ê´€ë ¨ ì •ë³´, ì‚¬ì—…ëŒ€ìƒíš¨ê³¼ ë° ê¸°ëŒ€íš¨ê³¼, ê¸°ë¶€ê¸ˆ ì‚¬ìš© ê³„íš, ìƒì„¸ í˜ì´ì§€ì— ì“¸ ì„œë¸Œ ì´ë¯¸ì§€ë¡œ insertë¥¼ í•˜ê³  ìˆë‹¤.

- í€ë”©ì€ ìˆœì„œëŒ€ë¡œ í€ë”© ê´€ë ¨ ì •ë³´, ì‚¬ì—…ì ì •ë³´, ë¦¬ì›Œë“œ ì •ë³´, ìƒì„¸ í˜ì´ì§€ì— ì“¸ ì„œë¸Œ ì´ë¯¸ì§€ë¡œ insertë¥¼ í•˜ê³  ìˆë‹¤.

---

</br></br>

**Database**

- ê¸°ë¶€ ì •ë³´ ë“±ë¡

![ê¸°ë¶€ ì •ë³´ ë“±ë¡](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/c093f6a7-0350-4cdf-844f-347bb4d1062b)

</br>

- ê¸°ë¶€ ì‚¬ì—…ì ë“±ë¡

![ê¸°ë¶€ ì‚¬ì—…ì ì •ë³´ ë“±ë¡](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/d205d248-d256-48c5-9c07-048c8131aea8)

</br>

- ê¸°ë¶€ ì‚¬ì—… ê³„íš ë“±ë¡

![ê¸°ë¶€ ì‚¬ì—… ê³„íš ë“±ë¡](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/453dd35f-eca7-4b45-911c-9bc9d38416fc)

</br>

- ê¸°ë¶€ ìƒì„¸ ì´ë¯¸ì§€ ë“±ë¡

![ê¸°ë¶€ ìƒì„¸ ì´ë¯¸ì§€ ë“±ë¡](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/353d3926-723f-4f2f-8165-98c172a7d65e)

</br>

- ê¸°ë¶€ê¸ˆ ì‚¬ìš© ê³„íš ë“±ë¡

![ê¸°ë¶€ê¸ˆ ì‚¬ìš© ê³„íš ë“±ë¡](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/f4d8ca92-0023-49f7-9d1a-703202ee726e)

</br>

---

- í€ë”© ì •ë³´ ë“±ë¡

![í€ë”© ì •ë³´ ë“±ë¡](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/fdb1d0fb-cab4-49d4-aaa0-60dd79896593)

</br>

- í€ë”© ë¦¬ì›Œë“œ ë“±ë¡

![í€ë”© ë¦¬ì›Œë“œ ë“±ë¡](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/a647d428-f1e6-4b43-9533-e7e89844abbe)

</br>

- í€ë”© ì‚¬ì—…ì ì •ë³´ ë“±ë¡

![í€ë”© ì‚¬ì—…ì ì •ë³´ ë“±ë¡](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/e3311a73-6ba8-4670-ad38-177f8e057941)

</br>

- í€ë”© ìƒì„¸ ì´ë¯¸ì§€ ë“±ë¡

![í€ë”© ìƒì„¸ ì´ë¯¸ì§€ ë“±ë¡](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/733d00df-c950-4a92-8545-8e510a3d88f6)

</br>

- ì´ë ‡ê²Œ ë°ì´í„°ë² ì´ìŠ¤ì— ë°ì´í„°ê°€ ì˜ ë“¤ì–´ê°„ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

---

</div>
</details>

</br>

### **ê´€ë¦¬ì í€ë”© ë° ê¸°ë¶€ ìˆ˜ì • í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°**

<details>
<summary>ê¸°ë¶€ ìˆ˜ì •</summary>
<div markdown="1">

![ê¸°ë¶€ ìˆ˜ì • - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/65ce4d46-6748-4936-bcba-4bd0ca3d5a26)

</div>
</details>

<details>
<summary>í€ë”© ìˆ˜ì •</summary>
<div markdown="1">
  
![í€ë”© ìˆ˜ì • - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/5c1ae2c5-038e-49be-8fbc-611f014ca421)

</div>
</details>

<details>
<summary>ê¸°ë¶€ & í€ë”© ìˆ˜ì • ì½”ë“œ ë¦¬ë·°</summary>
<div markdown="1">
  
## FrontEnd

- ê¸°ë¶€

```html

        {role ?
                <div css={adminContainer}>
                    <button css={givingModifyButton} onClick={adminModifyHandleSubmit}>ê¸°ë¶€ ìˆ˜ì •</button>
                    {modifyOpen ?
                        <div css={givingModifyContainer}>
                            <div css={givingIdentifyContainer}>
                                <div css={givingIdentifyMain}>
                                    <div css={givingModifyTitle}>ê¸°ë¶€ ìˆ˜ì •</div>
                                    <div css={modifyGivingHeader}>
                                        <div css={modifyContainer}>
                                            <div css={modifyTitleTxt}>ì œëª© ìˆ˜ì •</div>
                                            <input css={modifyValue} defaultValue={givingDetail.data.data.pageTitle} onChange={modifyHandle} name="givingName"/>
                                        </div>
                                        <div css={modifyContainer}>
                                            <div css={modifyTitleTxt}>ì¢…ë£Œì¼ ìˆ˜ì •</div>
                                            <input css={modifyValue} onChange={modifyHandle} name="endDate"/>
                                        </div>
                                        <div css={modifyContainer}>
                                            <div css={modifyTitleTxt}>ëª©í‘œ ê¸ˆì•¡ ìˆ˜ì •</div>
                                            <input css={modifyValue} onChange={modifyHandle} name="goalTotal"/>
                                        </div>
                                    </div>
                                    <div css={modifyIdentifyButtonContainer}>
                                        <button css={modifyIdentifyButton} onClick={modifyIdentifyHandleSubmit}>í™•ì¸</button>
                                        <button css={modifyCancelButton} onClick={modifyCancelHandleSubmit}>ì·¨ì†Œ</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    : ""}
			: ""}

```

</br>

- í€ë”©

```html

            {role ?
                <div css={adminContainer}>
                    <button css={fundingModifyButton} onClick={adminModifyHandleSubmit}>í€ë”© ìˆ˜ì •</button>
                    {modifyOpen ?
                        <div css={joinFundContainer}>
                            <div css={joinFundIdentifyContainer}>
                                <div css={joinFundIdentifyMain}>
                                    <div css={FundingModifyTitle}>í€ë”© ìˆ˜ì •</div>
                                    <div css={joinFundHeader}>
                                        <div css={modifyContainer}>
                                            <div css={modifyTitleTxt}>ì œëª© ìˆ˜ì •</div>
                                            <input css={modifyValue} defaultValue={funding.fundingTitle} onChange={modifyHandle} name="fundingName"/>
                                        </div>
                                        <div css={modifyContainer}>
                                            <div css={modifyTitleTxt}>ì¢…ë£Œì¼ ìˆ˜ì •</div>
                                            <input css={modifyValue} onChange={modifyHandle} name="endDate"/>
                                        </div>
                                        <div css={modifyContainer}>
                                            <div css={modifyTitleTxt}>ëª©í‘œ ê¸ˆì•¡ ìˆ˜ì •</div>
                                            <input css={modifyValue} onChange={modifyHandle} name="goalTotal"/>
                                        </div>
                                    </div>
                                    <div css={joinIdentifyButtonContainer}>
                                        <button css={joinIdentifyButton} onClick={modifyIdentifyHandleSubmit}>í™•ì¸</button>
                                        <button css={joinCancelButton} onClick={modifyCancelHandleSubmit}>ì·¨ì†Œ</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    : ""}
			: ""}

```

</br>

- roleì€ ìœ„ ìƒì„¸í˜ì´ì§€ ì½”ë“œì—ì„œ ìœ ì € ì •ë³´ë¥¼ ë“¤ê³ ì˜¬ ë•Œ ë°ì´í„°ê°€ ROLE_ADMINì´ë©´ roleì´ trueê°€ ë˜ê³ , ë‚˜ë¨¸ì§€ëŠ” falseê°€ ëœë‹¤. ê·¸ë˜ì„œ ì›¹ ìƒì„¸í˜ì´ì§€ ìƒë‹¨ì— ê´€ë¦¬ì ê³„ì •ë§Œ ë³´ì´ê²Œë” ê¸°ë¶€ & í€ë”©ì— ìˆ˜ì •ê³¼ ì‚­ì œë¥¼ ë„£ì—ˆë‹¤.

- ì´ì œ roleì´ trueë©´ ìœ„ì™€ ê°™ì€ ë‚´ìš©ì„ ì…ë ¥ ë°›ì•„ì„œ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤. 

---

</br></br>

**ì…ë ¥ ë°›ì€ ê°’ ì²˜ë¦¬**

- ê¸°ë¶€

```javascript

    const modifyHandle = (e) => {
        const {name, value} = e.target
        setModify({...modify, [name]: value})
    }

```

</br>

```javascript

    const modifyHandle = (e) => {
        const {name, value} = e.target
        setModify({...modify, [name]: value})
    }

```

</br>

- ë³„ í–‰ë™ ì—†ì´ ì…ë ¥ ë°›ì€ ê°’ì„ ìƒíƒœ ì—…ë°ì´íŠ¸í•´ì¤€ë‹¤.

---

</br></br>

**ìš”ì²­**

- ê¸°ë¶€

```javascript

    const modifyInfo = useMutation(async () => {
        const data = {
            ...modify
        }

        const option = {
            headers: {
                Authorization: `Bearer ${accessToken}`
            }
        }
        return await axios.put("http://localhost:8080/admin/giving/modify", data, option)
    }, {
        enabled: refresh,

        onSuccess: () => {
            alert("ê¸°ë¶€ ë‚´ìš©ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì • ë˜ì—ˆìŠµë‹ˆë‹¤.");
            setRefresh(false);
            setModifyOpen(false);
        }
    })

```

</br>

- í€ë”©

```javascript

    const modifyInfo = useMutation(async () => {
        const data = {
            ...modify
        }

        const option = {
            headers: {
                Authorization: `Bearer ${accessToken}`
            }
        }
        return await axios.put("http://localhost:8080/admin/funding/modify", data, option)
    }, {
        enabled: refresh,

        onSuccess: () => {
            alert("í€ë”© ë‚´ìš©ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì • ë˜ì—ˆìŠµë‹ˆë‹¤.");
            setRefresh(false)
            setModifyOpen(false);
        }
    })

```

</br>

- ì—…ë°ì´íŠ¸ëœ ìƒíƒœê°’ë“¤ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë„£ê¸° ìœ„í•´ ìš”ì²­ì„ ë³´ë‚´ê³  ìˆë‹¤.

- ìˆ˜ì •ì´ê¸° ë•Œë¬¸ì— put ìš”ì²­ ì‚¬ìš©.

---

</br></br>

## BackEnd

**Controller**

```java

@RestController
@RequestMapping("/admin")
@RequiredArgsConstructor
public class AdminController {
	
	private final AdminService adminService;

	@PutMapping("/giving/modify")
	public ResponseEntity<?> givingModifyInfo(@RequestBody GivingModifyReqDto givingModifyReqDto) {
		return ResponseEntity.ok(adminService.givingModify(givingModifyReqDto));
	}

	@PutMapping("/funding/modify")
	public ResponseEntity<?> toFundingModify(@RequestBody FundingModifyReqDto fundingModifyReqDto) {
		return ResponseEntity.ok(adminService.fundingModify(fundingModifyReqDto));
	}

}

```

</br>

- ìš”ì²­ìœ¼ë¡œ ë°›ì€ ê°’ë“¤ì„ Serviceë¡œ ë³´ë‚´ê³  ë°˜í™˜í•˜ê³  ìˆë‹¤.

- put ìš”ì²­ì´ ì™”ê¸° ë•Œë¬¸ì— PutMapping ì‚¬ìš©.

---

</br></br>

**Dto**

- ê¸°ë¶€

```java

@Data
public class GivingModifyReqDto {
	private int givingPageId;
	private String givingName;
	private LocalDate endDate;
	private int goalTotal;
	
	public Giving givingModifyToEntity() {
		return Giving.builder()
				.pageId(givingPageId)
				.pageTitle(givingName)
				.endDate(endDate)
				.goalTotal(goalTotal)
				.build();
	}
}

```

</br>

- í€ë”©

```java

@Data
public class FundingModifyReqDto {
	private int fundingId;
	private String fundingName;
	private LocalDate endDate;
	private int goalTotal;
	
	public Funding fundingToEntity() {
		return Funding.builder()
				.fundingId(fundingId)
				.fundingTitle(fundingName)
				.endDate(endDate)
				.goalTotal(goalTotal)
				.build();
	}
}

```

</br>

- ìš”ì²­ìœ¼ë¡œ ë°›ì€ ê°’ì„ Entityë¡œ ì²˜ë¦¬í•˜ê³  ìˆë‹¤.

---

</br></br>

**Service**

```java

@Service
@RequiredArgsConstructor
public class AdminService {

	private final AdminRepository adminRepository;
	
	public int fundingModify(FundingModifyReqDto fundingModifyReqDto) {
		Funding fundingToEntity = fundingModifyReqDto.fundingToEntity();
		return adminRepository.saveFundingModify(fundingToEntity);
	}
	
	public int givingModify(GivingModifyReqDto givingModifyReqDto) {
		Giving givingEntity = givingModifyReqDto.givingModifyToEntity();
		return adminRepository.saveGivingModify(givingEntity);
	}

```

</br>

- Entityë¡œ ì „í™˜í•œ ê°’ë“¤ì„ Repositoryë¡œ ë„˜ê¸°ê³  ë°˜í™˜í•˜ê³  ìˆë‹¤. ìˆ˜ì •ë„ ì„±ê³µ ê±´ìˆ˜ë¡œ ì‘ë‹µì´ ì˜¤ê¸° ë•Œë¬¸ì— intë¡œ ë°›ëŠ”ë‹¤.

---

</br></br>

**Repository**

```java

@Mapper
public interface AdminRepository {
	public int saveFundingModify(Funding funding);
	public int saveGivingModify(Giving giving);
}

```

</br>

- sqlì—ì„œ updateë¥¼ í•˜ê¸° ìœ„í•´ Entityë¥¼ ë³´ë‚´ê³  ìˆë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ ì„±ê³µê±´ìˆ˜ë¡œ ì‘ë‹µì´ ì˜¤ê¸° ë•Œë¬¸ì— intë¡œ ë°›ê³  ìˆë‹¤.

---

</br></br>

**Sql**

```sql

	<update id="saveGivingModify">
		update
			giving_page_tb
		set
			giving_name = #{pageTitle},
			end_date = #{endDate},
			goal_total = #{goalTotal}
		where
			giving_page_id = #{pageId};
	</update>

	<update id="saveFundingModify">
		update
			funding_page_tb
		set
			funding_name = #{fundingTitle},
			end_date = #{endDate},
			goal_total = #{goalTotal}
		where
			funding_id = #{fundingId}
	</update>

```

</br>

- updateë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ìˆ˜ì •í•  ë°ì´í„°ë“¤ì„ ë„£ì–´ì„œ ìˆ˜ì •í•´ì£¼ê³  ìˆë‹¤. ì´ì œ ì„±ê³µì ìœ¼ë¡œ ë°ì´í„°ê°€ ë“¤ì–´ê°€ë©´ ìˆ˜ì •ì´ ëœ ê²ƒì„.

---

</br></br>

**Database**

- ê¸°ë¶€

![ê¸°ë¶€ ìˆ˜ì •](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/3a6a0808-3967-4894-9855-02b08aa53c91)

</br>

- í€ë”©

![í€ë”© ìˆ˜ì •](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/ba2b09ec-af50-49a7-9288-19a273c9c4e7)

</br>

- ì´ë ‡ê²Œ ìˆ˜ì •ëœ ë°ì´í„°ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

---

</div>
</details>

<br/>

### **ê´€ë¦¬ì í€ë”© ë° ê¸°ë¶€ ì‚­ì œ í™”ë©´ êµ¬í˜„ ì˜ìƒ ë° ì½”ë“œ ë¦¬ë·°**

<details>
<summary>ê¸°ë¶€ ì‚­ì œ</summary>
<div markdown="1">
  
![ê¸°ë¶€ ì‚­ì œ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/91f9ff1a-73c5-4350-9682-3bfb66b8552d)

</div>
</details>

<details>
<summary>í€ë”© ì‚­ì œ</summary>
<div markdown="1">
  
![í€ë”© ì‚­ì œ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/b0d12753-abce-45a6-9fa3-caca513d43f4)

</div>
</details>

<details>
<summary>ê¸°ë¶€ & í€ë”© ì‚­ì œ ì½”ë“œ ë¦¬ë·°</summary>
<div markdown="1">

## FrontEnd

**ê´€ë¦¬ì ì‚­ì œ html ì½”ë“œ**

- ê¸°ë¶€

```html
        {role ?
		<button css={givingDeleteButton} onClick={adminDeleteHandleSubmit}>ê¸°ë¶€ ì‚­ì œ</button>
		{deleteOpen ?
		    <div css={givingDeleteContainer}>
			<div css={givingIdentifyContainer}>
			    <div css={givingIdentifyMain}>
				<div css={givingDeleteTitle}>ê¸°ë¶€ ì‚­ì œ</div>
				<div css={givingDeleteMessage}>ê¸°ë¶€ë¥¼ ì •ë§ ì‚­ì œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
				<div css={givingDeleteButtonContainer}>
				    <button css={deleteIdentifyButton} onClick={deleteIdentifyHandleSubmit}>í™•ì¸</button>
				    <button css={deleteCancelButton} onClick={deleteCancelHandleSubmit}>ì·¨ì†Œ</button>
				</div>
			    </div>
			</div>
		    </div>
		: ""}
	: ""}

```

</br>

- í€ë”©

```html
        {role ?
		<button css={fundingDeleteButton} onClick={adminDeleteHandleSubmit}>í€ë”© ì‚­ì œ</button>
		{deleteOpen ?
		    <div css={joinFundContainer}>
			<div css={joinFundIdentifyContainer}>
			    <div css={joinFundIdentifyMain}>
				<div css={FundingModifyTitle}>í€ë”© ì‚­ì œ</div>
				<div css={fundingDeleteMessage}>í€ë”©ì„ ì •ë§ ì‚­ì œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
				<div css={joinIdentifyButtonContainer}>
				    <button css={joinIdentifyButton} onClick={deleteIdentifyHandleSubmit}>í™•ì¸</button>
				    <button css={joinCancelButton} onClick={deleteCancelHandleSubmit}>ì·¨ì†Œ</button>
				</div>
			    </div>
			</div>
		    </div>
		: ""}
	: ""}

```

</br>

- ìˆ˜ì •ì€ ìˆ˜ì •í•  ë‚´ìš©ì„ ì…ë ¥ ë°›ì•„ì„œ ì—…ë°ì´íŠ¸í•´ì¤€ ìƒíƒœê°’ì„ ìš”ì²­ìœ¼ë¡œ ë³´ëƒˆì§€ë§Œ ì‚­ì œëŠ” ë”°ë¡œ ê°’ì„ ì²˜ë¦¬í•´ì£¼ì§€ ì•Šê³  ë²„íŠ¼ì„ ëˆ„ë¥´ëŠ” ìˆœê°„ ë°”ë¡œ ì‚­ì œ ìš”ì²­ì´ ë‚ ë¼ê°€ë„ë¡ ë§Œë“¤ì—ˆë‹¤. 

---

</br></br>

**ìš”ì²­**

- ê¸°ë¶€

```javascript

    const deleteFunding = useMutation(async () => {
        const option = {
            headers: {
                Authorization: `Bearer ${accessToken}`
            }
        }
        return await axios.delete(`http://localhost:8080/admin/giving/delete/${pageId}`, option)
    }, {
        onSuccess: () => {
            alert("ê¸°ë¶€ ë‚´ìš©ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œ ë˜ì—ˆìŠµë‹ˆë‹¤.")
            navigate("/giving")
        }
    })

```

</br>

- í€ë”©

```javascript

    const deleteIdentifyHandleSubmit = () => {
        const rewardIds = [];
        fundingDetailReward.data.data.rewardList.map(reward => 
            rewardIds.push(reward.rewardId)
        )

        deleteFunding.mutate({
            rewardIds: rewardIds,
            fundingId: pageId
        });
    }

    const deleteFunding = useMutation(async (deleteInfo) => {
        const option = {
            headers: {
                Authorization: `Bearer ${accessToken}`
            },
            data: deleteInfo
        }
        return await axios.delete("http://localhost:8080/admin/funding/delete", option)
    }, {
        onSuccess: () => {
            alert("í€ë”© ë‚´ìš©ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œ ë˜ì—ˆìŠµë‹ˆë‹¤.")
            navigate("/funding")
        }
    })

```

</br>

- ê¸°ë¶€ëŠ” pageId(ì„ íƒí•œ ê¸°ë¶€ í˜ì´ì§€)ë§Œ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— urlì— pageIdë¥¼ ë„£ì–´ì„œ ë³´ëƒˆê³ , í€ë”©ì€ rewardIdê°€ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— Listë¡œ ë°›ì•„ì„œ ìš”ì²­ ë°ì´í„°ì— ë„£ì–´ì¤¬ë‹¤.

- ê´€ë¦¬ìê°€ ì‚­ì œí•˜ê¸° ë•Œë¬¸ì— ì„œë²„ì—ì„œ tokenì„ ê²€ì‚¬í•´ì•¼ í•œë‹¤. ê·¸ë˜ì„œ ìš”ì²­ í—¤ë”ì— ë„£ì–´ì„œ ë³´ëƒˆë‹¤.

- ì‚­ì œ ìš”ì²­ì´ê¸° ë•Œë¬¸ì— delete ìš”ì²­

- ì‚­ì œê°€ ì„±ê³µì ìœ¼ë¡œ ë˜ë©´ ë©”ì„¸ì§€ì™€ í•¨ê»˜ ê¸°ë¶€ì™€ í€ë”© ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™

---

</br></br>

## BackEnd

**Controller**

```java

@RestController
@RequestMapping("/admin")
@RequiredArgsConstructor
public class AdminController {
	
	private final AdminService adminService;

	@DeleteMapping("/funding/delete")
		public ResponseEntity<?> toFundingDelete(@RequestBody FundingDeleteReqDto fundingDeleteReqDto) {
		return ResponseEntity.ok(adminService.fundingDelete(fundingDeleteReqDto));
	}
	
	@DeleteMapping("/giving/delete/{pageId}")
	public ResponseEntity<?> givingDeleteInfo(@PathVariable int pageId) {
		return ResponseEntity.ok(adminService.givingDelete(pageId));
	}
	
}

```

</br>

- delete ìš”ì²­ì´ ì™€ì„œ DeleteMappingì‚¬ìš©

- ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì˜¤ë©´ Serviceë¡œ ë„˜ê¸°ê³  ì„±ê³µ ê±´ìˆ˜ ë°˜í™˜.

---

</br></br>

**Dto**

```java

@Data
public class FundingDeleteReqDto {
	private int fundingId;
	private List<Integer> rewardIds;
	
	public Funding deleteFundingIdToEntity() {
		return Funding.builder().fundingId(fundingId).build();
	}
	
	public List<Reward> deleteRewardIdToEntity() {
			List<Reward> rewards = new ArrayList<>();
			for(int i = 0; i < rewardIds.size(); i++) {
				int rewardId = rewardIds.get(i);
				Reward reward = Reward.builder()
				.rewardId(rewardId)
				.build();
				rewards.add(reward);
			}
		return rewards;
	}
}

```

</br>

- fundingIdì™€ rewardIdë¥¼ ì‚­ì œí•  ë•Œ sqlë¬¸ì„ ë”°ë¡œ ì‘ì„±í•´ì•¼ í•´ì„œ ë‚˜ëˆ ì£¼ì—ˆë‹¤.

---

</br></br>

**Service**

```java

@Service
@RequiredArgsConstructor
public class AdminService {

	private final AdminRepository adminRepository;
	
	public int fundingDelete(FundingDeleteReqDto fundingDeleteReqDto) {
		Funding fundingEntity = fundingDeleteReqDto.deleteFundingIdToEntity();
		List<Reward> rewards = fundingDeleteReqDto.deleteRewardIdToEntity();
		adminRepository.saveDeleteRewardId(rewards);
		return adminRepository.saveDeleteFundingId(fundingEntity);
	}
	
	public int givingDelete(int pageId) {
		adminRepository.saveDeleteGivingDonationUsePlan(pageId);
		adminRepository.saveDeleteGivingTargetBenefit(pageId);
		return adminRepository.saveGivingDelete(pageId);
	}
	
	
}

```

</br>

- í€ë”©ì€ Dtoì—ì„œ ì²˜ë¦¬í•´ì¤€ Idë¥¼, ê¸°ë¶€ëŠ” ë‹¤ë¥¸ ì‘ì—… ì—†ì´ ê·¸ëŒ€ë¡œ Idë¥¼ Repositoryë¡œ ë„˜ê¸°ê³  ì„±ê³µ ê±´ìˆ˜ë¥¼ ë°˜í™˜í•˜ê³  ìˆë‹¤.  

---

</br></br>

**Repository**

```java

@Mapper
public interface AdminRepository {
	public int saveDeleteFundingId(Funding funding);
	public int saveDeleteRewardId(List<Reward> reward);
	public int saveGivingDelete(int pageId);
	public int saveDeleteGivingDonationUsePlan(int pageId);
	public int saveDeleteGivingTargetBenefit(int pageId);
}

```

</br>

- í€ë”©ì€ ì‚­ì œë¥¼ í•  ì‹œì— í€ë”© ë©”ì¸ ì •ë³´ë“¤, ë¦¬ì›Œë“œ, í€ë”©í•œ ì‚¬ëŒë“¤ì„ ì‚­ì œí•  ê²ƒì´ë‹¤.

- ê¸°ë¶€ëŠ” ì‚­ì œë¥¼ í•  ì‹œì— ê¸°ë¶€ ë©”ì¸ ì •ë³´ë“¤, ê¸°ë¶€ê¸ˆ ì‚¬ìš© ê³„íš, ì‚¬ì—…ëŒ€ìƒíš¨ê³¼ ë° ê¸°ëŒ€íš¨ê³¼, ê¸°ë¶€í•œ ì‚¬ëŒë“¤ì„ ì‚­ì œí•  ê²ƒì´ë‹¤.

---

</br></br>

**Sql**

- í€ë”©

```sql

	<delete id="saveDeleteFundingId" parameterType="com.webproject.crowdfunding.entity.Funding">
		delete
		from
			funding_page_tb
		where
			funding_id = #{fundingId};
	</delete>
	
	<delete id="saveDeleteRewardId" parameterType="com.webproject.crowdfunding.entity.Reward">
		  delete
		  from
		 	reward_tb
		  where
		  	reward_id in
	  <foreach collection="list" item="reward" open="(" separator="," close=")">
	    	#{reward.rewardId}
	  </foreach>
	</delete>

```

</br>

- ê¸°ë¶€

```sql

	<delete id="saveGivingDelete">
		delete
		from
			giving_page_tb
		where
			giving_page_id = #{pageId}
	</delete>
	
	<delete id="saveDeleteGivingDonationUsePlan">
		delete
		from
			donation_use_plan_tb
		where
			giving_page_id = #{pageId}
	</delete>
	
	<delete id="saveDeleteGivingTargetBenefit">
		delete
		from
			target_benefit_tb
		where
			giving_page_id = #{pageId}
	</delete>


```

</br>

- í€ë”© ê° í…Œì´ë¸”ì— í•´ë‹¹ë˜ëŠ” Idë¥¼ ì‚­ì œí•˜ê³  ìˆë‹¤. rewardIdëŠ” Listë¡œ ë“¤ê³ ì™”ê¸° ë•Œë¬¸ì— foreachë¥¼ ëŒë ¤ rewardIdë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ ì‚­ì œë¥¼ í•˜ê³  ìˆë‹¤.

- ê¸°ë¶€ë„ ê° í…Œì´ë¸”ì— í•´ë‹¹ë˜ëŠ” Idë¥¼ ì‚­ì œí•˜ê³  ìˆë‹¤.

- í€ë”©í•œ ì‚¬ëŒê³¼ ê¸°ë¶€í•œ ì‚¬ëŒë“¤ ë“± ë‚˜ë¨¸ì§€ëŠ” í•´ë‹¹ funding_id, reward_id, giving_page_idë¡œ ê°€ì¥ ì¤‘ìš”í•œ ë©”ì¸ ì •ë³´ë“¤ì´ ì‚¬ë¼ì§€ê¸° ì „ì— ì§€ì›Œì•¼ í•  ê²ƒë“¤ì„ triggerì— ì‘ì„±ì„ í•´ë†¨ë‹¤. ê·¸ ë¶€ë¶„ì€ ì•„ë˜ Database ì‚¬ì§„ì— ì„¤ëª…ì´ ë˜ì–´ìˆë‹¤.

---

</br></br>

**Database**

- ê¸°ë¶€ ì‚­ì œ

![ê¸°ë¶€ ì‚­ì œ](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/a442bd49-ede2-432a-8853-8361d68d9041)

</br>

- í€ë”© ì‚­ì œ
  
![í€ë”© ì‚­ì œ](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/81849142-6c56-486d-bdfb-db807122eb9d)

</br>

---

- ê¸°ë¶€í•œ ì‚¬ëŒ ì‚­ì œ

![ê¸°ë¶€í•œ ì‚¬ëŒ ì‚­ì œ trigger](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/c4eb8713-b080-4782-bd0b-20604ac90cb0)

</br>

- ë¦¬ì›Œë“œ, ì‚¬ì—…ì ì •ë³´ ì‚­ì œ

![ë¦¬ì›Œë“œ, ì‚¬ì—…ì ì •ë³´ ì‚­ì œ trigger](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/8ff949a8-1c43-434a-a135-432492bc020e)

</br>

- í€ë”©í•œ ì‚¬ëŒ ì‚­ì œ

![í€ë”©í•œ ì‚¬ëŒ ì‚­ì œ trigger](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/254613fd-f3cb-44d9-ac9a-a8352ac2f0b4)

</br>

- oldëŠ” í˜„ì¬ í…Œì´ë¸”ì„ ëœ»í•œë‹¤. ê¸°ë¶€ ì‚­ì œ triggerëŠ” giver_tbì— ìˆëŠ” giving_page_idì™€ í˜„ì¬ í…Œì´ë¸”ì¸ giving_page_tbì— ìˆëŠ” giving_page_idì™€ ì¼ì¹˜í•˜ëŠ” ê²ƒì„ ì‚­ì œí•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì´ëŠ” BEFORE DELETE ì•ˆì— ì‘ì„±ì´ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— giving_page_tbì— ìˆëŠ” idê°€ ì‚­ì œë˜ê¸° ì „ì— giver_tbì— ìˆëŠ” idë¥¼ ì‚­ì œí•œë‹¤ëŠ” ì˜ë¯¸ë‹¤.

- ë‚˜ë¨¸ì§€ë„ ë§ˆì°¬ê°€ì§€ë¡œ ë˜‘ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.

---

</div>
</details>

<br/>

### **OAuth2 íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ í™”ë©´ êµ¬í˜„ ì˜ìƒ**

<details>
<summary>OAuth2 íšŒì›ê°€ì… ë° ë¡œê·¸ì¸</summary>
<div markdown="1">
  
![OAuth2 íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/c2bebc58-65d9-4b68-adba-dc939e1d0883)

</div>
</details>

<br/>

### **OAuth2 Google, Kakao ê³„ì • í†µí•© í™”ë©´ êµ¬í˜„ ì˜ìƒ**

<details>
<summary>OAuth2 ê³„ì • í†µí•©</summary>
<div markdown="1">
  
![OAuth2 ê³„ì • í†µí•© - Clipchampë¡œ ì œì‘](https://github.com/KORIT-KLJK/CrowdFunding-portfolio/assets/121987405/478e6782-37a1-4e0b-b352-fcbd70c0b817)


</div>
</details>

</br>

### OAuth2 íšŒì›ê°€ì…, ë¡œê·¸ì¸, ê³„ì • í†µí•© ì½”ë“œ ë¦¬ë·°

<details>
<summary>OAuth2 íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ ì½”ë“œ ë¦¬ë·°</summary>
<div markdown="1">

</br>
  
ì½”ë“œ ë¦¬ë·°í•˜ê¸°ì— ì•ì„œ êµ¬ê¸€, ë„¤ì´ë²„, ì¹´ì¹´ì˜¤ ë””ë²¨ë¡œí¼ ì„¤ì •ì„ í•´ì¤˜ì•¼ í•œë‹¤. ì˜ˆì‹œë¡œ êµ¬ê¸€ ë””ë²¨ë¡œí¼ ì„¤ì • ë°©ë²•ì„ ì•„ë˜ì— ì‘ì„±ì„ í•´ë³´ê² ë‹¤.

</br>

êµ¬ê¸€ì°½ì— êµ¬ê¸€ í´ë¼ìš°ë“œ í”Œë«í¼ ê²€ìƒ‰ -> ë‘ ë²ˆì§¸ ê±° ë“¤ì–´ê°€ê¸° -> í”„ë¡œì íŠ¸ ê²€ìƒ‰ -> ìƒˆí”„ë¡œì íŠ¸ -> ë§Œë“¤ê¸° -> ë°©ê¸ˆ ë§Œë“¤ì–´ì§„ í”„ë¡œì íŠ¸ ì„ íƒ -> API ë° ì„œë¹„ìŠ¤ -> oauth ë™ì˜í™”ë©´ -> ì™¸ë¶€ -> ë§Œë“¤ê¸° -> ì•± ì •ë³´, ê°œë°œì ì—°ë½ì²˜ ì •ë³´ ì…ë ¥ -> ì €ì¥ í›„ ê³„ì† -> ë²”ìœ„ ì¶”ê°€(scope ì„¤ì •) ->

(.../auth/userinfo.email	ê¸°ë³¸ Google ê³„ì •ì˜ ì´ë©”ì¼ ì£¼ì†Œ í™•ì¸	

 .../auth/userinfo.profile	ê°œì¸ì •ë³´(ê³µê°œë¡œ ì„¤ì •í•œ ê°œì¸ì •ë³´ í¬í•¨) ë³´ê¸°)

ë‘ ê°œ ì„ íƒ -> ì €ì¥ í›„ ê³„ì† -> ì‚¬ìš©ì ì¸ì¦ ì •ë³´ -> ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ë§Œë“¤ê¸° -> OAuth í´ë¼ì´ì–¸íŠ¸ ID ë§Œë“¤ê¸° -> ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ -> ì´ë¦„ ì„¤ì • -> ìŠ¹ì¸ëœ ë¦¬ë””ë ‰ì…˜ URIì— http://localhost:8080 -> ë§Œë“¤ê¸° (í´ë¼ì´ì–¸íŠ¸ ë³´ì•ˆ ë¹„ë°€ë²ˆí˜¸ëŠ” ë³´ì•ˆ keyì´ê¸° ë•Œë¬¸ì— ìœ ì¶œì´ ë˜ë©´ ì•ˆ ë¨) -> ì„œë²„ë¥¼ ë§Œë“¤ ë•Œ ë„£ì–´ì¤˜ì•¼ í•  Dependency

OAuth2 Client SECURITYSpring Boot integration for Spring Security's OAuth2/OpenID Connect client features.

</br>

ì—¬ê¸°ê¹Œì§€ í•˜ë©´ êµ¬ê¸€ ì„œë²„ë¡œ ë“¤ì–´ê°€ê¸° ìœ„í•œ ì„¤ì •ì€ ëë‚¬ë‹¤. ì´ì œ ì½”ë“œ ì‘ì„±ì„ í•´ë³´ê² ë‹¤.

## FrontEnd

**html ì½”ë“œ**

```html

    <div css={signupAndOtherLogin}>
	<div css={signupNaviBtn} onClick={signupNavi}>íšŒì›ê°€ì…</div>
	<div css={providerLoginContainer}>ë‹¤ë¥¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸</div>
    </div>
	<div css={providerButtonContainer}>
	    <button css={google} onClick={googleAuthLoginClickHandle}><FcGoogle /></button>
	    <button css={naver} onClick={naverAuthLoginClickHandle}><SiNaver /></button>
	    <button css={kakao} onClick={kakaoAuthLoginClickHandle}><SiKakao /></button>
	</div>

```

</br>

- êµ¬ê¸€, ë„¤ì´ë²„, ì¹´ì¹´ì˜¤ ì•„ì´ì½˜ì„ ë°›ì•„ì„œ, í´ë¦­ì‹œ í•´ë‹¹ ê³„ì •ìœ¼ë¡œ ë„˜ì–´ê°.

---

</br></br>

**ë¡œê·¸ì¸**

```javascript

    const googleAuthLoginClickHandle = () => {
        window.location.href = "http://localhost:8080/oauth2/authorization/google";
    }

    const naverAuthLoginClickHandle = () => {
        window.location.href = "http://localhost:8080/oauth2/authorization/naver";
    }

    const kakaoAuthLoginClickHandle = () => {
        window.location.href = "http://localhost:8080/oauth2/authorization/kakao";
    }

```

</br>

- http://localhost:8080/oauth2/authorization/google ì´ ì£¼ì†ŒëŠ” êµ¬ê¸€ ì„œë²„ ì£¼ì†Œì„. naverë©´ ì ¤ ëì— naver. kakaoë©´ kakao

---

</br></br>

## BackEnd

**application.yml**

```html

  security:
    oauth2:
      client:
        registration:
          google:
            client-id: 360072367742-ej55vbhnd46b5gavi86k4n4bqaeki8hs.apps.googleusercontent.com
            client-secret: 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
            scope:
              - email
              - profile
          kakao:
            client-id: 78fef42274ba4dd840ab1be7626ef03f
            client-secret: Nc9PTT0EZZrBBac1KUacD1hgvEDSrh6S
            redirect-uri: http://localhost:8080/login/oauth2/code/kakao
            authorization-grant-type: authorization_code
            client-authentication-method: POST
            client-name: Kakao
            scope:
              - profile_nickname
              - account_email
          naver:
            client-id: A0GjFzJY3Z6ALBlxgYpS
            client-secret: RoEJ5AdEP7
            redirect-uri:  http://localhost:8080/login/oauth2/code/naver
            authorization-grant-type: authorization_code
            scope:
              - name
              - email
        provider:
          kakao:
            authorization-uri: https://kauth.kakao.com/oauth/authorize
            token-uri: https://kauth.kakao.com/oauth/token
            user-info-uri: https://kapi.kakao.com/v2/user/me
            user-name-attribute: id
          naver:
            authorization-uri: https://nid.naver.com/oauth2.0/authorize
            token-uri: https://nid.naver.com/oauth2.0/token
            user-info-uri: https://openapi.naver.com/v1/nid/me
            user-name-attribute: response

```

</br>

- client-idì™€ secretì€ ìœ„ì—ì„œ ì„¤ëª…í•œ ë””ë²¨ë¡œí¼ë¥¼ ë§Œë“¤ê³ ë‚˜ë©´ ë‚˜ì™€ìˆë‹¤. ê±°ê¸°ì— ìˆëŠ” ê±¸ ë¶™ì—¬ë„£ìœ¼ë©´ ëœë‹¤.

- scopeëŠ” ë§ˆì°¬ê°€ì§€ë¡œ ìœ„ì—ì„œ ì„¤ëª…í•œ scope 2ê°œê°€ í¬í•¨ëœë‹¤.

- êµ¬ê¸€ ì„œë²„ì—ì„œ ë°›ì€ í† í° ì•ˆì—ëŠ” providerê°€ í¬í•¨ë˜ì–´ìˆê¸° ë•Œë¬¸ì— kakaoì™€ naverì²˜ëŸ¼ ë”°ë¡œ ì„¤ì •í•´ì¤„ í•„ìš”ê°€ ì—†ë‹¤.

---

</br></br>

**SecurityConfig(ì›¹ ë³´ì•ˆ ì„¤ì •)**

```java

public class SecurityConfig extends WebSecurityConfigurerAdapter {
	
	private final JwtTokenProvider jwtTokenProvider;
	private final OAuth2SuccessHandler oAuth2SuccessHandler;
	private final OAuth2Service oAuth2Service;
	private final JwtAuthenticationEntryPoint jwtAuthenticationEntryPoint;
	
	@Bean
	public BCryptPasswordEncoder passwordEncoder() {
		return new BCryptPasswordEncoder();
	}
	
	@Override
	protected void configure(HttpSecurity http) throws Exception {
		http.cors();
		http.csrf().disable();
		http.httpBasic().disable();
		http.formLogin().disable();
		
		http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);
		
		http.authorizeRequests()
			.antMatchers("/image/**", "/funding/**", "/giving/**", "/main/**", "/page/**")
			.permitAll()
			.antMatchers("/auth/funding/**", "/auth/giving/**", "/admin/**")
			.authenticated()
			.and()
			.addFilterBefore(new JwtAuthenticationFilter(jwtTokenProvider), UsernamePasswordAuthenticationFilter.class)
			.exceptionHandling()
			.authenticationEntryPoint(jwtAuthenticationEntryPoint)
			.and()
			.oauth2Login()
			.loginPage("http://localhost:3000/auth/login")
			.successHandler(oAuth2SuccessHandler)
			.userInfoEndpoint()
			.userService(oAuth2Service);	
			
		
	}
}

```

</br>

- OAuth2 ë¡œê·¸ì¸ ìš”ì²­ì´ ì„œë²„ë¡œ ë“¤ì–´ì˜¤ë©´ ê°€ì¥ ë¨¼ì € ì—¬ê¸°ë¡œ ë“¤ì–´ì˜¨ë‹¤. ì—¬ê¸° ì¤‘ì—ì„œë„ oauth2Login()ìœ¼ë¡œ ë“¤ì–´ì˜¤ê²Œ ë˜ëŠ”ë° ì´ëŠ” OAuth2 ë¡œê·¸ì¸ ì„¤ì •ì„ êµ¬ì„±í•˜ëŠ” ë‹¨ê³„ë‹¤.

- loginPage("http://localhost:3000/auth/login")ë¡œ ë¡œê·¸ì¸ í˜ì´ì§€ URL ì„¤ì •í•œë‹¤. ìš°ë¦¬ëŠ” http://localhost:3000/auth/loginë¡œ ì“°ê³  ìˆê¸° ë•Œë¬¸ì— ì´ë ‡ê²Œ ì„¤ì •ì„ í•´ì¤€ ê²ƒì´ë‹¤.

- ê·¸ ë‹¤ìŒ successHandlerëŠ” OAuth2 ë¡œê·¸ì¸ì´ ì„±ê³µì ìœ¼ë¡œ ëì„ ë•Œ ì‹¤í–‰ì´ ë˜ê¸° ë•Œë¬¸ì— ì´ ë¶€ë¶„ì€ ë§ˆì§€ë§‰ì— ì‹¤í–‰ì´ ëœë‹¤. ê·¸ë˜ì„œ ë‹¤ìŒìœ¼ë¡œëŠ” userServiceë¡œ ê°€ê²Œ ëœë‹¤.

---

</br></br>

**OAuth2Service**

```java

@Service
@RequiredArgsConstructor
public class OAuth2Service implements OAuth2UserService<OAuth2UserRequest, OAuth2User>{

	@Override
	public OAuth2User loadUser(OAuth2UserRequest userRequest) throws OAuth2AuthenticationException {
		OAuth2UserService<OAuth2UserRequest, OAuth2User> oAuth2UserService = new DefaultOAuth2UserService();
		OAuth2User oAuth2User = oAuth2UserService.loadUser(userRequest);
		
		String registrationId = userRequest.getClientRegistration().getRegistrationId();
		
		OAuth2Attribute oAuth2Attribute = OAuth2Attribute.of(registrationId, oAuth2User.getAttributes());
		
		Map<String, Object> attributes = oAuth2Attribute.convertToMap();
		
		return new DefaultOAuth2User(Collections.singleton(new SimpleGrantedAuthority("ROLE_USER")), attributes, "email");
	}
}

```

</br>

- oAuth2UserServiceì™€ oAuth2UserëŠ” OAuth2 ì¸ì¦ì„ í†µí•´ ìœ ì € ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê³¼ì •ì„ ì²˜ë¦¬í•˜ëŠ” ë¶€ë¶„ì´ë‹¤. ì¦‰, êµ¬ê¸€ì—ì„œ ë°œê¸‰ ë°›ì€ í† í°ì„ ì—´ì–´ì„œ ìœ ì € ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ë‹¤.

- registrationIdëŠ” google, naver, kakao ì¤‘ ì–´ë–¤ ê²ƒì¸ì§€ ì°¾ëŠ” ê²ƒì´ë‹¤.

- oAuth2AttributeëŠ” ì—¬ëŸ¬ê°€ì§€ ì •ë³´ë“¤ì´ ìˆëŠ”ë° ê·¸ ì¤‘ provider(google, naver, kakao)ì™€ ì´ë¦„, ì´ë©”ì¼ì„ ë“¤ê³ ì˜¤ê¸° ìœ„í•´ì„œ ë§Œë“¤ì—ˆë‹¤. ìì„¸í•œ ê±´ ì•„ë˜ ì½”ë“œì—ì„œ ë‹¤ë£° ê²ƒì´ë‹¤.

- oAuth2Attribute ì•ˆì— convertToMapì„ í˜¸ì¶œí•˜ë©´ ë°”ë¡œ ìœ„ì—ì„œ ì–˜ê¸°í•œ 3ê°€ì§€ ì •ë³´ë¥¼ ë“¤ê³ ì˜¬ ìˆ˜ ìˆë‹¤.

- returní•˜ëŠ” ìƒì„±ì ì•ˆì—ëŠ” ì‚¬ìš©ìì˜ ê¶Œí•œ, ì†ì„±, ê³ ìœ  ì‹ë³„ìë¥¼ ë“¤ê³  ì˜¤ëŠ”ë°, ì‹ë³„ìì— emailì´ ë“¤ì–´ê°„ ì´ìœ ëŠ” ë§ ê·¸ëŒ€ë¡œ ê³ ìœ í•œ ì‹ë³„ìì—¬ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë‹‰ë„¤ì„ì„ ì‚¬ìš©í•  ê²½ìš° ì¤‘ë³µì´ ë  ìˆ˜ ìˆë‹¤. ê·¸ë˜ì„œ emailì„ ì‚¬ìš©í–ˆë‹¤.

- ì—¬ê¸°ê¹Œì§€ ì„±ê³µí•˜ë©´ ë¡œê·¸ì¸ì„ ìœ„í•´ ë§ˆì§€ë§‰ìœ¼ë¡œ SuccessHandlerë¡œ ê°€ê²Œ ëœë‹¤.

---

</br></br>

**OAuth2Attribute**

```java

@ToString
@Builder(access = AccessLevel.PRIVATE)	// ìƒì„±ì ìì²´ê°€ privateì´ ë¨
@Getter
public class OAuth2Attribute {
	// attribute ì •ë³´ë¥¼ ì•„ë˜ 3ê°œë¡œ í†µì¼ì„ ì‹œí‚´
    private Map<String, Object> attributes;
    private String email;
    private String name;
    private String provider;

    public static OAuth2Attribute of(String provider, Map<String, Object> attributes) {
        switch (provider) {
            case "google":
                return ofGoogle(provider, attributes);
            case "kakao":
                return ofKakao(provider, attributes);
            case "naver":
                return ofNaver(provider, attributes);
            default:
                throw new RuntimeException();
        }
    }

    // google, kakao, naverë¥¼ ë‚˜ëˆˆ ì´ìœ ëŠ” ì„¸ ê°œ ë‹¤ attributeì˜ êµ¬ì¡°ê°€ ë‹¤ë¥´ë‹¤
    // googleì€ attribute ì•ˆì— ë‚´ìš©ì´ ë‹¤ ë“¤ì–´ ìˆìŒ.
    private static OAuth2Attribute ofGoogle(String provider, Map<String, Object> attributes) {
        return OAuth2Attribute.builder()
                .name((String) attributes.get("name"))
                .email((String) attributes.get("email"))
                .provider((String) provider)
                .attributes(attributes)
                .build();
    }

    // map ì•ˆì— mapì´ ìˆìŒ
    private static OAuth2Attribute ofKakao(String provider, Map<String, Object> attributes) {
        Map<String, Object> kakaoAccount = (Map<String, Object>) attributes.get("kakao_account");
        Map<String, Object> kakaoProfile = (Map<String, Object>) kakaoAccount.get("profile");

        return OAuth2Attribute.builder()
                .name((String) kakaoProfile.get("nickname"))
                .email((String) kakaoAccount.get("email"))
                .provider((String) provider)
                .attributes(kakaoAccount)
                .build();
    }

    private static OAuth2Attribute ofNaver(String provider, Map<String, Object> attributes) {
        Map<String, Object> response = (Map<String, Object>) attributes.get("response");

        return OAuth2Attribute.builder()
                .name((String) response.get("name"))
                .email((String) response.get("email"))
                .provider((String) provider)
                .attributes(response)
                .build();
    }

    public Map<String, Object> convertToMap() {
        Map<String, Object> map = new HashMap<>();
        map.put("name", name);
        map.put("email", email);
        map.put("provider", provider);

        return map;
    }
}

```

</br>

- of ë©”ì„œë“œì—ëŠ” ìœ„ ì„œë¹„ìŠ¤ì—ì„œ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ ë°›ì€ providerì™€ ìœ ì € ì •ë³´ê°€ ë“¤ì–´ì˜¤ê²Œ ëœë‹¤. switchë¬¸ìœ¼ë¡œ provider í•´ë‹¹ë˜ëŠ” ê°’ì„ ì°¾ì•„ ê·¸ ë©”ì„œë“œë¡œ returnì„ í•œë‹¤. ì§€ê¸ˆì€ êµ¬ê¸€ë¡œ ì§„í–‰í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ofGoogleë¡œ ê°€ë³´ê² ë‹¤.

- ìœ„ ì½”ë“œì—ì„œ ë‹¬ì•„ì¤€ ì£¼ì„ì²˜ëŸ¼ googleì€ attribute ì•ˆì— ë‚´ìš©ì´ ë‹¤ ë“¤ì–´ ìˆë‹¤. ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ ë°›ì€ ìœ ì € ì •ë³´ë“¤ì„ ì—´ì–´ì„œ ë‹‰ë„¤ì„, ì´ë©”ì¼, providerë¥¼ ê°€ì§€ê³  Builderë¥¼ í†µí•´ ì´ ê°ì²´ì— ìˆëŠ” ë³€ìˆ˜ì—ë‹¤ ê°’ì„ ë„£ì–´ì¤€ë‹¤.

- Builderë¥¼ í†µí•´ ë³€ìˆ˜ì— ê°’ì„ ë„£ì–´ì£¼ì—ˆê¸° ë•Œë¬¸ì— ë§ˆì§€ë§‰ convertToMap í•¨ìˆ˜ì—ì„œ mapìœ¼ë¡œ keyì™€ valueë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. ê·¸ë˜ì„œ Serviceì—ì„œ convertToMapì„ í˜¸ì¶œí–ˆì„ ë•Œ ì´ 3ê°€ì§€ ì •ë³´ê°€ ë“¤ì–´ê°€ê²Œ ëœ ê²ƒì´ë‹¤.

---

</br></br>

**SuccessHandler**

```java

@Component
@RequiredArgsConstructor
public class OAuth2SuccessHandler extends SimpleUrlAuthenticationSuccessHandler{
	private final UserRepository userRepository;
	private final JwtTokenProvider jwtTokenProvider;	
	
	@Override
	public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response,
			Authentication authentication) throws IOException, ServletException {
		OAuth2User oAuth2User = (OAuth2User) authentication.getPrincipal();
		String email = oAuth2User.getAttribute("email");
		String provider = oAuth2User.getAttribute("provider");
		User userEntity = userRepository.findUserByEmail(email);
		
		if(userEntity == null) {
			String registerToken = jwtTokenProvider.generateToken(authentication).getAccessToken().toString();
			String name = oAuth2User.getAttribute("name");
			response
			.sendRedirect(
					"http://localhost:3000/auth/oauth2/signup"
							+ "?registerToken=" + registerToken
							+ "&email=" + email
							+ "&name=" + URLEncoder.encode(name, "UTF-8")
							+ "&provider=" + provider
			);
		}else {
			if(StringUtils.hasText(userEntity.getProvider())) {
				if(!userEntity.getProvider().contains(provider)) {
					response.sendRedirect(
							"http://localhost:3000/auth/oauth2/merge"
					 			 	+ "?provider=" + provider
									+ "&email=" + email);
					return;
				}
				
				response.sendRedirect("http://localhost:3000/auth/oauth2/login"
				 			 	+ "?accessToken=" + jwtTokenProvider.generateToken(authentication).getAccessToken());
				
			}else {
				response.sendRedirect(
						"http://localhost:3000/auth/oauth2/merge"
				 			 	+ "?provider=" + provider
								+ "&email=" + email);
			}
		}
		
	}
}

```

</br>

- ì´ë©”ì¼ì„ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í•´ë‹¹ ìœ ì € ì •ë³´ë¥¼ ì¡°íšŒí•œë‹¤.

- ìœ ì €ê°€ ì²˜ìŒìœ¼ë¡œ ë¡œê·¸ì¸í•˜ëŠ” ê²½ìš° íšŒì› ê°€ì… í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ í•˜ê³ , ì¸ì¦ í† í°ê³¼ í•¨ê»˜ í•„ìš”í•œ ì •ë³´ë“¤ì„ ì „ë‹¬í•œë‹¤. ì—¬ê¸°ì„œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë€, ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ íŠ¹ì • URLë¡œ ì´ë™í•˜ë„ë¡ ìš”ì²­í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.

- ì´ë¯¸ ê°€ì…í•œ ì‚¬ìš©ìì¸ ê²½ìš° provider ì •ë³´ë¥¼ í™•ì¸í•˜ì—¬ ì´ë¯¸ ì—°ë™ëœ providerì¸ì§€ë¥¼ íŒë‹¨í•œë‹¤. ì´ë¯¸ ì—°ë™ëœ providerë¼ë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ê³ , ìƒˆë¡œìš´ ì¸ì¦ í† í°ì„ ë°œê¸‰í•œë‹¤. ì•„ì§ ì—°ë™ë˜ì§€ ì•Šì€ providerë¼ë©´ provider ì—°ë™ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•œë‹¤.

---

</br>

**OAuth2 ë¡œê·¸ì¸ ë¦¬ë‹¤ì´ë ‰íŠ¸**

```javascript

const OAuth2Login = () => {
    const [ searchParams, setSearchParams ] = useSearchParams();
    const accessToken = searchParams.get("accessToken");

    if(!!accessToken) {
        localStorage.setItem("accessToken", accessToken);
        window.location.replace("/");
    }

    return (
        <>
        
        </>
    );
};

```

</br>

- ì„œë²„ì—ì„œ ë³´ë‚¸ ë¦¬ë‹¤ì´ë ‰íŠ¸ URLì—ì„œ í† í°ì„ ê°€ì ¸ì˜¨ë‹¤. ê·¸ í† í°ì´ ì¡´ì¬í•œë‹¤ë©´ loalStorageì— í† í°ì„ ë„£ì–´ì£¼ê³ , ë©”ì¸ í™”ë©´ìœ¼ë¡œ ë³´ë‚¸ë‹¤. ì—¬ê¸°ê¹Œì§€ OAuth2 ë¡œê·¸ì¸ ì„±ê³µ.

---

</div>
</details>

<details>
<summary>OAuth2 íšŒì›ê°€ì…</summary>
<div markdown="1">
  
</br>

í˜•ì‹ì€ ì¼ë°˜ íšŒì›ê°€ì…ì´ë‘ ì™„ì „ ë˜‘ê°™ìœ¼ë‚˜ ë‹¤ë¥¸ ì ì€ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¡œ ë°›ì€ URLì„ ì—´ì–´ ì„ì‹œ í† í°, ì´ë©”ì¼, ì´ë¦„, providerë¥¼ ë“¤ê³ ì˜¨ë‹¤.

</br>

```javascript

    const [ searchParams, setSearchParams ] = useSearchParams();
    const registerToken = searchParams.get("registerToken");
    const email = searchParams.get("email");
    const name = searchParams.get("name");
    const provider = searchParams.get("provider");

```

</br>

```html

                                <FormControl variant="standard">
                                        <Input id="input-with-icon-adornment"
                                            css={placeholderFontSize}
                                            label="email" 
                                            variant="outlined" 
                                            value={email}
                                            disabled={true}
                                            type="text" 
                                            startAdornment={
                                                <InputAdornment position="start">
                                                <Mail />
                                                </InputAdornment>
                                            } />
                                    </FormControl>

                                    <FormControl variant="standard">
                                            <Input id="input-with-icon-adornment" 
                                                label="name" 
                                                variant="outlined" 
                                                type="text"
                                                value={name}
                                                disabled={true}
                                                startAdornment={
                                                    <InputAdornment position="start">
                                                    <Badge />
                                                    </InputAdornment>
                                                } />
                                            {errorMessage.name && <Alert css={errorCss} severity="error">{errorMessage.name}</Alert>}
                                    </FormControl>

```

</br>

- ì´ì²˜ëŸ¼ ì´ë©”ì¼ê³¼ ì´ë¦„ì„ ë“¤ê³ ì™€ì„œ ë°”ê¾¸ì§€ ëª»í•˜ê²Œ disabledë¥¼ ê±¸ì–´ì¤€ë‹¤.

---

</br></br>

**ìš”ì²­**

```javascript

    const OAuth2register = useMutation(async () => {
        if (signUp.password !== signUp.confirmPassword) {
            setErrorMessages({confirmPassword: "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."});
            return;
        }
        const data = {
            ...signUp, ...address
        }

        const option = {
            headers: {
                registerToken: `Bearer ${registerToken}`,
                "Content-Type": "application/json"
            }
        }
        try {
            await axios.post("http://localhost:8080/auth/oauth2/signup", JSON.stringify(data), option)
            setErrorMessages({password: "", confirmPassword: "", name: "", gender: "", birthday: "", phoneNumber: "", zonecode: "", address: "", detailAddress: ""})
            alert("íšŒì›ê°€ì… ì™„ë£Œ")
            window.location.replace("/login")
        }catch(error) {
            console.log(error)
            setErrorMessages({password: "", confirmPassword: "", name: "", gender: "", birthday: "", phoneNumber: "", zonecode: "", address: "", detailAddress: "",...error.response.data.errorData})
        }
    });

```

</br>

- ìš”ì²­ ë°ì´í„°ì— ì¶”ê°€ëœ ê²ƒì€ provider í•˜ë‚˜ë°–ì— ì—†ë‹¤.

- ì¼ë°˜ íšŒì›ê°€ì… ì–‘ì‹ì´ë‘ ë˜‘ê°™ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì„œë²„ì— ì„ì‹œ í† í°ì„ í—¤ë”ë¡œ ë³´ë‚´ì„œ OAuth2ë¡œ ë“¤ì–´ì˜¨ ê±´ì§€ í™•ì¸ì„ í•  ê²ƒì´ë‹¤.

---

</br></br>

## BackEnd

**Controller**

```java

@RestController
@RequestMapping("/auth")
@RequiredArgsConstructor
public class OAuth2Controller {

	private final JwtTokenProvider jwtTokenProvider;
	private final OAuth2Service oAuth2Service;
	
	
	
	@PostMapping("/oauth2/signup")
	@ValidAspect
	public ResponseEntity<?> signup(
			@RequestHeader(value="registerToken") String registerToken,
			@Valid
			@RequestBody OAuth2SignUpReqDto oAuth2SignUpReqDto,
			BindingResult bindingResult) {
		boolean validated = jwtTokenProvider.validateToken(jwtTokenProvider.getToken(registerToken));
		
		if(!validated) {
			// í† í°ì´ ìœ íš¨í•˜ì§€ ì•ŠìŒ.
			return ResponseEntity.badRequest().body("íšŒì›ê°€ì… ìš”ì²­ ì‹œê°„ì´ ì´ˆê³¼í•˜ì˜€ìŠµë‹ˆë‹¤.");
		}
		return ResponseEntity.ok().body(oAuth2Service.oauth2signUp(oAuth2SignUpReqDto));
	}
 }

```

</br>

- í† í° ì¸ì¦í•˜ëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì„œ ì„ì‹œ í† í°ì„ ë„£ì–´ì¤€ ë‹¤ìŒ ì¸ì¦ì„ í•œë‹¤. í† í°ì´ ìœ íš¨í•˜ì§€ ì•Šì„ ê²½ìš° badRequestë¡œ ì²˜ë¦¬í–ˆë‹¤.

- OAuth2 ì¸ì¦ì´ ë˜ë©´ Serviceë¡œ ë„˜ì–´ê°„ë‹¤.

- DtoëŠ” ì¼ë°˜ íšŒì›ê°€ì… í˜•ì‹ì´ë‘ ë™ì¼í•œë° provider ë³€ìˆ˜ë§Œ ì¶”ê°€ë¥¼ í–ˆë‹¤.

---

</br></br>

**Service**

```java

@Service
@RequiredArgsConstructor
public class OAuth2Service implements OAuth2UserService<OAuth2UserRequest, OAuth2User>{

	public int oauth2signUp(OAuth2SignUpReqDto oAuth2RegisterReqDto) {
		userEntity = oAuth2RegisterReqDto.toUserEntity();
		userRepository.signUpUser(userEntity);
		userRepository.saveAuthority(
				Authority.builder()
				.userId(userEntity.getUserId())
				.roleId(1)
				.build()
			);
		
		Address addressEntity = oAuth2RegisterReqDto.toAddressEntity();
		addressEntity.setUserId(userEntity.getUserId());
		return userRepository.saveAddress(addressEntity);
	}
}

```

</br>

- ì¼ë°˜ íšŒì›ê°€ì…ì´ë‘ ë™ì¼í•˜ê²Œ ì‘ì„±í–ˆë‹¤.

---

</br></br>

**Repository**

```java

@Mapper
public interface UserRepository {
	public int saveAddress(Address address);
	public int signUpUser(User user);
}

```

</br>

- Repositoryë„ ë§ˆì°¬ê°€ì§€

---

</br></br>

**Sql**

```sql

	<insert id="signUpUser"
		parameterType="com.webproject.crowdfunding.entity.User"
		useGeneratedKeys="true"
		keyProperty="userId">
		insert into user_tb
		values(0, #{email}, #{password}, #{name}, #{birthday}, #{gender}, #{provider}, #{phoneNumber})
	</insert>
	
	<insert id="saveAuthority" parameterType="com.webproject.crowdfunding.entity.Authority">
		insert into authority_tb
		values
			(0, #{userId}, #{roleId})
	</insert>

```

</br>

- valuesì— providerê°€ ë“¤ì–´ê°€ìˆëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤. providerëŠ” nullì¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— tableì„ ë§Œë“¤ ë•Œ providerëŠ” not null ì²´í¬ë¥¼ í•˜ì§€ ì•Šì•˜ë‹¤.

---

**Database**


![OAuth2 íšŒì›ê°€ì…](https://github.com/iuejeong/-AWS-_Java_study_202212_euihyun/assets/121987405/bd118735-2490-4615-85bb-18a7ba5358d0)

</br>

- ì´ë ‡ê²Œ providerê°€ ìˆëŠ” ê²ƒê³¼ ì—†ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

---

</div>
</details>

<details>
<summary>OAuth2 ê³„ì • í†µí•©</summary>
<div markdown="1">



</div>
</details>
